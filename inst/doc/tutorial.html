<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>BayesChange Tutorial</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">

div.csl-bib-body { }
div.csl-entry {
clear: both;
margin-bottom: 0em;
}
.hanging div.csl-entry {
margin-left:2em;
text-indent:-2em;
}
div.csl-left-margin {
min-width:2em;
float:left;
}
div.csl-right-inline {
margin-left:2em;
padding-left:1em;
}
div.csl-indent {
margin-left: 2em;
}
</style>

<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">BayesChange Tutorial</h1>



<p>Here we provide a brief tutorial of the <code>BayesChange</code>
package. The <code>BayesChange</code> package contains two main
functions: one that performs change points detection on univariate and
multivariate time series and one that perform clustering of time series
and survival functions with common change points. Here we briefly show
how to implement these.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(BayesChange)</span></code></pre></div>
<div id="detecting-change-points" class="section level2">
<h2>Detecting change points</h2>
<p>The function <code>detect_cp</code> provide a method for detecting
change points on univariate and multivariate time series, it is based on
the work <span class="citation">Martínez and Mena (2014)</span> and on
the work <span class="citation">Corradin, Danese, and Ongaro
(2022)</span>.</p>
<p>Depending on the structure of the data, <code>detect_cp</code>
performs change points detection on univariate time series or
multivariate time series. For example we can create a vector of 100
observations where the first 50 observations are sampled from a normal
distribution with mean 0 and variance 0.1 and the other 50 observations
still from a normal distribution with mean 0 but variance 0.25.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a>data_uni <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">50</span>,<span class="dv">0</span>,<span class="fl">0.1</span>), <span class="fu">rnorm</span>(<span class="dv">50</span>,<span class="dv">1</span>,<span class="fl">0.25</span>)))</span></code></pre></div>
<p>Now we can run the function <code>detect_cp</code>, as arguments of
the function we need to specify the number of iterations, the number of
burn-in steps and a list with the the autoregressive coefficient
<code>phi</code> for the likelihood of the data, the parameters
<code>a</code>, <code>b</code>, <code>c</code> for the priors and the
probability <code>q</code> of performing a split at each step.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>out <span class="ot">&lt;-</span> <span class="fu">detect_cp</span>(<span class="at">data =</span> data_uni,                             </span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>                 <span class="at">n_iterations =</span> <span class="dv">1000</span>, <span class="at">n_burnin =</span> <span class="dv">100</span>,  </span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>                 <span class="at">params =</span> <span class="fu">list</span>(<span class="at">q =</span> <span class="fl">0.25</span>, <span class="at">phi =</span> <span class="fl">0.1</span>, <span class="at">a =</span> <span class="dv">1</span>, <span class="at">b =</span> <span class="dv">1</span>, <span class="at">c =</span> <span class="fl">0.1</span>))</span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a><span class="co">#&gt; Completed:   100/1000 - in 0.011 sec</span></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a><span class="co">#&gt; Completed:   200/1000 - in 0.02 sec</span></span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a><span class="co">#&gt; Completed:   300/1000 - in 0.029 sec</span></span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a><span class="co">#&gt; Completed:   400/1000 - in 0.039 sec</span></span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a><span class="co">#&gt; Completed:   500/1000 - in 0.048 sec</span></span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a><span class="co">#&gt; Completed:   600/1000 - in 0.058 sec</span></span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a><span class="co">#&gt; Completed:   700/1000 - in 0.067 sec</span></span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a><span class="co">#&gt; Completed:   800/1000 - in 0.076 sec</span></span>
<span id="cb3-12"><a href="#cb3-12" tabindex="-1"></a><span class="co">#&gt; Completed:   900/1000 - in 0.086 sec</span></span>
<span id="cb3-13"><a href="#cb3-13" tabindex="-1"></a><span class="co">#&gt; Completed:   1000/1000 - in 0.095 sec</span></span></code></pre></div>
<p>With the methods <code>print</code> and <code>summary</code> we can
get information about the algorithm.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="fu">print</span>(out)</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="co">#&gt; DetectCpObj object</span></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a><span class="co">#&gt; Type: change points detection on univariate time series</span></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a><span class="fu">summary</span>(out)</span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a><span class="co">#&gt; DetectCpObj object</span></span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a><span class="co">#&gt; Detecting change points on an univariate time series:</span></span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a><span class="co">#&gt;  Number of burn-in iterations: 100 </span></span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a><span class="co">#&gt;  Number of MCMC iterations: 900 </span></span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a><span class="co">#&gt;  Computational time: 0.1 seconds</span></span></code></pre></div>
<p>In order to get a point estimate of the change points we can use the
method <code>posterior_estimate</code> that uses the method
<em>salso</em> by <span class="citation">David B. Dahl and Müller
(2022)</span> to get the final latent order and then detect the change
points.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="fu">table</span>(<span class="fu">posterior_estimate</span>(out, <span class="at">loss =</span> <span class="st">&quot;binder&quot;</span>))</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a><span class="co">#&gt;  1  2 </span></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a><span class="co">#&gt; 49 51</span></span></code></pre></div>
<p>The package also provides a method for plotting the change
points.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="fu">plot</span>(out, <span class="at">loss =</span> <span class="st">&quot;binder&quot;</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<p>In we define instead a matrix of data, <code>detect_cp</code>
automatically performs a multivariate change points detection
method.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>data_multi <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="dv">3</span>, <span class="at">ncol =</span> <span class="dv">100</span>)</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>data_multi[<span class="dv">1</span>,] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">50</span>,<span class="dv">0</span>,<span class="fl">0.100</span>), <span class="fu">rnorm</span>(<span class="dv">50</span>,<span class="dv">1</span>,<span class="fl">0.250</span>)))</span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a>data_multi[<span class="dv">2</span>,] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">50</span>,<span class="dv">0</span>,<span class="fl">0.125</span>), <span class="fu">rnorm</span>(<span class="dv">50</span>,<span class="dv">1</span>,<span class="fl">0.225</span>)))</span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a>data_multi[<span class="dv">3</span>,] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">50</span>,<span class="dv">0</span>,<span class="fl">0.175</span>), <span class="fu">rnorm</span>(<span class="dv">50</span>,<span class="dv">1</span>,<span class="fl">0.280</span>)))</span></code></pre></div>
<p>Arguments <code>k_0</code>, <code>nu_0</code>, <code>phi_0</code>,
<code>m_0</code>, <code>par_theta_c</code>, <code>par_theta_d</code> and
<code>prior_var_gamma</code> correspond to the parameters of the prior
distributions for the multivariate likelihood.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>out <span class="ot">&lt;-</span> <span class="fu">detect_cp</span>(<span class="at">data =</span> data_multi, <span class="at">n_iterations =</span> <span class="dv">1000</span>, <span class="at">n_burnin =</span> <span class="dv">100</span>,</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>                 <span class="fu">list</span>(<span class="at">q =</span> <span class="fl">0.25</span>, <span class="at">k_0 =</span> <span class="fl">0.25</span>, <span class="at">nu_0 =</span> <span class="dv">4</span>, <span class="at">phi_0 =</span> <span class="fu">diag</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">3</span>), </span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a>                      <span class="at">m_0 =</span> <span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">3</span>), <span class="at">par_theta_c =</span> <span class="dv">2</span>, <span class="at">par_theta_d =</span> <span class="fl">0.2</span>, </span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a>                      <span class="at">prior_var_gamma =</span> <span class="fl">0.1</span>))</span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a><span class="co">#&gt; Completed:   100/1000 - in 0.013 sec</span></span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a><span class="co">#&gt; Completed:   200/1000 - in 0.027 sec</span></span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a><span class="co">#&gt; Completed:   300/1000 - in 0.041 sec</span></span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a><span class="co">#&gt; Completed:   400/1000 - in 0.054 sec</span></span>
<span id="cb8-9"><a href="#cb8-9" tabindex="-1"></a><span class="co">#&gt; Completed:   500/1000 - in 0.068 sec</span></span>
<span id="cb8-10"><a href="#cb8-10" tabindex="-1"></a><span class="co">#&gt; Completed:   600/1000 - in 0.082 sec</span></span>
<span id="cb8-11"><a href="#cb8-11" tabindex="-1"></a><span class="co">#&gt; Completed:   700/1000 - in 0.095 sec</span></span>
<span id="cb8-12"><a href="#cb8-12" tabindex="-1"></a><span class="co">#&gt; Completed:   800/1000 - in 0.109 sec</span></span>
<span id="cb8-13"><a href="#cb8-13" tabindex="-1"></a><span class="co">#&gt; Completed:   900/1000 - in 0.124 sec</span></span>
<span id="cb8-14"><a href="#cb8-14" tabindex="-1"></a><span class="co">#&gt; Completed:   1000/1000 - in 0.138 sec</span></span>
<span id="cb8-15"><a href="#cb8-15" tabindex="-1"></a></span>
<span id="cb8-16"><a href="#cb8-16" tabindex="-1"></a><span class="fu">table</span>(<span class="fu">posterior_estimate</span>(out, <span class="at">loss =</span> <span class="st">&quot;binder&quot;</span>))</span>
<span id="cb8-17"><a href="#cb8-17" tabindex="-1"></a><span class="co">#&gt; Warning in salso::salso(mcmc_chain, loss = &quot;binder&quot;, maxNClusters =</span></span>
<span id="cb8-18"><a href="#cb8-18" tabindex="-1"></a><span class="co">#&gt; maxNClusters, : The number of clusters equals the default maximum possible</span></span>
<span id="cb8-19"><a href="#cb8-19" tabindex="-1"></a><span class="co">#&gt; number of clusters.</span></span>
<span id="cb8-20"><a href="#cb8-20" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb8-21"><a href="#cb8-21" tabindex="-1"></a><span class="co">#&gt;  1  2 </span></span>
<span id="cb8-22"><a href="#cb8-22" tabindex="-1"></a><span class="co">#&gt; 50 50</span></span></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="fu">plot</span>(out, <span class="at">loss =</span> <span class="st">&quot;binder&quot;</span>)</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a><span class="co">#&gt; Warning in salso::salso(mcmc_chain, loss = &quot;binder&quot;, maxNClusters =</span></span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a><span class="co">#&gt; maxNClusters, : The number of clusters equals the default maximum possible</span></span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a><span class="co">#&gt; number of clusters.</span></span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="clustering-time-dependent-data-with-common-change-points" class="section level2">
<h2>Clustering time dependent data with common change points</h2>
<p><code>BayesChange</code> contains another function,
<code>clust_cp</code>, that cluster respectively univariate and
multivariate time series and survival functions with common change
points. Details about this methods can be found in <span class="citation">Corradin et al. (2024)</span>.</p>
<p>In <code>clust_cp</code> the argument <code>kernel</code> must be
specified, if data are time series then <code>kernel = &quot;ts&quot;</code> must
be set. Then the algorithm automatically detects if data are univariate
or multivariate.</p>
<p>If time series are univariate we need to set a matrix where each row
is a time series.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>data_mat <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="dv">5</span>, <span class="at">ncol =</span> <span class="dv">100</span>)</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>data_mat[<span class="dv">1</span>,] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">50</span>,<span class="dv">0</span>,<span class="fl">0.100</span>), <span class="fu">rnorm</span>(<span class="dv">50</span>,<span class="dv">1</span>,<span class="fl">0.250</span>)))</span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a>data_mat[<span class="dv">2</span>,] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">50</span>,<span class="dv">0</span>,<span class="fl">0.125</span>), <span class="fu">rnorm</span>(<span class="dv">50</span>,<span class="dv">1</span>,<span class="fl">0.225</span>)))</span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a>data_mat[<span class="dv">3</span>,] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">50</span>,<span class="dv">0</span>,<span class="fl">0.175</span>), <span class="fu">rnorm</span>(<span class="dv">50</span>,<span class="dv">1</span>,<span class="fl">0.280</span>)))</span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a>data_mat[<span class="dv">4</span>,] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">25</span>,<span class="dv">0</span>,<span class="fl">0.135</span>), <span class="fu">rnorm</span>(<span class="dv">75</span>,<span class="dv">1</span>,<span class="fl">0.225</span>)))</span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a>data_mat[<span class="dv">5</span>,] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">25</span>,<span class="dv">0</span>,<span class="fl">0.155</span>), <span class="fu">rnorm</span>(<span class="dv">75</span>,<span class="dv">1</span>,<span class="fl">0.280</span>)))</span></code></pre></div>
<p>Arguments that need to be specified in <code>clust_cp</code> are the
number of iterations <code>n_iterations</code>, the number of elements
in the normalisation constant <code>B</code>, the split-and-merge step
<code>L</code> performed when a new partition is proposed and a list
with the parameters of the algorithm, the likelihood and the
priors..</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a>out <span class="ot">&lt;-</span> <span class="fu">clust_cp</span>(<span class="at">data =</span> data_mat, <span class="at">n_iterations =</span> <span class="dv">1000</span>, <span class="at">n_burnin =</span> <span class="dv">100</span>, </span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>                <span class="at">kernel =</span> <span class="st">&quot;ts&quot;</span>,</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>                <span class="at">params =</span> <span class="fu">list</span>(<span class="at">B =</span> <span class="dv">1000</span>, <span class="at">L =</span> <span class="dv">1</span>, <span class="at">gamma =</span> <span class="fl">0.5</span>))</span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a><span class="co">#&gt; Normalization constant - completed:  100/1000 - in 0.007 sec</span></span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a><span class="co">#&gt; Normalization constant - completed:  200/1000 - in 0.015 sec</span></span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a><span class="co">#&gt; Normalization constant - completed:  300/1000 - in 0.024 sec</span></span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a><span class="co">#&gt; Normalization constant - completed:  400/1000 - in 0.031 sec</span></span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a><span class="co">#&gt; Normalization constant - completed:  500/1000 - in 0.039 sec</span></span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a><span class="co">#&gt; Normalization constant - completed:  600/1000 - in 0.047 sec</span></span>
<span id="cb11-10"><a href="#cb11-10" tabindex="-1"></a><span class="co">#&gt; Normalization constant - completed:  700/1000 - in 0.054 sec</span></span>
<span id="cb11-11"><a href="#cb11-11" tabindex="-1"></a><span class="co">#&gt; Normalization constant - completed:  800/1000 - in 0.062 sec</span></span>
<span id="cb11-12"><a href="#cb11-12" tabindex="-1"></a><span class="co">#&gt; Normalization constant - completed:  900/1000 - in 0.07 sec</span></span>
<span id="cb11-13"><a href="#cb11-13" tabindex="-1"></a><span class="co">#&gt; Normalization constant - completed:  1000/1000 - in 0.077 sec</span></span>
<span id="cb11-14"><a href="#cb11-14" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb11-15"><a href="#cb11-15" tabindex="-1"></a><span class="co">#&gt; ------ MAIN LOOP ------</span></span>
<span id="cb11-16"><a href="#cb11-16" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb11-17"><a href="#cb11-17" tabindex="-1"></a><span class="co">#&gt; Completed:   100/1000 - in 0.072 sec</span></span>
<span id="cb11-18"><a href="#cb11-18" tabindex="-1"></a><span class="co">#&gt; Completed:   200/1000 - in 0.143 sec</span></span>
<span id="cb11-19"><a href="#cb11-19" tabindex="-1"></a><span class="co">#&gt; Completed:   300/1000 - in 0.213 sec</span></span>
<span id="cb11-20"><a href="#cb11-20" tabindex="-1"></a><span class="co">#&gt; Completed:   400/1000 - in 0.287 sec</span></span>
<span id="cb11-21"><a href="#cb11-21" tabindex="-1"></a><span class="co">#&gt; Completed:   500/1000 - in 0.359 sec</span></span>
<span id="cb11-22"><a href="#cb11-22" tabindex="-1"></a><span class="co">#&gt; Completed:   600/1000 - in 0.43 sec</span></span>
<span id="cb11-23"><a href="#cb11-23" tabindex="-1"></a><span class="co">#&gt; Completed:   700/1000 - in 0.501 sec</span></span>
<span id="cb11-24"><a href="#cb11-24" tabindex="-1"></a><span class="co">#&gt; Completed:   800/1000 - in 0.572 sec</span></span>
<span id="cb11-25"><a href="#cb11-25" tabindex="-1"></a><span class="co">#&gt; Completed:   900/1000 - in 0.644 sec</span></span>
<span id="cb11-26"><a href="#cb11-26" tabindex="-1"></a><span class="co">#&gt; Completed:   1000/1000 - in 0.715 sec</span></span>
<span id="cb11-27"><a href="#cb11-27" tabindex="-1"></a></span>
<span id="cb11-28"><a href="#cb11-28" tabindex="-1"></a><span class="fu">posterior_estimate</span>(out, <span class="at">loss =</span> <span class="st">&quot;binder&quot;</span>)</span>
<span id="cb11-29"><a href="#cb11-29" tabindex="-1"></a><span class="co">#&gt; [1] 1 2 3 4 4</span></span></code></pre></div>
<p>Method <code>plot</code> for clustering univariate time series
represents the data colored according to the assigned cluster.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="fu">plot</span>(out, <span class="at">loss =</span> <span class="st">&quot;binder&quot;</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<p>If time series are multivariate, data must be an array, where each
element is a multivariate time series represented by a matrix. Each row
of the matrix is a component of the time series.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a>data_array <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="at">data =</span> <span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">100</span>,<span class="dv">5</span>))</span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a>data_array[<span class="dv">1</span>,,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">50</span>,<span class="dv">0</span>,<span class="fl">0.100</span>), <span class="fu">rnorm</span>(<span class="dv">50</span>,<span class="dv">1</span>,<span class="fl">0.250</span>)))</span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a>data_array[<span class="dv">2</span>,,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">50</span>,<span class="dv">0</span>,<span class="fl">0.100</span>), <span class="fu">rnorm</span>(<span class="dv">50</span>,<span class="dv">1</span>,<span class="fl">0.250</span>)))</span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a>data_array[<span class="dv">3</span>,,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">50</span>,<span class="dv">0</span>,<span class="fl">0.100</span>), <span class="fu">rnorm</span>(<span class="dv">50</span>,<span class="dv">1</span>,<span class="fl">0.250</span>)))</span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a></span>
<span id="cb13-7"><a href="#cb13-7" tabindex="-1"></a>data_array[<span class="dv">1</span>,,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">50</span>,<span class="dv">0</span>,<span class="fl">0.100</span>), <span class="fu">rnorm</span>(<span class="dv">50</span>,<span class="dv">1</span>,<span class="fl">0.250</span>)))</span>
<span id="cb13-8"><a href="#cb13-8" tabindex="-1"></a>data_array[<span class="dv">2</span>,,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">50</span>,<span class="dv">0</span>,<span class="fl">0.100</span>), <span class="fu">rnorm</span>(<span class="dv">50</span>,<span class="dv">1</span>,<span class="fl">0.250</span>)))</span>
<span id="cb13-9"><a href="#cb13-9" tabindex="-1"></a>data_array[<span class="dv">3</span>,,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">50</span>,<span class="dv">0</span>,<span class="fl">0.100</span>), <span class="fu">rnorm</span>(<span class="dv">50</span>,<span class="dv">1</span>,<span class="fl">0.250</span>)))</span>
<span id="cb13-10"><a href="#cb13-10" tabindex="-1"></a></span>
<span id="cb13-11"><a href="#cb13-11" tabindex="-1"></a>data_array[<span class="dv">1</span>,,<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">50</span>,<span class="dv">0</span>,<span class="fl">0.175</span>), <span class="fu">rnorm</span>(<span class="dv">50</span>,<span class="dv">1</span>,<span class="fl">0.280</span>)))</span>
<span id="cb13-12"><a href="#cb13-12" tabindex="-1"></a>data_array[<span class="dv">2</span>,,<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">50</span>,<span class="dv">0</span>,<span class="fl">0.175</span>), <span class="fu">rnorm</span>(<span class="dv">50</span>,<span class="dv">1</span>,<span class="fl">0.280</span>)))</span>
<span id="cb13-13"><a href="#cb13-13" tabindex="-1"></a>data_array[<span class="dv">3</span>,,<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">50</span>,<span class="dv">0</span>,<span class="fl">0.175</span>), <span class="fu">rnorm</span>(<span class="dv">50</span>,<span class="dv">1</span>,<span class="fl">0.280</span>)))</span>
<span id="cb13-14"><a href="#cb13-14" tabindex="-1"></a></span>
<span id="cb13-15"><a href="#cb13-15" tabindex="-1"></a>data_array[<span class="dv">1</span>,,<span class="dv">4</span>] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">25</span>,<span class="dv">0</span>,<span class="fl">0.135</span>), <span class="fu">rnorm</span>(<span class="dv">75</span>,<span class="dv">1</span>,<span class="fl">0.225</span>)))</span>
<span id="cb13-16"><a href="#cb13-16" tabindex="-1"></a>data_array[<span class="dv">2</span>,,<span class="dv">4</span>] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">25</span>,<span class="dv">0</span>,<span class="fl">0.135</span>), <span class="fu">rnorm</span>(<span class="dv">75</span>,<span class="dv">1</span>,<span class="fl">0.225</span>)))</span>
<span id="cb13-17"><a href="#cb13-17" tabindex="-1"></a>data_array[<span class="dv">3</span>,,<span class="dv">4</span>] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">25</span>,<span class="dv">0</span>,<span class="fl">0.135</span>), <span class="fu">rnorm</span>(<span class="dv">75</span>,<span class="dv">1</span>,<span class="fl">0.225</span>)))</span>
<span id="cb13-18"><a href="#cb13-18" tabindex="-1"></a></span>
<span id="cb13-19"><a href="#cb13-19" tabindex="-1"></a>data_array[<span class="dv">1</span>,,<span class="dv">5</span>] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">25</span>,<span class="dv">0</span>,<span class="fl">0.155</span>), <span class="fu">rnorm</span>(<span class="dv">75</span>,<span class="dv">1</span>,<span class="fl">0.280</span>)))</span>
<span id="cb13-20"><a href="#cb13-20" tabindex="-1"></a>data_array[<span class="dv">2</span>,,<span class="dv">5</span>] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">25</span>,<span class="dv">0</span>,<span class="fl">0.155</span>), <span class="fu">rnorm</span>(<span class="dv">75</span>,<span class="dv">1</span>,<span class="fl">0.280</span>)))</span>
<span id="cb13-21"><a href="#cb13-21" tabindex="-1"></a>data_array[<span class="dv">3</span>,,<span class="dv">5</span>] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">25</span>,<span class="dv">0</span>,<span class="fl">0.155</span>), <span class="fu">rnorm</span>(<span class="dv">75</span>,<span class="dv">1</span>,<span class="fl">0.280</span>)))</span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a>out <span class="ot">&lt;-</span> <span class="fu">clust_cp</span>(<span class="at">data =</span> data_array, <span class="at">n_iterations =</span> <span class="dv">1000</span>, <span class="at">n_burnin =</span> <span class="dv">100</span>, </span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a>                <span class="at">kernel =</span> <span class="st">&quot;ts&quot;</span>,</span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a>                <span class="fu">list</span>(<span class="at">B =</span> <span class="dv">1000</span>, <span class="at">L =</span> <span class="dv">1</span>, <span class="at">gamma =</span> <span class="fl">0.1</span>, <span class="at">k_0 =</span> <span class="fl">0.25</span>, <span class="at">nu_0 =</span> <span class="dv">5</span>, </span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a>                     <span class="at">phi_0 =</span> <span class="fu">diag</span>(<span class="fl">0.1</span>,<span class="dv">3</span>,<span class="dv">3</span>), <span class="at">m_0 =</span> <span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">3</span>)))</span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a><span class="co">#&gt; Normalization constant - completed:  100/1000 - in 0.008 sec</span></span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a><span class="co">#&gt; Normalization constant - completed:  200/1000 - in 0.016 sec</span></span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a><span class="co">#&gt; Normalization constant - completed:  300/1000 - in 0.024 sec</span></span>
<span id="cb14-8"><a href="#cb14-8" tabindex="-1"></a><span class="co">#&gt; Normalization constant - completed:  400/1000 - in 0.032 sec</span></span>
<span id="cb14-9"><a href="#cb14-9" tabindex="-1"></a><span class="co">#&gt; Normalization constant - completed:  500/1000 - in 0.04 sec</span></span>
<span id="cb14-10"><a href="#cb14-10" tabindex="-1"></a><span class="co">#&gt; Normalization constant - completed:  600/1000 - in 0.048 sec</span></span>
<span id="cb14-11"><a href="#cb14-11" tabindex="-1"></a><span class="co">#&gt; Normalization constant - completed:  700/1000 - in 0.056 sec</span></span>
<span id="cb14-12"><a href="#cb14-12" tabindex="-1"></a><span class="co">#&gt; Normalization constant - completed:  800/1000 - in 0.064 sec</span></span>
<span id="cb14-13"><a href="#cb14-13" tabindex="-1"></a><span class="co">#&gt; Normalization constant - completed:  900/1000 - in 0.072 sec</span></span>
<span id="cb14-14"><a href="#cb14-14" tabindex="-1"></a><span class="co">#&gt; Normalization constant - completed:  1000/1000 - in 0.08 sec</span></span>
<span id="cb14-15"><a href="#cb14-15" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb14-16"><a href="#cb14-16" tabindex="-1"></a><span class="co">#&gt; ------ MAIN LOOP ------</span></span>
<span id="cb14-17"><a href="#cb14-17" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb14-18"><a href="#cb14-18" tabindex="-1"></a><span class="co">#&gt; Completed:   100/1000 - in 0.082 sec</span></span>
<span id="cb14-19"><a href="#cb14-19" tabindex="-1"></a><span class="co">#&gt; Completed:   200/1000 - in 0.167 sec</span></span>
<span id="cb14-20"><a href="#cb14-20" tabindex="-1"></a><span class="co">#&gt; Completed:   300/1000 - in 0.248 sec</span></span>
<span id="cb14-21"><a href="#cb14-21" tabindex="-1"></a><span class="co">#&gt; Completed:   400/1000 - in 0.33 sec</span></span>
<span id="cb14-22"><a href="#cb14-22" tabindex="-1"></a><span class="co">#&gt; Completed:   500/1000 - in 0.42 sec</span></span>
<span id="cb14-23"><a href="#cb14-23" tabindex="-1"></a><span class="co">#&gt; Completed:   600/1000 - in 0.552 sec</span></span>
<span id="cb14-24"><a href="#cb14-24" tabindex="-1"></a><span class="co">#&gt; Completed:   700/1000 - in 0.668 sec</span></span>
<span id="cb14-25"><a href="#cb14-25" tabindex="-1"></a><span class="co">#&gt; Completed:   800/1000 - in 0.762 sec</span></span>
<span id="cb14-26"><a href="#cb14-26" tabindex="-1"></a><span class="co">#&gt; Completed:   900/1000 - in 0.847 sec</span></span>
<span id="cb14-27"><a href="#cb14-27" tabindex="-1"></a><span class="co">#&gt; Completed:   1000/1000 - in 0.921 sec</span></span>
<span id="cb14-28"><a href="#cb14-28" tabindex="-1"></a></span>
<span id="cb14-29"><a href="#cb14-29" tabindex="-1"></a><span class="fu">posterior_estimate</span>(out, <span class="at">loss =</span> <span class="st">&quot;binder&quot;</span>)</span>
<span id="cb14-30"><a href="#cb14-30" tabindex="-1"></a><span class="co">#&gt; [1] 1 2 2 3 3</span></span></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="fu">plot</span>(out, <span class="at">loss =</span> <span class="st">&quot;binder&quot;</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<p>Finally, if we set <code>kernel = &quot;epi&quot;</code>, <code>clust_cp</code>
cluster survival functions with common change points. Also here details
can be found in <span class="citation">Corradin et al.
(2024)</span>.</p>
<p>Data are a matrix where each row is the number of infected at each
time. Inside this package is included the function
<code>sim_epi_data</code> that simulates infection times.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a>data_mat <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="dv">5</span>, <span class="at">ncol =</span> <span class="dv">50</span>)</span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a></span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a>betas <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="fl">0.45</span>, <span class="dv">25</span>),<span class="fu">rep</span>(<span class="fl">0.14</span>,<span class="dv">25</span>)),</span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a>               <span class="fu">c</span>(<span class="fu">rep</span>(<span class="fl">0.55</span>, <span class="dv">25</span>),<span class="fu">rep</span>(<span class="fl">0.11</span>,<span class="dv">25</span>)),</span>
<span id="cb16-5"><a href="#cb16-5" tabindex="-1"></a>               <span class="fu">c</span>(<span class="fu">rep</span>(<span class="fl">0.50</span>, <span class="dv">25</span>),<span class="fu">rep</span>(<span class="fl">0.12</span>,<span class="dv">25</span>)),</span>
<span id="cb16-6"><a href="#cb16-6" tabindex="-1"></a>               <span class="fu">c</span>(<span class="fu">rep</span>(<span class="fl">0.52</span>, <span class="dv">10</span>),<span class="fu">rep</span>(<span class="fl">0.15</span>,<span class="dv">40</span>)),</span>
<span id="cb16-7"><a href="#cb16-7" tabindex="-1"></a>               <span class="fu">c</span>(<span class="fu">rep</span>(<span class="fl">0.53</span>, <span class="dv">10</span>),<span class="fu">rep</span>(<span class="fl">0.13</span>,<span class="dv">40</span>)))</span>
<span id="cb16-8"><a href="#cb16-8" tabindex="-1"></a></span>
<span id="cb16-9"><a href="#cb16-9" tabindex="-1"></a>  inf_times <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb16-10"><a href="#cb16-10" tabindex="-1"></a></span>
<span id="cb16-11"><a href="#cb16-11" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>){</span>
<span id="cb16-12"><a href="#cb16-12" tabindex="-1"></a></span>
<span id="cb16-13"><a href="#cb16-13" tabindex="-1"></a>    inf_times[[i]] <span class="ot">&lt;-</span> <span class="fu">sim_epi_data</span>(<span class="at">S0 =</span> <span class="dv">10000</span>, <span class="at">I0 =</span> <span class="dv">10</span>, <span class="at">max_time =</span> <span class="dv">50</span>, <span class="at">beta_vec =</span> betas[[i]], <span class="at">gamma_0 =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">8</span>)</span>
<span id="cb16-14"><a href="#cb16-14" tabindex="-1"></a></span>
<span id="cb16-15"><a href="#cb16-15" tabindex="-1"></a>    vec <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">50</span>)</span>
<span id="cb16-16"><a href="#cb16-16" tabindex="-1"></a>    <span class="fu">names</span>(vec) <span class="ot">&lt;-</span> <span class="fu">as.character</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">50</span>)</span>
<span id="cb16-17"><a href="#cb16-17" tabindex="-1"></a></span>
<span id="cb16-18"><a href="#cb16-18" tabindex="-1"></a>    <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">50</span>){</span>
<span id="cb16-19"><a href="#cb16-19" tabindex="-1"></a>      <span class="cf">if</span>(<span class="fu">as.character</span>(j) <span class="sc">%in%</span> <span class="fu">names</span>(<span class="fu">table</span>(<span class="fu">floor</span>(inf_times[[i]])))){</span>
<span id="cb16-20"><a href="#cb16-20" tabindex="-1"></a>      vec[j] <span class="ot">=</span> <span class="fu">table</span>(<span class="fu">floor</span>(inf_times[[i]]))[<span class="fu">which</span>(<span class="fu">names</span>(<span class="fu">table</span>(<span class="fu">floor</span>(inf_times[[i]]))) <span class="sc">==</span> j)]</span>
<span id="cb16-21"><a href="#cb16-21" tabindex="-1"></a>      }</span>
<span id="cb16-22"><a href="#cb16-22" tabindex="-1"></a>    }</span>
<span id="cb16-23"><a href="#cb16-23" tabindex="-1"></a>    data_mat[i,] <span class="ot">&lt;-</span> vec</span>
<span id="cb16-24"><a href="#cb16-24" tabindex="-1"></a>  }</span></code></pre></div>
<p>In <code>clust_cp</code> we need to specify, besides the usual
parameters, the number of Monte Carlo replications <code>M</code> for
the approximation of the integrated likelihood and the recovery rate
<code>gamma</code>.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a>out <span class="ot">&lt;-</span> <span class="fu">clust_cp</span>(<span class="at">data =</span> data_mat, <span class="at">n_iterations =</span> <span class="dv">100</span>, <span class="at">n_burnin =</span> <span class="dv">10</span>, </span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a>                <span class="at">kernel =</span> <span class="st">&quot;epi&quot;</span>, </span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a>                <span class="fu">list</span>(<span class="at">M =</span> <span class="dv">100</span>, <span class="at">B =</span> <span class="dv">1000</span>, <span class="at">L =</span> <span class="dv">1</span>, <span class="at">q =</span> <span class="fl">0.1</span>, <span class="at">gamma =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">8</span>))</span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a><span class="co">#&gt; Normalization constant - completed:  10/100 - in 0.062 sec</span></span>
<span id="cb17-5"><a href="#cb17-5" tabindex="-1"></a><span class="co">#&gt; Normalization constant - completed:  20/100 - in 0.123 sec</span></span>
<span id="cb17-6"><a href="#cb17-6" tabindex="-1"></a><span class="co">#&gt; Normalization constant - completed:  30/100 - in 0.185 sec</span></span>
<span id="cb17-7"><a href="#cb17-7" tabindex="-1"></a><span class="co">#&gt; Normalization constant - completed:  40/100 - in 0.247 sec</span></span>
<span id="cb17-8"><a href="#cb17-8" tabindex="-1"></a><span class="co">#&gt; Normalization constant - completed:  50/100 - in 0.308 sec</span></span>
<span id="cb17-9"><a href="#cb17-9" tabindex="-1"></a><span class="co">#&gt; Normalization constant - completed:  60/100 - in 0.37 sec</span></span>
<span id="cb17-10"><a href="#cb17-10" tabindex="-1"></a><span class="co">#&gt; Normalization constant - completed:  70/100 - in 0.431 sec</span></span>
<span id="cb17-11"><a href="#cb17-11" tabindex="-1"></a><span class="co">#&gt; Normalization constant - completed:  80/100 - in 0.492 sec</span></span>
<span id="cb17-12"><a href="#cb17-12" tabindex="-1"></a><span class="co">#&gt; Normalization constant - completed:  90/100 - in 0.553 sec</span></span>
<span id="cb17-13"><a href="#cb17-13" tabindex="-1"></a><span class="co">#&gt; Normalization constant - completed:  100/100 - in 0.614 sec</span></span>
<span id="cb17-14"><a href="#cb17-14" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb17-15"><a href="#cb17-15" tabindex="-1"></a><span class="co">#&gt; ------ MAIN LOOP ------</span></span>
<span id="cb17-16"><a href="#cb17-16" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb17-17"><a href="#cb17-17" tabindex="-1"></a><span class="co">#&gt; Completed:   10/100 - in 0.459 sec</span></span>
<span id="cb17-18"><a href="#cb17-18" tabindex="-1"></a><span class="co">#&gt; Completed:   20/100 - in 0.941 sec</span></span>
<span id="cb17-19"><a href="#cb17-19" tabindex="-1"></a><span class="co">#&gt; Completed:   30/100 - in 1.409 sec</span></span>
<span id="cb17-20"><a href="#cb17-20" tabindex="-1"></a><span class="co">#&gt; Completed:   40/100 - in 1.883 sec</span></span>
<span id="cb17-21"><a href="#cb17-21" tabindex="-1"></a><span class="co">#&gt; Completed:   50/100 - in 2.356 sec</span></span>
<span id="cb17-22"><a href="#cb17-22" tabindex="-1"></a><span class="co">#&gt; Completed:   60/100 - in 2.86 sec</span></span>
<span id="cb17-23"><a href="#cb17-23" tabindex="-1"></a><span class="co">#&gt; Completed:   70/100 - in 3.408 sec</span></span>
<span id="cb17-24"><a href="#cb17-24" tabindex="-1"></a><span class="co">#&gt; Completed:   80/100 - in 3.936 sec</span></span>
<span id="cb17-25"><a href="#cb17-25" tabindex="-1"></a><span class="co">#&gt; Completed:   90/100 - in 4.518 sec</span></span>
<span id="cb17-26"><a href="#cb17-26" tabindex="-1"></a><span class="co">#&gt; Completed:   100/100 - in 5.064 sec</span></span>
<span id="cb17-27"><a href="#cb17-27" tabindex="-1"></a></span>
<span id="cb17-28"><a href="#cb17-28" tabindex="-1"></a><span class="fu">posterior_estimate</span>(out, <span class="at">loss =</span> <span class="st">&quot;binder&quot;</span>)</span>
<span id="cb17-29"><a href="#cb17-29" tabindex="-1"></a><span class="co">#&gt; [1] 1 1 2 1 1</span></span></code></pre></div>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a><span class="fu">plot</span>(out, <span class="at">loss =</span> <span class="st">&quot;binder&quot;</span>)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" /><!-- --></p>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-corradin2024" class="csl-entry">
Corradin, Riccardo, Luca Danese, Wasiur R. KhudaBukhsh, and Andrea
Ongaro. 2024. <span>“Model-Based Clustering of Time-Dependent
Observations with Common Structural Changes.”</span> <a href="https://arxiv.org/abs/2410.09552">https://arxiv.org/abs/2410.09552</a>.
</div>
<div id="ref-CORRADIN202226" class="csl-entry">
Corradin, Riccardo, Luca Danese, and Andrea Ongaro. 2022.
<span>“Bayesian Nonparametric Change Point Detection for Multivariate
Time Series with Missing Observations.”</span> <em>International Journal
of Approximate Reasoning</em> 143: 26–43. https://doi.org/<a href="https://doi.org/10.1016/j.ijar.2021.12.019">https://doi.org/10.1016/j.ijar.2021.12.019</a>.
</div>
<div id="ref-Dahl02102022" class="csl-entry">
David B. Dahl, Devin J. Johnson, and Peter Müller. 2022. <span>“Search
Algorithms and Loss Functions for Bayesian Clustering.”</span>
<em>Journal of Computational and Graphical Statistics</em> 31 (4):
1189–1201. <a href="https://doi.org/10.1080/10618600.2022.2069779">https://doi.org/10.1080/10618600.2022.2069779</a>.
</div>
<div id="ref-MM2014" class="csl-entry">
Martínez, Asael Fabian, and Ramsés H. Mena. 2014. <span>“<span class="nocase">On a Nonparametric Change Point Detection Model in
Markovian Regimes</span>.”</span> <em>Bayesian Analysis</em> 9 (4):
823–58. <a href="https://doi.org/10.1214/14-BA878">https://doi.org/10.1214/14-BA878</a>.
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
