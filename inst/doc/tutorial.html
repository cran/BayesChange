<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>BayesChange Tutorial</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">

div.csl-bib-body { }
div.csl-entry {
clear: both;
margin-bottom: 0em;
}
.hanging div.csl-entry {
margin-left:2em;
text-indent:-2em;
}
div.csl-left-margin {
min-width:2em;
float:left;
}
div.csl-right-inline {
margin-left:2em;
padding-left:1em;
}
div.csl-indent {
margin-left: 2em;
}
</style>

<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">BayesChange Tutorial</h1>



<p>Here we provide a brief tutorial of the <code>BayesChange</code>
package. The <code>BayesChange</code> package contains two main
functions: one that performs change points detection on time series and
survival functions and one that perform clustering of time series and
survival functions with common change points. Here we briefly show how
to implement these.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(BayesChange)</span></code></pre></div>
<div id="detecting-change-points" class="section level2">
<h2>Detecting change points</h2>
<p>The function <code>detect_cp</code> provide a method for detecting
change points, it is based on the work <span class="citation">Martínez
and Mena (2014)</span> and on <span class="citation">Corradin et al.
(2025)</span>.</p>
<p>Depending on the structure of the data, <code>detect_cp</code> might
perform change points detection on univariate time series or
multivariate time series. For example we can create a vector of 100
observations where the first 50 observations are sampled from a normal
distribution with mean 0 and variance 0.1 and the other 50 observations
still from a normal distribution with mean 0 but variance 0.25.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a>data_uni <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">50</span>,<span class="dv">0</span>,<span class="fl">0.1</span>), <span class="fu">rnorm</span>(<span class="dv">50</span>,<span class="dv">1</span>,<span class="fl">0.25</span>)))</span></code></pre></div>
<p>Now we can run the function <code>detect_cp</code>, as arguments of
the function we need to specify the number of iterations, the number of
burn-in steps and a list with the the autoregressive coefficient
<code>phi</code> for the likelihood of the data, the parameters
<code>a</code>, <code>b</code>, <code>c</code> for the priors and the
probability <code>q</code> of performing a split at each step. Since we
deal with time series we need also to specify
<code>kernel = &quot;ts&quot;</code>.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>out <span class="ot">&lt;-</span> <span class="fu">detect_cp</span>(<span class="at">data =</span> data_uni,                             </span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>                 <span class="at">n_iterations =</span> <span class="dv">1000</span>, <span class="at">n_burnin =</span> <span class="dv">100</span>,  </span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>                 <span class="at">params =</span> <span class="fu">list</span>(<span class="at">q =</span> <span class="fl">0.25</span>, <span class="at">phi =</span> <span class="fl">0.1</span>, <span class="at">a =</span> <span class="dv">1</span>, <span class="at">b =</span> <span class="dv">1</span>, <span class="at">c =</span> <span class="fl">0.1</span>), <span class="at">kernel =</span> <span class="st">&quot;ts&quot;</span>)</span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a><span class="co">#&gt; Completed:   100/1000 - in 0.009 sec</span></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a><span class="co">#&gt; Completed:   200/1000 - in 0.018 sec</span></span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a><span class="co">#&gt; Completed:   300/1000 - in 0.027 sec</span></span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a><span class="co">#&gt; Completed:   400/1000 - in 0.036 sec</span></span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a><span class="co">#&gt; Completed:   500/1000 - in 0.045 sec</span></span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a><span class="co">#&gt; Completed:   600/1000 - in 0.053 sec</span></span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a><span class="co">#&gt; Completed:   700/1000 - in 0.061 sec</span></span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a><span class="co">#&gt; Completed:   800/1000 - in 0.07 sec</span></span>
<span id="cb3-12"><a href="#cb3-12" tabindex="-1"></a><span class="co">#&gt; Completed:   900/1000 - in 0.078 sec</span></span>
<span id="cb3-13"><a href="#cb3-13" tabindex="-1"></a><span class="co">#&gt; Completed:   1000/1000 - in 0.087 sec</span></span></code></pre></div>
<p>With the methods <code>print</code> and <code>summary</code> we can
get information about the algorithm.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="fu">print</span>(out)</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="co">#&gt; DetectCpObj object</span></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a><span class="co">#&gt; Type: change points detection on univariate time series</span></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a><span class="fu">summary</span>(out)</span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a><span class="co">#&gt; DetectCpObj object</span></span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a><span class="co">#&gt; Detecting change points on an univariate time series:</span></span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a><span class="co">#&gt;  Number of burn-in iterations: 100 </span></span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a><span class="co">#&gt;  Number of MCMC iterations: 900 </span></span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a><span class="co">#&gt;  Computational time: 0.09 seconds</span></span></code></pre></div>
<p>In order to get a point estimate of the change points we can use the
method <code>posterior_estimate</code> that uses the method
<em>salso</em> by <span class="citation">David B. Dahl and Müller
(2022)</span> to get the final latent order and then detect the change
points.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="fu">table</span>(<span class="fu">posterior_estimate</span>(out, <span class="at">loss =</span> <span class="st">&quot;binder&quot;</span>))</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a><span class="co">#&gt;  1  2 </span></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a><span class="co">#&gt; 50 50</span></span></code></pre></div>
<p>The package also provides a method for plotting the change
points.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="fu">plot</span>(out, <span class="at">loss =</span> <span class="st">&quot;binder&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>If we define instead a matrix of data, <code>detect_cp</code>
automatically performs a multivariate change points detection
method.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>data_multi <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="dv">3</span>, <span class="at">ncol =</span> <span class="dv">100</span>)</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>data_multi[<span class="dv">1</span>,] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">50</span>,<span class="dv">0</span>,<span class="fl">0.100</span>), <span class="fu">rnorm</span>(<span class="dv">50</span>,<span class="dv">1</span>,<span class="fl">0.250</span>)))</span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a>data_multi[<span class="dv">2</span>,] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">50</span>,<span class="dv">0</span>,<span class="fl">0.125</span>), <span class="fu">rnorm</span>(<span class="dv">50</span>,<span class="dv">1</span>,<span class="fl">0.225</span>)))</span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a>data_multi[<span class="dv">3</span>,] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">50</span>,<span class="dv">0</span>,<span class="fl">0.175</span>), <span class="fu">rnorm</span>(<span class="dv">50</span>,<span class="dv">1</span>,<span class="fl">0.280</span>)))</span></code></pre></div>
<p>Arguments <code>k_0</code>, <code>nu_0</code>, <code>phi_0</code>,
<code>m_0</code>, <code>par_theta_c</code>, <code>par_theta_d</code> and
<code>prior_var_gamma</code> correspond to the parameters of the prior
distributions for the multivariate likelihood.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>out <span class="ot">&lt;-</span> <span class="fu">detect_cp</span>(<span class="at">data =</span> data_multi, <span class="at">n_iterations =</span> <span class="dv">1000</span>, <span class="at">n_burnin =</span> <span class="dv">100</span>,</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>                 <span class="at">q =</span> <span class="fl">0.25</span>, <span class="at">params =</span> <span class="fu">list</span>(<span class="at">k_0 =</span> <span class="fl">0.25</span>, <span class="at">nu_0 =</span> <span class="dv">4</span>, <span class="at">phi_0 =</span> <span class="fu">diag</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">3</span>), </span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a>                      <span class="at">m_0 =</span> <span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">3</span>), <span class="at">par_theta_c =</span> <span class="dv">2</span>, <span class="at">par_theta_d =</span> <span class="fl">0.2</span>, </span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a>                      <span class="at">prior_var_gamma =</span> <span class="fl">0.1</span>), <span class="at">kernel =</span> <span class="st">&quot;ts&quot;</span>)</span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a><span class="co">#&gt; Completed:   100/1000 - in 0.013 sec</span></span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a><span class="co">#&gt; Completed:   200/1000 - in 0.025 sec</span></span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a><span class="co">#&gt; Completed:   300/1000 - in 0.038 sec</span></span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a><span class="co">#&gt; Completed:   400/1000 - in 0.05 sec</span></span>
<span id="cb8-9"><a href="#cb8-9" tabindex="-1"></a><span class="co">#&gt; Completed:   500/1000 - in 0.061 sec</span></span>
<span id="cb8-10"><a href="#cb8-10" tabindex="-1"></a><span class="co">#&gt; Completed:   600/1000 - in 0.073 sec</span></span>
<span id="cb8-11"><a href="#cb8-11" tabindex="-1"></a><span class="co">#&gt; Completed:   700/1000 - in 0.084 sec</span></span>
<span id="cb8-12"><a href="#cb8-12" tabindex="-1"></a><span class="co">#&gt; Completed:   800/1000 - in 0.096 sec</span></span>
<span id="cb8-13"><a href="#cb8-13" tabindex="-1"></a><span class="co">#&gt; Completed:   900/1000 - in 0.107 sec</span></span>
<span id="cb8-14"><a href="#cb8-14" tabindex="-1"></a><span class="co">#&gt; Completed:   1000/1000 - in 0.119 sec</span></span>
<span id="cb8-15"><a href="#cb8-15" tabindex="-1"></a></span>
<span id="cb8-16"><a href="#cb8-16" tabindex="-1"></a><span class="fu">table</span>(<span class="fu">posterior_estimate</span>(out, <span class="at">loss =</span> <span class="st">&quot;binder&quot;</span>))</span>
<span id="cb8-17"><a href="#cb8-17" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb8-18"><a href="#cb8-18" tabindex="-1"></a><span class="co">#&gt;  1  2 </span></span>
<span id="cb8-19"><a href="#cb8-19" tabindex="-1"></a><span class="co">#&gt; 50 50</span></span></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="fu">plot</span>(out, <span class="at">loss =</span> <span class="st">&quot;binder&quot;</span>, <span class="at">plot_freq =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Function <code>detect_cp</code> can also be used to detect change
points on survival functions. We define a matrix of one row and a vector
with the infection rates.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>data_mat <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="dv">100</span>, <span class="at">ncol =</span> <span class="dv">1</span>)</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>betas <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="fl">0.45</span>, <span class="dv">25</span>),<span class="fu">rep</span>(<span class="fl">0.14</span>,<span class="dv">75</span>))</span></code></pre></div>
<p>With function <code>sim_epi_data</code> we simulate a set of
infection times.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a>inf_times <span class="ot">&lt;-</span> <span class="fu">sim_epi_data</span>(<span class="dv">10000</span>, <span class="dv">10</span>, <span class="dv">100</span>, betas, <span class="dv">1</span><span class="sc">/</span><span class="dv">8</span>)</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>inf_times_vec <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">100</span>)</span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a><span class="fu">names</span>(inf_times_vec) <span class="ot">&lt;-</span> <span class="fu">as.character</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>)</span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a></span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>){</span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a> <span class="cf">if</span>(<span class="fu">as.character</span>(j) <span class="sc">%in%</span> <span class="fu">names</span>(<span class="fu">table</span>(<span class="fu">floor</span>(inf_times)))){</span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a>   inf_times_vec[j] <span class="ot">=</span> <span class="fu">table</span>(<span class="fu">floor</span>(inf_times))[<span class="fu">which</span>(<span class="fu">names</span>(<span class="fu">table</span>(<span class="fu">floor</span>(inf_times))) <span class="sc">==</span> j)]</span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a> }</span>
<span id="cb11-10"><a href="#cb11-10" tabindex="-1"></a>}</span>
<span id="cb11-11"><a href="#cb11-11" tabindex="-1"></a></span>
<span id="cb11-12"><a href="#cb11-12" tabindex="-1"></a>data_mat[,<span class="dv">1</span>] <span class="ot">&lt;-</span> inf_times_vec</span></code></pre></div>
<p>To run <code>detect_cp</code> on epidemiological data we need to set
<code>kernel = &quot;epi&quot;</code>. Moreover, besides the usual parameters, we
need to set the number of Monte Carlo replications <code>M</code> for
the approximation of the integrated likelihood and the recovery rate
<code>xi</code>. <code>a0</code> and <code>b0</code> are optional and
correspond to the parameters of the gamma distribution for the
integration of the likelihood.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a>out <span class="ot">&lt;-</span> <span class="fu">detect_cp</span>(<span class="at">data =</span> data_mat, <span class="at">n_iterations =</span> <span class="dv">200</span>, <span class="at">n_burnin =</span> <span class="dv">50</span>,</span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>                 <span class="at">params =</span> <span class="fu">list</span>(<span class="at">xi =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">8</span>, <span class="at">a0 =</span> <span class="dv">40</span>, <span class="at">b0 =</span> <span class="dv">10</span>, <span class="at">M =</span> <span class="dv">1000</span>), <span class="at">kernel =</span> <span class="st">&quot;epi&quot;</span>)</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a><span class="co">#&gt; Completed:   20/200 - in 1.229 sec</span></span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a><span class="co">#&gt; Completed:   40/200 - in 2.305 sec</span></span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a><span class="co">#&gt; Completed:   60/200 - in 3.518 sec</span></span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a><span class="co">#&gt; Completed:   80/200 - in 4.731 sec</span></span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a><span class="co">#&gt; Completed:   100/200 - in 5.945 sec</span></span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a><span class="co">#&gt; Completed:   120/200 - in 7.153 sec</span></span>
<span id="cb12-9"><a href="#cb12-9" tabindex="-1"></a><span class="co">#&gt; Completed:   140/200 - in 8.477 sec</span></span>
<span id="cb12-10"><a href="#cb12-10" tabindex="-1"></a><span class="co">#&gt; Completed:   160/200 - in 9.86 sec</span></span>
<span id="cb12-11"><a href="#cb12-11" tabindex="-1"></a><span class="co">#&gt; Completed:   180/200 - in 11.237 sec</span></span>
<span id="cb12-12"><a href="#cb12-12" tabindex="-1"></a><span class="co">#&gt; Completed:   200/200 - in 12.611 sec</span></span>
<span id="cb12-13"><a href="#cb12-13" tabindex="-1"></a></span>
<span id="cb12-14"><a href="#cb12-14" tabindex="-1"></a><span class="fu">print</span>(out)</span>
<span id="cb12-15"><a href="#cb12-15" tabindex="-1"></a><span class="co">#&gt; DetectCpObj object</span></span>
<span id="cb12-16"><a href="#cb12-16" tabindex="-1"></a><span class="co">#&gt; Type: change points detection on an epidemic diffusion</span></span>
<span id="cb12-17"><a href="#cb12-17" tabindex="-1"></a><span class="fu">table</span>(<span class="fu">posterior_estimate</span>(out, <span class="at">loss =</span> <span class="st">&quot;binder&quot;</span>))</span>
<span id="cb12-18"><a href="#cb12-18" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb12-19"><a href="#cb12-19" tabindex="-1"></a><span class="co">#&gt;  1  2 </span></span>
<span id="cb12-20"><a href="#cb12-20" tabindex="-1"></a><span class="co">#&gt; 26 74</span></span></code></pre></div>
<p>Also here, with function <code>plot</code> we can plot the survival
function and the position of the change points.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="fu">plot</span>(out)</span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a><span class="co">#&gt; Warning in salso::salso(mcmc_chain, loss = &quot;VI&quot;, maxNClusters = maxNClusters, :</span></span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a><span class="co">#&gt; The number of clusters equals the default maximum possible number of clusters.</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="clustering-time-dependent-data-with-common-change-points" class="section level2">
<h2>Clustering time dependent data with common change points</h2>
<p><code>BayesChange</code> contains another function,
<code>clust_cp</code>, that cluster respectively univariate and
multivariate time series and survival functions with common change
points. Details about this methods can be found in <span class="citation">Corradin et al. (2024)</span>.</p>
<p>In <code>clust_cp</code> the argument <code>kernel</code> must be
specified, if data are time series then <code>kernel = &quot;ts&quot;</code> must
be set. Then the algorithm automatically detects if data are univariate
or multivariate.</p>
<p>If time series are univariate we need to set a matrix where each row
is a time series.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a>data_mat <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="dv">5</span>, <span class="at">ncol =</span> <span class="dv">100</span>)</span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a>data_mat[<span class="dv">1</span>,] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">50</span>,<span class="dv">0</span>,<span class="fl">0.100</span>), <span class="fu">rnorm</span>(<span class="dv">50</span>,<span class="dv">1</span>,<span class="fl">0.250</span>)))</span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a>data_mat[<span class="dv">2</span>,] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">50</span>,<span class="dv">0</span>,<span class="fl">0.125</span>), <span class="fu">rnorm</span>(<span class="dv">50</span>,<span class="dv">1</span>,<span class="fl">0.225</span>)))</span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a>data_mat[<span class="dv">3</span>,] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">50</span>,<span class="dv">0</span>,<span class="fl">0.175</span>), <span class="fu">rnorm</span>(<span class="dv">50</span>,<span class="dv">1</span>,<span class="fl">0.280</span>)))</span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a>data_mat[<span class="dv">4</span>,] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">25</span>,<span class="dv">0</span>,<span class="fl">0.135</span>), <span class="fu">rnorm</span>(<span class="dv">75</span>,<span class="dv">1</span>,<span class="fl">0.225</span>)))</span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a>data_mat[<span class="dv">5</span>,] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">25</span>,<span class="dv">0</span>,<span class="fl">0.155</span>), <span class="fu">rnorm</span>(<span class="dv">75</span>,<span class="dv">1</span>,<span class="fl">0.280</span>)))</span></code></pre></div>
<p>Arguments that need to be specified in <code>clust_cp</code> are the
number of iterations <code>n_iterations</code>, the number of elements
in the normalisation constant <code>B</code>, the split-and-merge step
<code>L</code> performed when a new partition is proposed and a list
with the parameters of the algorithm, the likelihood and the
priors..</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a>out <span class="ot">&lt;-</span> <span class="fu">clust_cp</span>(<span class="at">data =</span> data_mat, <span class="at">n_iterations =</span> <span class="dv">1000</span>, <span class="at">n_burnin =</span> <span class="dv">100</span>, </span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a>                <span class="at">kernel =</span> <span class="st">&quot;ts&quot;</span>,</span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a>                <span class="at">params =</span> <span class="fu">list</span>(<span class="at">B =</span> <span class="dv">1000</span>, <span class="at">L =</span> <span class="dv">1</span>, <span class="at">gamma =</span> <span class="fl">0.5</span>))</span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a><span class="co">#&gt; Normalization constant - completed:  100/1000 - in 0.004 sec</span></span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a><span class="co">#&gt; Normalization constant - completed:  200/1000 - in 0.008 sec</span></span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a><span class="co">#&gt; Normalization constant - completed:  300/1000 - in 0.012 sec</span></span>
<span id="cb15-7"><a href="#cb15-7" tabindex="-1"></a><span class="co">#&gt; Normalization constant - completed:  400/1000 - in 0.016 sec</span></span>
<span id="cb15-8"><a href="#cb15-8" tabindex="-1"></a><span class="co">#&gt; Normalization constant - completed:  500/1000 - in 0.02 sec</span></span>
<span id="cb15-9"><a href="#cb15-9" tabindex="-1"></a><span class="co">#&gt; Normalization constant - completed:  600/1000 - in 0.024 sec</span></span>
<span id="cb15-10"><a href="#cb15-10" tabindex="-1"></a><span class="co">#&gt; Normalization constant - completed:  700/1000 - in 0.028 sec</span></span>
<span id="cb15-11"><a href="#cb15-11" tabindex="-1"></a><span class="co">#&gt; Normalization constant - completed:  800/1000 - in 0.032 sec</span></span>
<span id="cb15-12"><a href="#cb15-12" tabindex="-1"></a><span class="co">#&gt; Normalization constant - completed:  900/1000 - in 0.036 sec</span></span>
<span id="cb15-13"><a href="#cb15-13" tabindex="-1"></a><span class="co">#&gt; Normalization constant - completed:  1000/1000 - in 0.04 sec</span></span>
<span id="cb15-14"><a href="#cb15-14" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb15-15"><a href="#cb15-15" tabindex="-1"></a><span class="co">#&gt; ------ MAIN LOOP ------</span></span>
<span id="cb15-16"><a href="#cb15-16" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb15-17"><a href="#cb15-17" tabindex="-1"></a><span class="co">#&gt; Completed:   100/1000 - in 0.049 sec</span></span>
<span id="cb15-18"><a href="#cb15-18" tabindex="-1"></a><span class="co">#&gt; Completed:   200/1000 - in 0.098 sec</span></span>
<span id="cb15-19"><a href="#cb15-19" tabindex="-1"></a><span class="co">#&gt; Completed:   300/1000 - in 0.149 sec</span></span>
<span id="cb15-20"><a href="#cb15-20" tabindex="-1"></a><span class="co">#&gt; Completed:   400/1000 - in 0.2 sec</span></span>
<span id="cb15-21"><a href="#cb15-21" tabindex="-1"></a><span class="co">#&gt; Completed:   500/1000 - in 0.248 sec</span></span>
<span id="cb15-22"><a href="#cb15-22" tabindex="-1"></a><span class="co">#&gt; Completed:   600/1000 - in 0.299 sec</span></span>
<span id="cb15-23"><a href="#cb15-23" tabindex="-1"></a><span class="co">#&gt; Completed:   700/1000 - in 0.356 sec</span></span>
<span id="cb15-24"><a href="#cb15-24" tabindex="-1"></a><span class="co">#&gt; Completed:   800/1000 - in 0.405 sec</span></span>
<span id="cb15-25"><a href="#cb15-25" tabindex="-1"></a><span class="co">#&gt; Completed:   900/1000 - in 0.455 sec</span></span>
<span id="cb15-26"><a href="#cb15-26" tabindex="-1"></a><span class="co">#&gt; Completed:   1000/1000 - in 0.505 sec</span></span>
<span id="cb15-27"><a href="#cb15-27" tabindex="-1"></a></span>
<span id="cb15-28"><a href="#cb15-28" tabindex="-1"></a><span class="fu">posterior_estimate</span>(out, <span class="at">loss =</span> <span class="st">&quot;binder&quot;</span>)</span>
<span id="cb15-29"><a href="#cb15-29" tabindex="-1"></a><span class="co">#&gt; [1] 1 2 3 4 4</span></span></code></pre></div>
<p>Method <code>plot</code> for clustering univariate time series
represents the data colored according to the assigned cluster.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="fu">plot</span>(out, <span class="at">loss =</span> <span class="st">&quot;binder&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>If time series are multivariate, data must be an array, where each
element is a multivariate time series represented by a matrix. Each row
of the matrix is a component of the time series.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a>data_array <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="at">data =</span> <span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">100</span>,<span class="dv">5</span>))</span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a>data_array[<span class="dv">1</span>,,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">50</span>,<span class="dv">0</span>,<span class="fl">0.100</span>), <span class="fu">rnorm</span>(<span class="dv">50</span>,<span class="dv">1</span>,<span class="fl">0.250</span>)))</span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a>data_array[<span class="dv">2</span>,,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">50</span>,<span class="dv">0</span>,<span class="fl">0.100</span>), <span class="fu">rnorm</span>(<span class="dv">50</span>,<span class="dv">1</span>,<span class="fl">0.250</span>)))</span>
<span id="cb17-5"><a href="#cb17-5" tabindex="-1"></a>data_array[<span class="dv">3</span>,,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">50</span>,<span class="dv">0</span>,<span class="fl">0.100</span>), <span class="fu">rnorm</span>(<span class="dv">50</span>,<span class="dv">1</span>,<span class="fl">0.250</span>)))</span>
<span id="cb17-6"><a href="#cb17-6" tabindex="-1"></a></span>
<span id="cb17-7"><a href="#cb17-7" tabindex="-1"></a>data_array[<span class="dv">1</span>,,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">50</span>,<span class="dv">0</span>,<span class="fl">0.100</span>), <span class="fu">rnorm</span>(<span class="dv">50</span>,<span class="dv">1</span>,<span class="fl">0.250</span>)))</span>
<span id="cb17-8"><a href="#cb17-8" tabindex="-1"></a>data_array[<span class="dv">2</span>,,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">50</span>,<span class="dv">0</span>,<span class="fl">0.100</span>), <span class="fu">rnorm</span>(<span class="dv">50</span>,<span class="dv">1</span>,<span class="fl">0.250</span>)))</span>
<span id="cb17-9"><a href="#cb17-9" tabindex="-1"></a>data_array[<span class="dv">3</span>,,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">50</span>,<span class="dv">0</span>,<span class="fl">0.100</span>), <span class="fu">rnorm</span>(<span class="dv">50</span>,<span class="dv">1</span>,<span class="fl">0.250</span>)))</span>
<span id="cb17-10"><a href="#cb17-10" tabindex="-1"></a></span>
<span id="cb17-11"><a href="#cb17-11" tabindex="-1"></a>data_array[<span class="dv">1</span>,,<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">50</span>,<span class="dv">0</span>,<span class="fl">0.175</span>), <span class="fu">rnorm</span>(<span class="dv">50</span>,<span class="dv">1</span>,<span class="fl">0.280</span>)))</span>
<span id="cb17-12"><a href="#cb17-12" tabindex="-1"></a>data_array[<span class="dv">2</span>,,<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">50</span>,<span class="dv">0</span>,<span class="fl">0.175</span>), <span class="fu">rnorm</span>(<span class="dv">50</span>,<span class="dv">1</span>,<span class="fl">0.280</span>)))</span>
<span id="cb17-13"><a href="#cb17-13" tabindex="-1"></a>data_array[<span class="dv">3</span>,,<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">50</span>,<span class="dv">0</span>,<span class="fl">0.175</span>), <span class="fu">rnorm</span>(<span class="dv">50</span>,<span class="dv">1</span>,<span class="fl">0.280</span>)))</span>
<span id="cb17-14"><a href="#cb17-14" tabindex="-1"></a></span>
<span id="cb17-15"><a href="#cb17-15" tabindex="-1"></a>data_array[<span class="dv">1</span>,,<span class="dv">4</span>] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">25</span>,<span class="dv">0</span>,<span class="fl">0.135</span>), <span class="fu">rnorm</span>(<span class="dv">75</span>,<span class="dv">1</span>,<span class="fl">0.225</span>)))</span>
<span id="cb17-16"><a href="#cb17-16" tabindex="-1"></a>data_array[<span class="dv">2</span>,,<span class="dv">4</span>] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">25</span>,<span class="dv">0</span>,<span class="fl">0.135</span>), <span class="fu">rnorm</span>(<span class="dv">75</span>,<span class="dv">1</span>,<span class="fl">0.225</span>)))</span>
<span id="cb17-17"><a href="#cb17-17" tabindex="-1"></a>data_array[<span class="dv">3</span>,,<span class="dv">4</span>] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">25</span>,<span class="dv">0</span>,<span class="fl">0.135</span>), <span class="fu">rnorm</span>(<span class="dv">75</span>,<span class="dv">1</span>,<span class="fl">0.225</span>)))</span>
<span id="cb17-18"><a href="#cb17-18" tabindex="-1"></a></span>
<span id="cb17-19"><a href="#cb17-19" tabindex="-1"></a>data_array[<span class="dv">1</span>,,<span class="dv">5</span>] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">25</span>,<span class="dv">0</span>,<span class="fl">0.155</span>), <span class="fu">rnorm</span>(<span class="dv">75</span>,<span class="dv">1</span>,<span class="fl">0.280</span>)))</span>
<span id="cb17-20"><a href="#cb17-20" tabindex="-1"></a>data_array[<span class="dv">2</span>,,<span class="dv">5</span>] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">25</span>,<span class="dv">0</span>,<span class="fl">0.155</span>), <span class="fu">rnorm</span>(<span class="dv">75</span>,<span class="dv">1</span>,<span class="fl">0.280</span>)))</span>
<span id="cb17-21"><a href="#cb17-21" tabindex="-1"></a>data_array[<span class="dv">3</span>,,<span class="dv">5</span>] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">25</span>,<span class="dv">0</span>,<span class="fl">0.155</span>), <span class="fu">rnorm</span>(<span class="dv">75</span>,<span class="dv">1</span>,<span class="fl">0.280</span>)))</span></code></pre></div>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a>out <span class="ot">&lt;-</span> <span class="fu">clust_cp</span>(<span class="at">data =</span> data_array, <span class="at">n_iterations =</span> <span class="dv">1000</span>, <span class="at">n_burnin =</span> <span class="dv">100</span>, </span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a>                <span class="at">kernel =</span> <span class="st">&quot;ts&quot;</span>, <span class="at">params =</span> <span class="fu">list</span>(<span class="at">gamma =</span> <span class="fl">0.1</span>, <span class="at">k_0 =</span> <span class="fl">0.25</span>, <span class="at">nu_0 =</span> <span class="dv">5</span>,  <span class="at">phi_0 =</span> <span class="fu">diag</span>(<span class="fl">0.1</span>,<span class="dv">3</span>,<span class="dv">3</span>), <span class="at">m_0 =</span> <span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">3</span>)))</span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a><span class="co">#&gt; Normalization constant - completed:  100/1000 - in 0.008 sec</span></span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a><span class="co">#&gt; Normalization constant - completed:  200/1000 - in 0.017 sec</span></span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a><span class="co">#&gt; Normalization constant - completed:  300/1000 - in 0.026 sec</span></span>
<span id="cb18-6"><a href="#cb18-6" tabindex="-1"></a><span class="co">#&gt; Normalization constant - completed:  400/1000 - in 0.035 sec</span></span>
<span id="cb18-7"><a href="#cb18-7" tabindex="-1"></a><span class="co">#&gt; Normalization constant - completed:  500/1000 - in 0.044 sec</span></span>
<span id="cb18-8"><a href="#cb18-8" tabindex="-1"></a><span class="co">#&gt; Normalization constant - completed:  600/1000 - in 0.052 sec</span></span>
<span id="cb18-9"><a href="#cb18-9" tabindex="-1"></a><span class="co">#&gt; Normalization constant - completed:  700/1000 - in 0.061 sec</span></span>
<span id="cb18-10"><a href="#cb18-10" tabindex="-1"></a><span class="co">#&gt; Normalization constant - completed:  800/1000 - in 0.07 sec</span></span>
<span id="cb18-11"><a href="#cb18-11" tabindex="-1"></a><span class="co">#&gt; Normalization constant - completed:  900/1000 - in 0.079 sec</span></span>
<span id="cb18-12"><a href="#cb18-12" tabindex="-1"></a><span class="co">#&gt; Normalization constant - completed:  1000/1000 - in 0.087 sec</span></span>
<span id="cb18-13"><a href="#cb18-13" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb18-14"><a href="#cb18-14" tabindex="-1"></a><span class="co">#&gt; ------ MAIN LOOP ------</span></span>
<span id="cb18-15"><a href="#cb18-15" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb18-16"><a href="#cb18-16" tabindex="-1"></a><span class="co">#&gt; Completed:   100/1000 - in 0.079 sec</span></span>
<span id="cb18-17"><a href="#cb18-17" tabindex="-1"></a><span class="co">#&gt; Completed:   200/1000 - in 0.158 sec</span></span>
<span id="cb18-18"><a href="#cb18-18" tabindex="-1"></a><span class="co">#&gt; Completed:   300/1000 - in 0.232 sec</span></span>
<span id="cb18-19"><a href="#cb18-19" tabindex="-1"></a><span class="co">#&gt; Completed:   400/1000 - in 0.307 sec</span></span>
<span id="cb18-20"><a href="#cb18-20" tabindex="-1"></a><span class="co">#&gt; Completed:   500/1000 - in 0.38 sec</span></span>
<span id="cb18-21"><a href="#cb18-21" tabindex="-1"></a><span class="co">#&gt; Completed:   600/1000 - in 0.463 sec</span></span>
<span id="cb18-22"><a href="#cb18-22" tabindex="-1"></a><span class="co">#&gt; Completed:   700/1000 - in 0.539 sec</span></span>
<span id="cb18-23"><a href="#cb18-23" tabindex="-1"></a><span class="co">#&gt; Completed:   800/1000 - in 0.623 sec</span></span>
<span id="cb18-24"><a href="#cb18-24" tabindex="-1"></a><span class="co">#&gt; Completed:   900/1000 - in 0.7 sec</span></span>
<span id="cb18-25"><a href="#cb18-25" tabindex="-1"></a><span class="co">#&gt; Completed:   1000/1000 - in 0.775 sec</span></span>
<span id="cb18-26"><a href="#cb18-26" tabindex="-1"></a></span>
<span id="cb18-27"><a href="#cb18-27" tabindex="-1"></a><span class="fu">posterior_estimate</span>(out, <span class="at">loss =</span> <span class="st">&quot;binder&quot;</span>)</span>
<span id="cb18-28"><a href="#cb18-28" tabindex="-1"></a><span class="co">#&gt; [1] 1 2 3 4 4</span></span></code></pre></div>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a><span class="fu">plot</span>(out, <span class="at">loss =</span> <span class="st">&quot;binder&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Finally, if we set <code>kernel = &quot;epi&quot;</code>, <code>clust_cp</code>
cluster survival functions with common change points. Also here details
can be found in <span class="citation">Corradin et al.
(2024)</span>.</p>
<p>Data are a matrix where each row is the number of infected at each
time. Inside this package is included the function
<code>sim_epi_data</code> that simulates infection times.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a>data_mat <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="dv">5</span>, <span class="at">ncol =</span> <span class="dv">50</span>)</span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" tabindex="-1"></a>betas <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="fl">0.45</span>, <span class="dv">25</span>),<span class="fu">rep</span>(<span class="fl">0.14</span>,<span class="dv">25</span>)),</span>
<span id="cb20-4"><a href="#cb20-4" tabindex="-1"></a>               <span class="fu">c</span>(<span class="fu">rep</span>(<span class="fl">0.55</span>, <span class="dv">25</span>),<span class="fu">rep</span>(<span class="fl">0.11</span>,<span class="dv">25</span>)),</span>
<span id="cb20-5"><a href="#cb20-5" tabindex="-1"></a>               <span class="fu">c</span>(<span class="fu">rep</span>(<span class="fl">0.50</span>, <span class="dv">25</span>),<span class="fu">rep</span>(<span class="fl">0.12</span>,<span class="dv">25</span>)),</span>
<span id="cb20-6"><a href="#cb20-6" tabindex="-1"></a>               <span class="fu">c</span>(<span class="fu">rep</span>(<span class="fl">0.52</span>, <span class="dv">10</span>),<span class="fu">rep</span>(<span class="fl">0.15</span>,<span class="dv">40</span>)),</span>
<span id="cb20-7"><a href="#cb20-7" tabindex="-1"></a>               <span class="fu">c</span>(<span class="fu">rep</span>(<span class="fl">0.53</span>, <span class="dv">10</span>),<span class="fu">rep</span>(<span class="fl">0.13</span>,<span class="dv">40</span>)))</span>
<span id="cb20-8"><a href="#cb20-8" tabindex="-1"></a></span>
<span id="cb20-9"><a href="#cb20-9" tabindex="-1"></a>  inf_times <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb20-10"><a href="#cb20-10" tabindex="-1"></a></span>
<span id="cb20-11"><a href="#cb20-11" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>){</span>
<span id="cb20-12"><a href="#cb20-12" tabindex="-1"></a></span>
<span id="cb20-13"><a href="#cb20-13" tabindex="-1"></a>    inf_times[[i]] <span class="ot">&lt;-</span> <span class="fu">sim_epi_data</span>(<span class="at">S0 =</span> <span class="dv">10000</span>, <span class="at">I0 =</span> <span class="dv">10</span>, <span class="at">max_time =</span> <span class="dv">50</span>, <span class="at">beta_vec =</span> betas[[i]], <span class="at">xi_0 =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">8</span>)</span>
<span id="cb20-14"><a href="#cb20-14" tabindex="-1"></a></span>
<span id="cb20-15"><a href="#cb20-15" tabindex="-1"></a>    vec <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">50</span>)</span>
<span id="cb20-16"><a href="#cb20-16" tabindex="-1"></a>    <span class="fu">names</span>(vec) <span class="ot">&lt;-</span> <span class="fu">as.character</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">50</span>)</span>
<span id="cb20-17"><a href="#cb20-17" tabindex="-1"></a></span>
<span id="cb20-18"><a href="#cb20-18" tabindex="-1"></a>    <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">50</span>){</span>
<span id="cb20-19"><a href="#cb20-19" tabindex="-1"></a>      <span class="cf">if</span>(<span class="fu">as.character</span>(j) <span class="sc">%in%</span> <span class="fu">names</span>(<span class="fu">table</span>(<span class="fu">floor</span>(inf_times[[i]])))){</span>
<span id="cb20-20"><a href="#cb20-20" tabindex="-1"></a>      vec[j] <span class="ot">=</span> <span class="fu">table</span>(<span class="fu">floor</span>(inf_times[[i]]))[<span class="fu">which</span>(<span class="fu">names</span>(<span class="fu">table</span>(<span class="fu">floor</span>(inf_times[[i]]))) <span class="sc">==</span> j)]</span>
<span id="cb20-21"><a href="#cb20-21" tabindex="-1"></a>      }</span>
<span id="cb20-22"><a href="#cb20-22" tabindex="-1"></a>    }</span>
<span id="cb20-23"><a href="#cb20-23" tabindex="-1"></a>    data_mat[i,] <span class="ot">&lt;-</span> vec</span>
<span id="cb20-24"><a href="#cb20-24" tabindex="-1"></a>  }</span></code></pre></div>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a>out <span class="ot">&lt;-</span> <span class="fu">clust_cp</span>(<span class="at">data =</span> data_mat, <span class="at">n_iterations =</span> <span class="dv">100</span>, <span class="at">n_burnin =</span> <span class="dv">10</span>, </span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a>                <span class="at">kernel =</span> <span class="st">&quot;epi&quot;</span>, </span>
<span id="cb21-3"><a href="#cb21-3" tabindex="-1"></a>                <span class="fu">list</span>(<span class="at">M =</span> <span class="dv">100</span>, <span class="at">B =</span> <span class="dv">1000</span>, <span class="at">L =</span> <span class="dv">1</span>, <span class="at">q =</span> <span class="fl">0.1</span>, <span class="at">gamma =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">8</span>))</span>
<span id="cb21-4"><a href="#cb21-4" tabindex="-1"></a><span class="co">#&gt; Normalization constant - completed:  100/1000 - in 0.521 sec</span></span>
<span id="cb21-5"><a href="#cb21-5" tabindex="-1"></a><span class="co">#&gt; Normalization constant - completed:  200/1000 - in 1.045 sec</span></span>
<span id="cb21-6"><a href="#cb21-6" tabindex="-1"></a><span class="co">#&gt; Normalization constant - completed:  300/1000 - in 1.573 sec</span></span>
<span id="cb21-7"><a href="#cb21-7" tabindex="-1"></a><span class="co">#&gt; Normalization constant - completed:  400/1000 - in 2.097 sec</span></span>
<span id="cb21-8"><a href="#cb21-8" tabindex="-1"></a><span class="co">#&gt; Normalization constant - completed:  500/1000 - in 2.606 sec</span></span>
<span id="cb21-9"><a href="#cb21-9" tabindex="-1"></a><span class="co">#&gt; Normalization constant - completed:  600/1000 - in 3.133 sec</span></span>
<span id="cb21-10"><a href="#cb21-10" tabindex="-1"></a><span class="co">#&gt; Normalization constant - completed:  700/1000 - in 3.641 sec</span></span>
<span id="cb21-11"><a href="#cb21-11" tabindex="-1"></a><span class="co">#&gt; Normalization constant - completed:  800/1000 - in 4.15 sec</span></span>
<span id="cb21-12"><a href="#cb21-12" tabindex="-1"></a><span class="co">#&gt; Normalization constant - completed:  900/1000 - in 4.682 sec</span></span>
<span id="cb21-13"><a href="#cb21-13" tabindex="-1"></a><span class="co">#&gt; Normalization constant - completed:  1000/1000 - in 5.195 sec</span></span>
<span id="cb21-14"><a href="#cb21-14" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb21-15"><a href="#cb21-15" tabindex="-1"></a><span class="co">#&gt; ------ MAIN LOOP ------</span></span>
<span id="cb21-16"><a href="#cb21-16" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb21-17"><a href="#cb21-17" tabindex="-1"></a><span class="co">#&gt; Completed:   10/100 - in 0.483 sec</span></span>
<span id="cb21-18"><a href="#cb21-18" tabindex="-1"></a><span class="co">#&gt; Completed:   20/100 - in 0.988 sec</span></span>
<span id="cb21-19"><a href="#cb21-19" tabindex="-1"></a><span class="co">#&gt; Completed:   30/100 - in 1.487 sec</span></span>
<span id="cb21-20"><a href="#cb21-20" tabindex="-1"></a><span class="co">#&gt; Completed:   40/100 - in 1.989 sec</span></span>
<span id="cb21-21"><a href="#cb21-21" tabindex="-1"></a><span class="co">#&gt; Completed:   50/100 - in 2.54 sec</span></span>
<span id="cb21-22"><a href="#cb21-22" tabindex="-1"></a><span class="co">#&gt; Completed:   60/100 - in 3.076 sec</span></span>
<span id="cb21-23"><a href="#cb21-23" tabindex="-1"></a><span class="co">#&gt; Completed:   70/100 - in 3.612 sec</span></span>
<span id="cb21-24"><a href="#cb21-24" tabindex="-1"></a><span class="co">#&gt; Completed:   80/100 - in 4.249 sec</span></span>
<span id="cb21-25"><a href="#cb21-25" tabindex="-1"></a><span class="co">#&gt; Completed:   90/100 - in 5.172 sec</span></span>
<span id="cb21-26"><a href="#cb21-26" tabindex="-1"></a><span class="co">#&gt; Completed:   100/100 - in 5.997 sec</span></span>
<span id="cb21-27"><a href="#cb21-27" tabindex="-1"></a></span>
<span id="cb21-28"><a href="#cb21-28" tabindex="-1"></a><span class="fu">posterior_estimate</span>(out, <span class="at">loss =</span> <span class="st">&quot;binder&quot;</span>)</span>
<span id="cb21-29"><a href="#cb21-29" tabindex="-1"></a><span class="co">#&gt; [1] 1 2 1 3 4</span></span></code></pre></div>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a><span class="fu">plot</span>(out, <span class="at">loss =</span> <span class="st">&quot;binder&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-corradin2024" class="csl-entry">
Corradin, Riccardo, Luca Danese, Wasiur R. KhudaBukhsh, and Andrea
Ongaro. 2024. <span>“Model-Based Clustering of Time-Dependent
Observations with Common Structural Changes.”</span> <a href="https://arxiv.org/abs/2410.09552">https://arxiv.org/abs/2410.09552</a>.
</div>
<div id="ref-CORRADIN202226" class="csl-entry">
———. 2025. <span>“Model-Based Clustering of Time-Dependent Observations
with Common Structural Changes.”</span> <em>Statistics and
Computing</em> 36 (1): 7. <a href="https://doi.org/10.1007/s11222-025-10756-x">https://doi.org/10.1007/s11222-025-10756-x</a>.
</div>
<div id="ref-Dahl02102022" class="csl-entry">
David B. Dahl, Devin J. Johnson, and Peter Müller. 2022. <span>“Search
Algorithms and Loss Functions for Bayesian Clustering.”</span>
<em>Journal of Computational and Graphical Statistics</em> 31 (4):
1189–1201. <a href="https://doi.org/10.1080/10618600.2022.2069779">https://doi.org/10.1080/10618600.2022.2069779</a>.
</div>
<div id="ref-MM2014" class="csl-entry">
Martínez, Asael Fabian, and Ramsés H. Mena. 2014. <span>“<span class="nocase">On a Nonparametric Change Point Detection Model in
Markovian Regimes</span>.”</span> <em>Bayesian Analysis</em> 9 (4):
823–58. <a href="https://doi.org/10.1214/14-BA878">https://doi.org/10.1214/14-BA878</a>.
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
