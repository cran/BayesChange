<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>BayesChange Tutorial</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">

div.csl-bib-body { }
div.csl-entry {
clear: both;
margin-bottom: 0em;
}
.hanging div.csl-entry {
margin-left:2em;
text-indent:-2em;
}
div.csl-left-margin {
min-width:2em;
float:left;
}
div.csl-right-inline {
margin-left:2em;
padding-left:1em;
}
div.csl-indent {
margin-left: 2em;
}
</style>

<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">BayesChange Tutorial</h1>



<p>Here we provide a brief tutorial of the <code>BayesChange</code>
package. The <code>BayesChange</code> package contains two main
functions: one that performs change points detection on time series and
survival functions and one that perform clustering of time series and
survival functions with common change points. Here we briefly show how
to implement these.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(BayesChange)</span></code></pre></div>
<div id="detecting-change-points" class="section level2">
<h2>Detecting change points</h2>
<p>The function <code>detect_cp</code> provide a method for detecting
change points, it is based on the work <span class="citation">Martínez
and Mena (2014)</span> and on <span class="citation">Corradin, Danese,
and Ongaro (2022)</span>.</p>
<p>Depending on the structure of the data, <code>detect_cp</code> might
perform change points detection on univariate time series or
multivariate time series. For example we can create a vector of 100
observations where the first 50 observations are sampled from a normal
distribution with mean 0 and variance 0.1 and the other 50 observations
still from a normal distribution with mean 0 but variance 0.25.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a>data_uni <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">50</span>,<span class="dv">0</span>,<span class="fl">0.1</span>), <span class="fu">rnorm</span>(<span class="dv">50</span>,<span class="dv">1</span>,<span class="fl">0.25</span>)))</span></code></pre></div>
<p>Now we can run the function <code>detect_cp</code>, as arguments of
the function we need to specify the number of iterations, the number of
burn-in steps and a list with the the autoregressive coefficient
<code>phi</code> for the likelihood of the data, the parameters
<code>a</code>, <code>b</code>, <code>c</code> for the priors and the
probability <code>q</code> of performing a split at each step. Since we
deal with time series we need also to specify
<code>kernel = &quot;ts&quot;</code>.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>out <span class="ot">&lt;-</span> <span class="fu">detect_cp</span>(<span class="at">data =</span> data_uni,                             </span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>                 <span class="at">n_iterations =</span> <span class="dv">1000</span>, <span class="at">n_burnin =</span> <span class="dv">100</span>,  </span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>                 <span class="at">params =</span> <span class="fu">list</span>(<span class="at">q =</span> <span class="fl">0.25</span>, <span class="at">phi =</span> <span class="fl">0.1</span>, <span class="at">a =</span> <span class="dv">1</span>, <span class="at">b =</span> <span class="dv">1</span>, <span class="at">c =</span> <span class="fl">0.1</span>), <span class="at">kernel =</span> <span class="st">&quot;ts&quot;</span>)</span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a><span class="co">#&gt; Completed:   100/1000 - in 0.009 sec</span></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a><span class="co">#&gt; Completed:   200/1000 - in 0.019 sec</span></span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a><span class="co">#&gt; Completed:   300/1000 - in 0.029 sec</span></span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a><span class="co">#&gt; Completed:   400/1000 - in 0.04 sec</span></span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a><span class="co">#&gt; Completed:   500/1000 - in 0.052 sec</span></span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a><span class="co">#&gt; Completed:   600/1000 - in 0.063 sec</span></span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a><span class="co">#&gt; Completed:   700/1000 - in 0.074 sec</span></span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a><span class="co">#&gt; Completed:   800/1000 - in 0.084 sec</span></span>
<span id="cb3-12"><a href="#cb3-12" tabindex="-1"></a><span class="co">#&gt; Completed:   900/1000 - in 0.093 sec</span></span>
<span id="cb3-13"><a href="#cb3-13" tabindex="-1"></a><span class="co">#&gt; Completed:   1000/1000 - in 0.102 sec</span></span></code></pre></div>
<p>With the methods <code>print</code> and <code>summary</code> we can
get information about the algorithm.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="fu">print</span>(out)</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="co">#&gt; DetectCpObj object</span></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a><span class="co">#&gt; Type: change points detection on univariate time series</span></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a><span class="fu">summary</span>(out)</span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a><span class="co">#&gt; DetectCpObj object</span></span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a><span class="co">#&gt; Detecting change points on an univariate time series:</span></span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a><span class="co">#&gt;  Number of burn-in iterations: 100 </span></span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a><span class="co">#&gt;  Number of MCMC iterations: 900 </span></span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a><span class="co">#&gt;  Computational time: 0.1 seconds</span></span></code></pre></div>
<p>In order to get a point estimate of the change points we can use the
method <code>posterior_estimate</code> that uses the method
<em>salso</em> by <span class="citation">David B. Dahl and Müller
(2022)</span> to get the final latent order and then detect the change
points.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="fu">table</span>(<span class="fu">posterior_estimate</span>(out, <span class="at">loss =</span> <span class="st">&quot;binder&quot;</span>))</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a><span class="co">#&gt;  1  2  3 </span></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a><span class="co">#&gt; 50  1 49</span></span></code></pre></div>
<p>The package also provides a method for plotting the change
points.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="fu">plot</span>(out, <span class="at">loss =</span> <span class="st">&quot;binder&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>If we define instead a matrix of data, <code>detect_cp</code>
automatically performs a multivariate change points detection
method.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>data_multi <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="dv">3</span>, <span class="at">ncol =</span> <span class="dv">100</span>)</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>data_multi[<span class="dv">1</span>,] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">50</span>,<span class="dv">0</span>,<span class="fl">0.100</span>), <span class="fu">rnorm</span>(<span class="dv">50</span>,<span class="dv">1</span>,<span class="fl">0.250</span>)))</span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a>data_multi[<span class="dv">2</span>,] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">50</span>,<span class="dv">0</span>,<span class="fl">0.125</span>), <span class="fu">rnorm</span>(<span class="dv">50</span>,<span class="dv">1</span>,<span class="fl">0.225</span>)))</span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a>data_multi[<span class="dv">3</span>,] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">50</span>,<span class="dv">0</span>,<span class="fl">0.175</span>), <span class="fu">rnorm</span>(<span class="dv">50</span>,<span class="dv">1</span>,<span class="fl">0.280</span>)))</span></code></pre></div>
<p>Arguments <code>k_0</code>, <code>nu_0</code>, <code>phi_0</code>,
<code>m_0</code>, <code>par_theta_c</code>, <code>par_theta_d</code> and
<code>prior_var_gamma</code> correspond to the parameters of the prior
distributions for the multivariate likelihood.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>out <span class="ot">&lt;-</span> <span class="fu">detect_cp</span>(<span class="at">data =</span> data_multi, <span class="at">n_iterations =</span> <span class="dv">1000</span>, <span class="at">n_burnin =</span> <span class="dv">100</span>,</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>                 <span class="at">q =</span> <span class="fl">0.25</span>, <span class="at">params =</span> <span class="fu">list</span>(<span class="at">k_0 =</span> <span class="fl">0.25</span>, <span class="at">nu_0 =</span> <span class="dv">4</span>, <span class="at">phi_0 =</span> <span class="fu">diag</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">3</span>), </span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a>                      <span class="at">m_0 =</span> <span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">3</span>), <span class="at">par_theta_c =</span> <span class="dv">2</span>, <span class="at">par_theta_d =</span> <span class="fl">0.2</span>, </span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a>                      <span class="at">prior_var_gamma =</span> <span class="fl">0.1</span>), <span class="at">kernel =</span> <span class="st">&quot;ts&quot;</span>)</span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a><span class="co">#&gt; Completed:   100/1000 - in 0.013 sec</span></span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a><span class="co">#&gt; Completed:   200/1000 - in 0.028 sec</span></span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a><span class="co">#&gt; Completed:   300/1000 - in 0.04 sec</span></span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a><span class="co">#&gt; Completed:   400/1000 - in 0.051 sec</span></span>
<span id="cb8-9"><a href="#cb8-9" tabindex="-1"></a><span class="co">#&gt; Completed:   500/1000 - in 0.063 sec</span></span>
<span id="cb8-10"><a href="#cb8-10" tabindex="-1"></a><span class="co">#&gt; Completed:   600/1000 - in 0.075 sec</span></span>
<span id="cb8-11"><a href="#cb8-11" tabindex="-1"></a><span class="co">#&gt; Completed:   700/1000 - in 0.087 sec</span></span>
<span id="cb8-12"><a href="#cb8-12" tabindex="-1"></a><span class="co">#&gt; Completed:   800/1000 - in 0.099 sec</span></span>
<span id="cb8-13"><a href="#cb8-13" tabindex="-1"></a><span class="co">#&gt; Completed:   900/1000 - in 0.11 sec</span></span>
<span id="cb8-14"><a href="#cb8-14" tabindex="-1"></a><span class="co">#&gt; Completed:   1000/1000 - in 0.122 sec</span></span>
<span id="cb8-15"><a href="#cb8-15" tabindex="-1"></a></span>
<span id="cb8-16"><a href="#cb8-16" tabindex="-1"></a><span class="fu">table</span>(<span class="fu">posterior_estimate</span>(out, <span class="at">loss =</span> <span class="st">&quot;binder&quot;</span>))</span>
<span id="cb8-17"><a href="#cb8-17" tabindex="-1"></a><span class="co">#&gt; Warning in salso::salso(mcmc_chain, loss = &quot;binder&quot;, maxNClusters =</span></span>
<span id="cb8-18"><a href="#cb8-18" tabindex="-1"></a><span class="co">#&gt; maxNClusters, : The number of clusters equals the default maximum possible</span></span>
<span id="cb8-19"><a href="#cb8-19" tabindex="-1"></a><span class="co">#&gt; number of clusters.</span></span>
<span id="cb8-20"><a href="#cb8-20" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb8-21"><a href="#cb8-21" tabindex="-1"></a><span class="co">#&gt;  1  2 </span></span>
<span id="cb8-22"><a href="#cb8-22" tabindex="-1"></a><span class="co">#&gt; 50 50</span></span></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="fu">plot</span>(out, <span class="at">loss =</span> <span class="st">&quot;binder&quot;</span>, <span class="at">plot_freq =</span> <span class="cn">TRUE</span>)</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a><span class="co">#&gt; Warning in salso::salso(mcmc_chain, loss = &quot;binder&quot;, maxNClusters =</span></span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a><span class="co">#&gt; maxNClusters, : The number of clusters equals the default maximum possible</span></span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a><span class="co">#&gt; number of clusters.</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Function <code>detect_cp</code> can also be used to detect change
points on survival functions. We define a matrix of one row and a vector
with the infection rates.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>data_mat <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="dv">100</span>, <span class="at">ncol =</span> <span class="dv">1</span>)</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>betas <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="fl">0.45</span>, <span class="dv">25</span>),<span class="fu">rep</span>(<span class="fl">0.14</span>,<span class="dv">75</span>))</span></code></pre></div>
<p>With function <code>sim_epi_data</code> we simulate a set of
infection times.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a>inf_times <span class="ot">&lt;-</span> <span class="fu">sim_epi_data</span>(<span class="dv">10000</span>, <span class="dv">10</span>, <span class="dv">100</span>, betas, <span class="dv">1</span><span class="sc">/</span><span class="dv">8</span>)</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>inf_times_vec <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">100</span>)</span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a><span class="fu">names</span>(inf_times_vec) <span class="ot">&lt;-</span> <span class="fu">as.character</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>)</span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a></span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>){</span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a> <span class="cf">if</span>(<span class="fu">as.character</span>(j) <span class="sc">%in%</span> <span class="fu">names</span>(<span class="fu">table</span>(<span class="fu">floor</span>(inf_times)))){</span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a>   inf_times_vec[j] <span class="ot">=</span> <span class="fu">table</span>(<span class="fu">floor</span>(inf_times))[<span class="fu">which</span>(<span class="fu">names</span>(<span class="fu">table</span>(<span class="fu">floor</span>(inf_times))) <span class="sc">==</span> j)]</span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a> }</span>
<span id="cb11-10"><a href="#cb11-10" tabindex="-1"></a>}</span>
<span id="cb11-11"><a href="#cb11-11" tabindex="-1"></a></span>
<span id="cb11-12"><a href="#cb11-12" tabindex="-1"></a>data_mat[,<span class="dv">1</span>] <span class="ot">&lt;-</span> inf_times_vec</span></code></pre></div>
<p>To run <code>detect_cp</code> on epidemiological data we need to set
<code>kernel = &quot;epi&quot;</code>. Moreover, besides the usual parameters, we
need to set the number of Monte Carlo replications <code>M</code> for
the approximation of the integrated likelihood and the recovery rate
<code>xi</code>. <code>a0</code> and <code>b0</code> are optional and
correspond to the parameters of the gamma distribution for the
integration of the likelihood.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a>out <span class="ot">&lt;-</span> <span class="fu">detect_cp</span>(<span class="at">data =</span> data_mat, <span class="at">n_iterations =</span> <span class="dv">200</span>, <span class="at">n_burnin =</span> <span class="dv">50</span>,</span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>                 <span class="at">params =</span> <span class="fu">list</span>(<span class="at">xi =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">8</span>, <span class="at">a0 =</span> <span class="dv">40</span>, <span class="at">b0 =</span> <span class="dv">10</span>, <span class="at">M =</span> <span class="dv">1000</span>), <span class="at">kernel =</span> <span class="st">&quot;epi&quot;</span>)</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a><span class="co">#&gt; Completed:   20/200 - in 1.306 sec</span></span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a><span class="co">#&gt; Completed:   40/200 - in 2.724 sec</span></span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a><span class="co">#&gt; Completed:   60/200 - in 4.224 sec</span></span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a><span class="co">#&gt; Completed:   80/200 - in 5.82 sec</span></span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a><span class="co">#&gt; Completed:   100/200 - in 7.448 sec</span></span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a><span class="co">#&gt; Completed:   120/200 - in 9.055 sec</span></span>
<span id="cb12-9"><a href="#cb12-9" tabindex="-1"></a><span class="co">#&gt; Completed:   140/200 - in 10.726 sec</span></span>
<span id="cb12-10"><a href="#cb12-10" tabindex="-1"></a><span class="co">#&gt; Completed:   160/200 - in 12.465 sec</span></span>
<span id="cb12-11"><a href="#cb12-11" tabindex="-1"></a><span class="co">#&gt; Completed:   180/200 - in 14.181 sec</span></span>
<span id="cb12-12"><a href="#cb12-12" tabindex="-1"></a><span class="co">#&gt; Completed:   200/200 - in 15.962 sec</span></span>
<span id="cb12-13"><a href="#cb12-13" tabindex="-1"></a></span>
<span id="cb12-14"><a href="#cb12-14" tabindex="-1"></a><span class="fu">print</span>(out)</span>
<span id="cb12-15"><a href="#cb12-15" tabindex="-1"></a><span class="co">#&gt; DetectCpObj object</span></span>
<span id="cb12-16"><a href="#cb12-16" tabindex="-1"></a><span class="co">#&gt; Type: change points detection on an epidemic diffusion</span></span>
<span id="cb12-17"><a href="#cb12-17" tabindex="-1"></a><span class="fu">table</span>(<span class="fu">posterior_estimate</span>(out, <span class="at">loss =</span> <span class="st">&quot;binder&quot;</span>))</span>
<span id="cb12-18"><a href="#cb12-18" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb12-19"><a href="#cb12-19" tabindex="-1"></a><span class="co">#&gt;  1  2  3  4 </span></span>
<span id="cb12-20"><a href="#cb12-20" tabindex="-1"></a><span class="co">#&gt; 29 29 27 15</span></span></code></pre></div>
<p>Also here, with function <code>plot</code> we can plot the survival
function and the position of the change points.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="fu">plot</span>(out)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="clustering-time-dependent-data-with-common-change-points" class="section level2">
<h2>Clustering time dependent data with common change points</h2>
<p><code>BayesChange</code> contains another function,
<code>clust_cp</code>, that cluster respectively univariate and
multivariate time series and survival functions with common change
points. Details about this methods can be found in <span class="citation">Corradin et al. (2024)</span>.</p>
<p>In <code>clust_cp</code> the argument <code>kernel</code> must be
specified, if data are time series then <code>kernel = &quot;ts&quot;</code> must
be set. Then the algorithm automatically detects if data are univariate
or multivariate.</p>
<p>If time series are univariate we need to set a matrix where each row
is a time series.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a>data_mat <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="dv">5</span>, <span class="at">ncol =</span> <span class="dv">100</span>)</span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a>data_mat[<span class="dv">1</span>,] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">50</span>,<span class="dv">0</span>,<span class="fl">0.100</span>), <span class="fu">rnorm</span>(<span class="dv">50</span>,<span class="dv">1</span>,<span class="fl">0.250</span>)))</span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a>data_mat[<span class="dv">2</span>,] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">50</span>,<span class="dv">0</span>,<span class="fl">0.125</span>), <span class="fu">rnorm</span>(<span class="dv">50</span>,<span class="dv">1</span>,<span class="fl">0.225</span>)))</span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a>data_mat[<span class="dv">3</span>,] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">50</span>,<span class="dv">0</span>,<span class="fl">0.175</span>), <span class="fu">rnorm</span>(<span class="dv">50</span>,<span class="dv">1</span>,<span class="fl">0.280</span>)))</span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a>data_mat[<span class="dv">4</span>,] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">25</span>,<span class="dv">0</span>,<span class="fl">0.135</span>), <span class="fu">rnorm</span>(<span class="dv">75</span>,<span class="dv">1</span>,<span class="fl">0.225</span>)))</span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a>data_mat[<span class="dv">5</span>,] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">25</span>,<span class="dv">0</span>,<span class="fl">0.155</span>), <span class="fu">rnorm</span>(<span class="dv">75</span>,<span class="dv">1</span>,<span class="fl">0.280</span>)))</span></code></pre></div>
<p>Arguments that need to be specified in <code>clust_cp</code> are the
number of iterations <code>n_iterations</code>, the number of elements
in the normalisation constant <code>B</code>, the split-and-merge step
<code>L</code> performed when a new partition is proposed and a list
with the parameters of the algorithm, the likelihood and the
priors..</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a>out <span class="ot">&lt;-</span> <span class="fu">clust_cp</span>(<span class="at">data =</span> data_mat, <span class="at">n_iterations =</span> <span class="dv">1000</span>, <span class="at">n_burnin =</span> <span class="dv">100</span>, </span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a>                <span class="at">kernel =</span> <span class="st">&quot;ts&quot;</span>,</span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a>                <span class="at">params =</span> <span class="fu">list</span>(<span class="at">B =</span> <span class="dv">1000</span>, <span class="at">L =</span> <span class="dv">1</span>, <span class="at">gamma =</span> <span class="fl">0.5</span>))</span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a><span class="co">#&gt; Normalization constant - completed:  100/1000 - in 0.004 sec</span></span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a><span class="co">#&gt; Normalization constant - completed:  200/1000 - in 0.008 sec</span></span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a><span class="co">#&gt; Normalization constant - completed:  300/1000 - in 0.012 sec</span></span>
<span id="cb15-7"><a href="#cb15-7" tabindex="-1"></a><span class="co">#&gt; Normalization constant - completed:  400/1000 - in 0.016 sec</span></span>
<span id="cb15-8"><a href="#cb15-8" tabindex="-1"></a><span class="co">#&gt; Normalization constant - completed:  500/1000 - in 0.02 sec</span></span>
<span id="cb15-9"><a href="#cb15-9" tabindex="-1"></a><span class="co">#&gt; Normalization constant - completed:  600/1000 - in 0.024 sec</span></span>
<span id="cb15-10"><a href="#cb15-10" tabindex="-1"></a><span class="co">#&gt; Normalization constant - completed:  700/1000 - in 0.028 sec</span></span>
<span id="cb15-11"><a href="#cb15-11" tabindex="-1"></a><span class="co">#&gt; Normalization constant - completed:  800/1000 - in 0.032 sec</span></span>
<span id="cb15-12"><a href="#cb15-12" tabindex="-1"></a><span class="co">#&gt; Normalization constant - completed:  900/1000 - in 0.036 sec</span></span>
<span id="cb15-13"><a href="#cb15-13" tabindex="-1"></a><span class="co">#&gt; Normalization constant - completed:  1000/1000 - in 0.04 sec</span></span>
<span id="cb15-14"><a href="#cb15-14" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb15-15"><a href="#cb15-15" tabindex="-1"></a><span class="co">#&gt; ------ MAIN LOOP ------</span></span>
<span id="cb15-16"><a href="#cb15-16" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb15-17"><a href="#cb15-17" tabindex="-1"></a><span class="co">#&gt; Completed:   100/1000 - in 0.056 sec</span></span>
<span id="cb15-18"><a href="#cb15-18" tabindex="-1"></a><span class="co">#&gt; Completed:   200/1000 - in 0.111 sec</span></span>
<span id="cb15-19"><a href="#cb15-19" tabindex="-1"></a><span class="co">#&gt; Completed:   300/1000 - in 0.167 sec</span></span>
<span id="cb15-20"><a href="#cb15-20" tabindex="-1"></a><span class="co">#&gt; Completed:   400/1000 - in 0.22 sec</span></span>
<span id="cb15-21"><a href="#cb15-21" tabindex="-1"></a><span class="co">#&gt; Completed:   500/1000 - in 0.275 sec</span></span>
<span id="cb15-22"><a href="#cb15-22" tabindex="-1"></a><span class="co">#&gt; Completed:   600/1000 - in 0.333 sec</span></span>
<span id="cb15-23"><a href="#cb15-23" tabindex="-1"></a><span class="co">#&gt; Completed:   700/1000 - in 0.394 sec</span></span>
<span id="cb15-24"><a href="#cb15-24" tabindex="-1"></a><span class="co">#&gt; Completed:   800/1000 - in 0.449 sec</span></span>
<span id="cb15-25"><a href="#cb15-25" tabindex="-1"></a><span class="co">#&gt; Completed:   900/1000 - in 0.5 sec</span></span>
<span id="cb15-26"><a href="#cb15-26" tabindex="-1"></a><span class="co">#&gt; Completed:   1000/1000 - in 0.552 sec</span></span>
<span id="cb15-27"><a href="#cb15-27" tabindex="-1"></a></span>
<span id="cb15-28"><a href="#cb15-28" tabindex="-1"></a><span class="fu">posterior_estimate</span>(out, <span class="at">loss =</span> <span class="st">&quot;binder&quot;</span>)</span>
<span id="cb15-29"><a href="#cb15-29" tabindex="-1"></a><span class="co">#&gt; [1] 1 2 3 4 4</span></span></code></pre></div>
<p>Method <code>plot</code> for clustering univariate time series
represents the data colored according to the assigned cluster.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="fu">plot</span>(out, <span class="at">loss =</span> <span class="st">&quot;binder&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>If time series are multivariate, data must be an array, where each
element is a multivariate time series represented by a matrix. Each row
of the matrix is a component of the time series.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a>data_array <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="at">data =</span> <span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">100</span>,<span class="dv">5</span>))</span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a>data_array[<span class="dv">1</span>,,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">50</span>,<span class="dv">0</span>,<span class="fl">0.100</span>), <span class="fu">rnorm</span>(<span class="dv">50</span>,<span class="dv">1</span>,<span class="fl">0.250</span>)))</span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a>data_array[<span class="dv">2</span>,,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">50</span>,<span class="dv">0</span>,<span class="fl">0.100</span>), <span class="fu">rnorm</span>(<span class="dv">50</span>,<span class="dv">1</span>,<span class="fl">0.250</span>)))</span>
<span id="cb17-5"><a href="#cb17-5" tabindex="-1"></a>data_array[<span class="dv">3</span>,,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">50</span>,<span class="dv">0</span>,<span class="fl">0.100</span>), <span class="fu">rnorm</span>(<span class="dv">50</span>,<span class="dv">1</span>,<span class="fl">0.250</span>)))</span>
<span id="cb17-6"><a href="#cb17-6" tabindex="-1"></a></span>
<span id="cb17-7"><a href="#cb17-7" tabindex="-1"></a>data_array[<span class="dv">1</span>,,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">50</span>,<span class="dv">0</span>,<span class="fl">0.100</span>), <span class="fu">rnorm</span>(<span class="dv">50</span>,<span class="dv">1</span>,<span class="fl">0.250</span>)))</span>
<span id="cb17-8"><a href="#cb17-8" tabindex="-1"></a>data_array[<span class="dv">2</span>,,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">50</span>,<span class="dv">0</span>,<span class="fl">0.100</span>), <span class="fu">rnorm</span>(<span class="dv">50</span>,<span class="dv">1</span>,<span class="fl">0.250</span>)))</span>
<span id="cb17-9"><a href="#cb17-9" tabindex="-1"></a>data_array[<span class="dv">3</span>,,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">50</span>,<span class="dv">0</span>,<span class="fl">0.100</span>), <span class="fu">rnorm</span>(<span class="dv">50</span>,<span class="dv">1</span>,<span class="fl">0.250</span>)))</span>
<span id="cb17-10"><a href="#cb17-10" tabindex="-1"></a></span>
<span id="cb17-11"><a href="#cb17-11" tabindex="-1"></a>data_array[<span class="dv">1</span>,,<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">50</span>,<span class="dv">0</span>,<span class="fl">0.175</span>), <span class="fu">rnorm</span>(<span class="dv">50</span>,<span class="dv">1</span>,<span class="fl">0.280</span>)))</span>
<span id="cb17-12"><a href="#cb17-12" tabindex="-1"></a>data_array[<span class="dv">2</span>,,<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">50</span>,<span class="dv">0</span>,<span class="fl">0.175</span>), <span class="fu">rnorm</span>(<span class="dv">50</span>,<span class="dv">1</span>,<span class="fl">0.280</span>)))</span>
<span id="cb17-13"><a href="#cb17-13" tabindex="-1"></a>data_array[<span class="dv">3</span>,,<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">50</span>,<span class="dv">0</span>,<span class="fl">0.175</span>), <span class="fu">rnorm</span>(<span class="dv">50</span>,<span class="dv">1</span>,<span class="fl">0.280</span>)))</span>
<span id="cb17-14"><a href="#cb17-14" tabindex="-1"></a></span>
<span id="cb17-15"><a href="#cb17-15" tabindex="-1"></a>data_array[<span class="dv">1</span>,,<span class="dv">4</span>] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">25</span>,<span class="dv">0</span>,<span class="fl">0.135</span>), <span class="fu">rnorm</span>(<span class="dv">75</span>,<span class="dv">1</span>,<span class="fl">0.225</span>)))</span>
<span id="cb17-16"><a href="#cb17-16" tabindex="-1"></a>data_array[<span class="dv">2</span>,,<span class="dv">4</span>] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">25</span>,<span class="dv">0</span>,<span class="fl">0.135</span>), <span class="fu">rnorm</span>(<span class="dv">75</span>,<span class="dv">1</span>,<span class="fl">0.225</span>)))</span>
<span id="cb17-17"><a href="#cb17-17" tabindex="-1"></a>data_array[<span class="dv">3</span>,,<span class="dv">4</span>] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">25</span>,<span class="dv">0</span>,<span class="fl">0.135</span>), <span class="fu">rnorm</span>(<span class="dv">75</span>,<span class="dv">1</span>,<span class="fl">0.225</span>)))</span>
<span id="cb17-18"><a href="#cb17-18" tabindex="-1"></a></span>
<span id="cb17-19"><a href="#cb17-19" tabindex="-1"></a>data_array[<span class="dv">1</span>,,<span class="dv">5</span>] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">25</span>,<span class="dv">0</span>,<span class="fl">0.155</span>), <span class="fu">rnorm</span>(<span class="dv">75</span>,<span class="dv">1</span>,<span class="fl">0.280</span>)))</span>
<span id="cb17-20"><a href="#cb17-20" tabindex="-1"></a>data_array[<span class="dv">2</span>,,<span class="dv">5</span>] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">25</span>,<span class="dv">0</span>,<span class="fl">0.155</span>), <span class="fu">rnorm</span>(<span class="dv">75</span>,<span class="dv">1</span>,<span class="fl">0.280</span>)))</span>
<span id="cb17-21"><a href="#cb17-21" tabindex="-1"></a>data_array[<span class="dv">3</span>,,<span class="dv">5</span>] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">25</span>,<span class="dv">0</span>,<span class="fl">0.155</span>), <span class="fu">rnorm</span>(<span class="dv">75</span>,<span class="dv">1</span>,<span class="fl">0.280</span>)))</span></code></pre></div>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a>out <span class="ot">&lt;-</span> <span class="fu">clust_cp</span>(<span class="at">data =</span> data_array, <span class="at">n_iterations =</span> <span class="dv">1000</span>, <span class="at">n_burnin =</span> <span class="dv">100</span>, </span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a>                <span class="at">kernel =</span> <span class="st">&quot;ts&quot;</span>, <span class="at">params =</span> <span class="fu">list</span>(<span class="at">gamma =</span> <span class="fl">0.1</span>, <span class="at">k_0 =</span> <span class="fl">0.25</span>, <span class="at">nu_0 =</span> <span class="dv">5</span>,  <span class="at">phi_0 =</span> <span class="fu">diag</span>(<span class="fl">0.1</span>,<span class="dv">3</span>,<span class="dv">3</span>), <span class="at">m_0 =</span> <span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">3</span>)))</span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a><span class="co">#&gt; Normalization constant - completed:  100/1000 - in 0.007 sec</span></span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a><span class="co">#&gt; Normalization constant - completed:  200/1000 - in 0.014 sec</span></span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a><span class="co">#&gt; Normalization constant - completed:  300/1000 - in 0.021 sec</span></span>
<span id="cb18-6"><a href="#cb18-6" tabindex="-1"></a><span class="co">#&gt; Normalization constant - completed:  400/1000 - in 0.028 sec</span></span>
<span id="cb18-7"><a href="#cb18-7" tabindex="-1"></a><span class="co">#&gt; Normalization constant - completed:  500/1000 - in 0.035 sec</span></span>
<span id="cb18-8"><a href="#cb18-8" tabindex="-1"></a><span class="co">#&gt; Normalization constant - completed:  600/1000 - in 0.042 sec</span></span>
<span id="cb18-9"><a href="#cb18-9" tabindex="-1"></a><span class="co">#&gt; Normalization constant - completed:  700/1000 - in 0.049 sec</span></span>
<span id="cb18-10"><a href="#cb18-10" tabindex="-1"></a><span class="co">#&gt; Normalization constant - completed:  800/1000 - in 0.056 sec</span></span>
<span id="cb18-11"><a href="#cb18-11" tabindex="-1"></a><span class="co">#&gt; Normalization constant - completed:  900/1000 - in 0.066 sec</span></span>
<span id="cb18-12"><a href="#cb18-12" tabindex="-1"></a><span class="co">#&gt; Normalization constant - completed:  1000/1000 - in 0.076 sec</span></span>
<span id="cb18-13"><a href="#cb18-13" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb18-14"><a href="#cb18-14" tabindex="-1"></a><span class="co">#&gt; ------ MAIN LOOP ------</span></span>
<span id="cb18-15"><a href="#cb18-15" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb18-16"><a href="#cb18-16" tabindex="-1"></a><span class="co">#&gt; Completed:   100/1000 - in 0.088 sec</span></span>
<span id="cb18-17"><a href="#cb18-17" tabindex="-1"></a><span class="co">#&gt; Completed:   200/1000 - in 0.165 sec</span></span>
<span id="cb18-18"><a href="#cb18-18" tabindex="-1"></a><span class="co">#&gt; Completed:   300/1000 - in 0.241 sec</span></span>
<span id="cb18-19"><a href="#cb18-19" tabindex="-1"></a><span class="co">#&gt; Completed:   400/1000 - in 0.315 sec</span></span>
<span id="cb18-20"><a href="#cb18-20" tabindex="-1"></a><span class="co">#&gt; Completed:   500/1000 - in 0.392 sec</span></span>
<span id="cb18-21"><a href="#cb18-21" tabindex="-1"></a><span class="co">#&gt; Completed:   600/1000 - in 0.47 sec</span></span>
<span id="cb18-22"><a href="#cb18-22" tabindex="-1"></a><span class="co">#&gt; Completed:   700/1000 - in 0.558 sec</span></span>
<span id="cb18-23"><a href="#cb18-23" tabindex="-1"></a><span class="co">#&gt; Completed:   800/1000 - in 0.645 sec</span></span>
<span id="cb18-24"><a href="#cb18-24" tabindex="-1"></a><span class="co">#&gt; Completed:   900/1000 - in 0.72 sec</span></span>
<span id="cb18-25"><a href="#cb18-25" tabindex="-1"></a><span class="co">#&gt; Completed:   1000/1000 - in 0.789 sec</span></span>
<span id="cb18-26"><a href="#cb18-26" tabindex="-1"></a></span>
<span id="cb18-27"><a href="#cb18-27" tabindex="-1"></a><span class="fu">posterior_estimate</span>(out, <span class="at">loss =</span> <span class="st">&quot;binder&quot;</span>)</span>
<span id="cb18-28"><a href="#cb18-28" tabindex="-1"></a><span class="co">#&gt; [1] 1 2 2 3 3</span></span></code></pre></div>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a><span class="fu">plot</span>(out, <span class="at">loss =</span> <span class="st">&quot;binder&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Finally, if we set <code>kernel = &quot;epi&quot;</code>, <code>clust_cp</code>
cluster survival functions with common change points. Also here details
can be found in <span class="citation">Corradin et al.
(2024)</span>.</p>
<p>Data are a matrix where each row is the number of infected at each
time. Inside this package is included the function
<code>sim_epi_data</code> that simulates infection times.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a>data_mat <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="dv">5</span>, <span class="at">ncol =</span> <span class="dv">50</span>)</span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" tabindex="-1"></a>betas <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="fl">0.45</span>, <span class="dv">25</span>),<span class="fu">rep</span>(<span class="fl">0.14</span>,<span class="dv">25</span>)),</span>
<span id="cb20-4"><a href="#cb20-4" tabindex="-1"></a>               <span class="fu">c</span>(<span class="fu">rep</span>(<span class="fl">0.55</span>, <span class="dv">25</span>),<span class="fu">rep</span>(<span class="fl">0.11</span>,<span class="dv">25</span>)),</span>
<span id="cb20-5"><a href="#cb20-5" tabindex="-1"></a>               <span class="fu">c</span>(<span class="fu">rep</span>(<span class="fl">0.50</span>, <span class="dv">25</span>),<span class="fu">rep</span>(<span class="fl">0.12</span>,<span class="dv">25</span>)),</span>
<span id="cb20-6"><a href="#cb20-6" tabindex="-1"></a>               <span class="fu">c</span>(<span class="fu">rep</span>(<span class="fl">0.52</span>, <span class="dv">10</span>),<span class="fu">rep</span>(<span class="fl">0.15</span>,<span class="dv">40</span>)),</span>
<span id="cb20-7"><a href="#cb20-7" tabindex="-1"></a>               <span class="fu">c</span>(<span class="fu">rep</span>(<span class="fl">0.53</span>, <span class="dv">10</span>),<span class="fu">rep</span>(<span class="fl">0.13</span>,<span class="dv">40</span>)))</span>
<span id="cb20-8"><a href="#cb20-8" tabindex="-1"></a></span>
<span id="cb20-9"><a href="#cb20-9" tabindex="-1"></a>  inf_times <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb20-10"><a href="#cb20-10" tabindex="-1"></a></span>
<span id="cb20-11"><a href="#cb20-11" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>){</span>
<span id="cb20-12"><a href="#cb20-12" tabindex="-1"></a></span>
<span id="cb20-13"><a href="#cb20-13" tabindex="-1"></a>    inf_times[[i]] <span class="ot">&lt;-</span> <span class="fu">sim_epi_data</span>(<span class="at">S0 =</span> <span class="dv">10000</span>, <span class="at">I0 =</span> <span class="dv">10</span>, <span class="at">max_time =</span> <span class="dv">50</span>, <span class="at">beta_vec =</span> betas[[i]], <span class="at">xi_0 =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">8</span>)</span>
<span id="cb20-14"><a href="#cb20-14" tabindex="-1"></a></span>
<span id="cb20-15"><a href="#cb20-15" tabindex="-1"></a>    vec <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">50</span>)</span>
<span id="cb20-16"><a href="#cb20-16" tabindex="-1"></a>    <span class="fu">names</span>(vec) <span class="ot">&lt;-</span> <span class="fu">as.character</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">50</span>)</span>
<span id="cb20-17"><a href="#cb20-17" tabindex="-1"></a></span>
<span id="cb20-18"><a href="#cb20-18" tabindex="-1"></a>    <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">50</span>){</span>
<span id="cb20-19"><a href="#cb20-19" tabindex="-1"></a>      <span class="cf">if</span>(<span class="fu">as.character</span>(j) <span class="sc">%in%</span> <span class="fu">names</span>(<span class="fu">table</span>(<span class="fu">floor</span>(inf_times[[i]])))){</span>
<span id="cb20-20"><a href="#cb20-20" tabindex="-1"></a>      vec[j] <span class="ot">=</span> <span class="fu">table</span>(<span class="fu">floor</span>(inf_times[[i]]))[<span class="fu">which</span>(<span class="fu">names</span>(<span class="fu">table</span>(<span class="fu">floor</span>(inf_times[[i]]))) <span class="sc">==</span> j)]</span>
<span id="cb20-21"><a href="#cb20-21" tabindex="-1"></a>      }</span>
<span id="cb20-22"><a href="#cb20-22" tabindex="-1"></a>    }</span>
<span id="cb20-23"><a href="#cb20-23" tabindex="-1"></a>    data_mat[i,] <span class="ot">&lt;-</span> vec</span>
<span id="cb20-24"><a href="#cb20-24" tabindex="-1"></a>  }</span></code></pre></div>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a>out <span class="ot">&lt;-</span> <span class="fu">clust_cp</span>(<span class="at">data =</span> data_mat, <span class="at">n_iterations =</span> <span class="dv">100</span>, <span class="at">n_burnin =</span> <span class="dv">10</span>, </span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a>                <span class="at">kernel =</span> <span class="st">&quot;epi&quot;</span>, </span>
<span id="cb21-3"><a href="#cb21-3" tabindex="-1"></a>                <span class="fu">list</span>(<span class="at">M =</span> <span class="dv">100</span>, <span class="at">B =</span> <span class="dv">1000</span>, <span class="at">L =</span> <span class="dv">1</span>, <span class="at">q =</span> <span class="fl">0.1</span>, <span class="at">gamma =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">8</span>))</span>
<span id="cb21-4"><a href="#cb21-4" tabindex="-1"></a><span class="co">#&gt; Normalization constant - completed:  100/1000 - in 0.505 sec</span></span>
<span id="cb21-5"><a href="#cb21-5" tabindex="-1"></a><span class="co">#&gt; Normalization constant - completed:  200/1000 - in 1.023 sec</span></span>
<span id="cb21-6"><a href="#cb21-6" tabindex="-1"></a><span class="co">#&gt; Normalization constant - completed:  300/1000 - in 1.542 sec</span></span>
<span id="cb21-7"><a href="#cb21-7" tabindex="-1"></a><span class="co">#&gt; Normalization constant - completed:  400/1000 - in 2.048 sec</span></span>
<span id="cb21-8"><a href="#cb21-8" tabindex="-1"></a><span class="co">#&gt; Normalization constant - completed:  500/1000 - in 2.553 sec</span></span>
<span id="cb21-9"><a href="#cb21-9" tabindex="-1"></a><span class="co">#&gt; Normalization constant - completed:  600/1000 - in 3.059 sec</span></span>
<span id="cb21-10"><a href="#cb21-10" tabindex="-1"></a><span class="co">#&gt; Normalization constant - completed:  700/1000 - in 3.564 sec</span></span>
<span id="cb21-11"><a href="#cb21-11" tabindex="-1"></a><span class="co">#&gt; Normalization constant - completed:  800/1000 - in 4.069 sec</span></span>
<span id="cb21-12"><a href="#cb21-12" tabindex="-1"></a><span class="co">#&gt; Normalization constant - completed:  900/1000 - in 4.574 sec</span></span>
<span id="cb21-13"><a href="#cb21-13" tabindex="-1"></a><span class="co">#&gt; Normalization constant - completed:  1000/1000 - in 5.089 sec</span></span>
<span id="cb21-14"><a href="#cb21-14" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb21-15"><a href="#cb21-15" tabindex="-1"></a><span class="co">#&gt; ------ MAIN LOOP ------</span></span>
<span id="cb21-16"><a href="#cb21-16" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb21-17"><a href="#cb21-17" tabindex="-1"></a><span class="co">#&gt; Completed:   10/100 - in 0.482 sec</span></span>
<span id="cb21-18"><a href="#cb21-18" tabindex="-1"></a><span class="co">#&gt; Completed:   20/100 - in 1.067 sec</span></span>
<span id="cb21-19"><a href="#cb21-19" tabindex="-1"></a><span class="co">#&gt; Completed:   30/100 - in 1.918 sec</span></span>
<span id="cb21-20"><a href="#cb21-20" tabindex="-1"></a><span class="co">#&gt; Completed:   40/100 - in 2.972 sec</span></span>
<span id="cb21-21"><a href="#cb21-21" tabindex="-1"></a><span class="co">#&gt; Completed:   50/100 - in 4.117 sec</span></span>
<span id="cb21-22"><a href="#cb21-22" tabindex="-1"></a><span class="co">#&gt; Completed:   60/100 - in 4.901 sec</span></span>
<span id="cb21-23"><a href="#cb21-23" tabindex="-1"></a><span class="co">#&gt; Completed:   70/100 - in 5.506 sec</span></span>
<span id="cb21-24"><a href="#cb21-24" tabindex="-1"></a><span class="co">#&gt; Completed:   80/100 - in 6.038 sec</span></span>
<span id="cb21-25"><a href="#cb21-25" tabindex="-1"></a><span class="co">#&gt; Completed:   90/100 - in 6.629 sec</span></span>
<span id="cb21-26"><a href="#cb21-26" tabindex="-1"></a><span class="co">#&gt; Completed:   100/100 - in 7.191 sec</span></span>
<span id="cb21-27"><a href="#cb21-27" tabindex="-1"></a></span>
<span id="cb21-28"><a href="#cb21-28" tabindex="-1"></a><span class="fu">posterior_estimate</span>(out, <span class="at">loss =</span> <span class="st">&quot;binder&quot;</span>)</span>
<span id="cb21-29"><a href="#cb21-29" tabindex="-1"></a><span class="co">#&gt; [1] 1 2 2 1 1</span></span></code></pre></div>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a><span class="fu">plot</span>(out, <span class="at">loss =</span> <span class="st">&quot;binder&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAulBMVEUAAAAAADoAAGYAOpAAZrY3frg6AAA6ADo6AGY6kNtNTU1NTW5NTY5NbqtNjshmAABmADpmtrZmtv9uTU1uTW5uTY5ubo5ubqtuq+SOTU2OTW6OTY6Obk2OyP+QOgCQkDqQtpCQ2/+rbk2rbm6rbo6ryKur5OSr5P+2ZgC22/+2///Ijk3I///bkDrb/7bb///kGhzkq27k///r6+v/tmb/yI7/25D/27b/5Kv//7b//8j//9v//+T///8pATeSAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAO9UlEQVR4nO2dC3/dphmHncRK6qRdMqfb3G12616W0zhnJZXtObH5/l9r4g4SVwkQQvz7yzmHg7DxU64vvHACm6w6WTsDpasBcqgBcqgBcqgBcqgBcmgRoN4cskQlTxZVDZBDDZBDDZBDDZBDDZBDDZBDVkAPf/uE37/+8Pq7P/mbKV/7A3T3+lsM6OnnS/j5L+zNmK/dAbp58xspQV//9QkVJvpmzNfuAPEq9vCPP+HXf36gbyxPBWotQHffYTL0TYofcgQGdVitBKkliOcLIYIYEfqgRIWHCgf05e35l7cnzz+y8INfGwQImV5mVCegwyk8Pv94PGVhiuPp5wvSi12YejHMZQihmkYQVQloKECPV6fwlhchBAj98xgHDVhwiCGqFdCXt2cSIJfkfAFAQri9BnUCerw6u312jSqap5R88Ra6g6gtMj+4XUDw/uXJKTy8+MM3sZoviRDsemB+cLuAQmUDBIHxwb0C6hVCUCZUA6BhAMQ0q5FGgKAg1CuEagA0R+MsAxWQINQAkZBUhHooE6oF0NCLLaliUBCigGDoxKNsQMM46PFqGCue+yY2A6LtdGWAEJrDMJL2HghNsyyKEJSLUEWAjqczpxpTQFIRqgQQmmQMdI4LShAn1CtFqBZAQyMEDyfDdMxTDkCiCNUCKFS6LFNCHBAONkAixAAprVAlgNhsY0EjjXkQJBUCIvrybkkbxIpQr3RkVQFaNA6CuwC0qIrROlYzIH+Toj7LYAQoxEJdNiDaSPuNg8wLwGD4D6uj/0COZWek1ICCZSpBtMyIOlZJCQqWIctgBAiCGgBFMLmyDzIgUoRqAIR0RGiW2IOIAEPC61glgCiahd28BpCyBNQA4TpWJSBWxc58E/sAUoz39mT2qBIAwVvURns3QRZAFAkrQt4L0aUDCpQxy6ABwrIAIkhqAkS230UZB9UJaI5sgCAjhAH57vXYIyD0rxJAAR08kTnLqJtHTOoCBI9BnbwLEILCAXnuFioc0KCDrz0IyQ2INkIVARp0WN6L0ZE0qBDQIaCX9wQEu2oABdUv6AY0UOGA/DbklQ0owBJEZMkyYG9dRYCCtStAUacaAgeoBtAceQAifX2vfFULIO7c8/k10iV+/9bXZ5VvVgSVAJqsaqhOzsgf8+ZylHhXgJCUVQ3FwRC5Yj798mGU2JplvlkRVANINdorLqqoKA1VDlU0lieX2IJzN3zqlG+SKS8g2ckZvz98Py5F9v+nchHCnzz23ZddgtRVDbkE3XFXTKUdcmSZ26VBLYCUVQ25Dbq5YE/MAkQ/VQBIluTkTCoWKkZPv4YcTSGMioAHPZKFh9YcB2GvZ1LThnHQG6Ujc2aZGRV7pQhtF9Bib59JgBo8eqUIbRYQcpoP0t4AxTR3sAAh1HcYztYBPV41QBMpbZD/xhcinywDCkjsaNguoJj2oBEgPJ7ePKBgeWUZUECCUAMEGyAivywDCkg423klCwnlABRxG/Ao0IEqAM2RZ5bxrmlMqAHSBjrQAE1CWkDu8812CohNyRogfaBD5g7JqNgAwRoBpevm8dIzkOrYNgEhRfL2mQS6tQEdqSPl/avp7p7//W5NmsSZZRxAC4dsZcPu4psE0OMV8sI9npzrAOmYydoDIOqlfHzxx0JA0bx9xgG89Mzs9lYP1hSApDZjoIGBoBdsgD9Hr2dDGcMt7/03P04a4NnePiFLwnjlmSw8g5QL0PqcSmVEAkTeX56jd2yMRwXs5dQon+VWBGnzAvdG9EgWqQTdf8MLhQyIfovCt7RzGnhNUue5NkJyOwT5AWlLENqxekpjj2R4c6Zrj1RAw5Pn/gdQBQLiSz8W/8OUbdCXd9cyIDz0e/4RA6J/shPQ4cV/yZHSnpoJyOIclaQXo3//EdOQAJFqhaoY3fzsAoT3cZ4n6OaZ8ypd+skNSBkHoU768erZNf4rcficPDBQKgaQ2fcn0Uj6II2kUcf+13fXuMdG3x2Gpgh188NnZxU7oiqWYBxEZ6ps6Sc/oAXSjIP8ncbmACIDRZPnRumAAuXfXyt1bLOAks3FOCBxdI5h330DtGFAR24wiz8O4oD4ZHWDgNLsD6KhOgAFawYgPhfT77svHBA67DZkH97uAOE7WVLMxXo2EIKQ33Gj3RRcNqCEvRiUilADpIsSgLg9SLffrGxAyWzS1QBKNhdTAAl/VneyWb8tqnLd1KsDpFmIboCQgEJoU4BS2aRNgOB4GbFwQKpNWlxpSN2dF931zM9UFHsVyef1AUnrQlOZTa6S1zPxolt213O5gG6t21nMgITHIXVUXXbXs9zPy3NVsDagw7OffEuQapMWPqvU3XnZXc8df1HXn2OuRJv+SDCVHO1dxdRxkPB6pu7O2rueTSFbCerVImRNNue3hSoAkKzR1c43l4a7nvWh+gDRBkho1OTcXEZrg3rJdwyqy4hbAiS8nqm7s+Wu52loGiW6sW0CkmzStNcTXs/U3XnROMgMyPN4s9UBJbVJQwWQ7J+J4rzOXiphJB2qYEDkZbuA4vvNS6ExINke5HNyTgGAEvjNSyEbIJ9TKwoAlL4NUgApBjO3v28BgFL4zYvQFJBsMNsEoCR+8yLEuzHeLMsWRaevXQGAkvjNixAvQqLfkiyKWwAUrJiAnJ5SuwSkmFwdjkD7BCRbFAsHlNChzgZItijaHYHWBjRHMQCplqFdA+KElMmFyqoBmgLqZVYrAEITUMsAuShAAVfZRQOELia2eR0WAMi4BpQF0C2aoB/MRchscvVQdEA2T6kFgLqplHjb9dYlADItceRqpNHWTKMsNmm3YgEyWPAzAbLvGMtnDxIuLVNAwmCWH5DOUVXS7EZ6ztKwtPw8XnEGkw8zNOfvcPCZ7g9KtAUPi9YxpczQOGEwm7MItKAEkZbFoxfDD6fbxIllASTsQZkBuZRrGzCWF6A5i0B7ACQMZuUCylPFjJdIcHtQ+CpZtslqjkbafMsGKB9QoCID4rP54GXEvQEKXiWrEZC2mNjcOPYAiHZjbkChq2R1AZJPDBw/aXHjaIDkLwsFlHR/EJITUK8QKg1Q2v1BSBsHlNoepAIyeBzKhEoDlHZ/ENLGASXeH4RE9gcpdWycTLdsH/bboirj/iAkD0DSzo/SAAUrLaCAVbJ9ARJFqDxAic0dKiDdfEKdx3qvkuUClNpg5gkofBEo7zgonckVsv1Bch3TJWO1r2xAwrnn4T2+gTbormdDlB8gHuXpKrVKFRNOzsjNELllBt31bIjyBMQnq36LQKs00sLB8A5hurkMvOtZH5IBaabsE0B+axyrdPOqi+rwKfCuZ7066dW6zAx69zNj5QWkODkjd8zQu561IbqJU6pjhmRBi0A5ShDeHyRPNeQS9PUHdpdxyFXG2lDnCUhMVj3WOFapYpKT88P7S/ZtPkAhi0CrdPPCyZnyCb/rWReSAU2tYjpAHmsca46DhkKExj+oeQ6/61kT8gcUsAiUBVDSo0rFxxmA3ItAeUuQv+YAors7RCNkSQaU9/UBpTe5IgUA6hVC6wPKX4ImhueyAcGA48uwkgNSKtn6gDLYpGEgIK1rouu3RVVmkytSFwLIz4RfL6Dx361JBrQPrgQouU0aiWx/4UXImYwRKgBQeps00nYB5bBJI6nnurqTAeXN/duiam1APucouk34dVWxYEBsqrE+oDyN9GiPh08yOpI2rnHU1c3LdyTAUdPSAOFQMCA21TAtAuWtYv4z1nyA2JDbsAhUWSPdK42Q50GTATfeRNUa3bx6PrnvSZz+F7pEVQGAfH0MgfS6UhXD12l6VrE5y6pc8uHS/qunwPVsakDBRwjNLkFyEVKaFmsypQhV3c1PAHl6iMmEdgbI0wFKIlTzVKNXZhvKjNSRjDy1HqBc4yConstJ5OXfI4pQ3d28DpCf+wontENAft4ZgNayXVQxtp2Kyc/5AEyfrK+RVg8N5PLbWw8mT9bXzW8TUJ7NCzIgdh4Vl5/zARg/mbeR9tcSQMqBXSIKeM3tAbQZAaIq/+YFBRA7C0aK8prbA7AGoDybF3hIPixHjgJeU1dgJhlVqzXSo4MqlCjgMTMD5k34UbUiIHX5R40C7okHyA7oEFC5iKIA6jvtg86Jh1yEsgA6DC30MYzQQkBsqiEdHCr3VK5xtUQoByA8CAocCUUChA9b1Tw4umlv8kMEoRyA8CDIeqrpVEsBySNpwmhSSoCpodkHIHWg2HW6B4G+HuEBgd7OFlUrAxqgqCHlKGMaBYx9GqgfEIGiRnFKUp82ufuTjZg07KLKcm2EcOqln5Zd4WcL8ZIj17fx0di9fEm0OmJaZaAonHrpp2VXGXuENEjgqDyJksSTrQZIONTRT8uuEQ1IpjlcXf1KvW53YqmNKh+nXvpp2VXGs6U5kL4b88q09KxKOPXST8uuMs6YLKpml6BpvvYGaL02aGmyqLL1Yhe8F7sgvdiiq4zzJYsqiz1IXGWcfBwUN1lUrWkwS5UsqhoghxoghxoghxoghxYB2oMaIIcaIIcaIIcaIIcaIIcaIIcaIIcaIIfmA5oYP7iwVU0bTQ+F1cXdkXNiDT8Vraho4+j5subMLNVsQNNFIKY7lGNtND0UVheHoGqXlog+D1y1ceTYQnNmFms2oKkBlurmzW/IxqaLpofCmpJqzbok5u//vtT+SHoyqDEzyzUb0NSEL6KGrBqjtdZ/oqEM6KOefvnPUER0cfR8WUtmlmo2oOkiEBcCZIpGhm193MP7Nx8MUZ8vUB3SxdHzZS2ZWarMJQgfCmtKaipcw5dPhhKEdXNZYgmyVPsHUxtEDz01N1/65omcBHoRmiyOFvRi40UgLpRVbTQ9FFYXRyuJ6aeiEmRK9vTrJ0tmlirrOIgdCmuIQwfFzhgHWZJFUBtJO9QAOdQAOdQAOdQAOdQAOZQd0OMVO/f8/tV17l8+Q6uUoG2gIWqAHFoR0PB6/+qnlycnZ+gC3HNS+wI91tJrZUAvkZPaCfFUw/fghvoVJ9fagM7RBcrnOHBLDsYIdE1PrbWr2DUNDS/0Yo8gd5r0KglQabULqyBA+Ay+4lQQoMeroQgVR6kgQLibL41Pm4u51AA51AA51AA51AA51AA51AA51AA51AA51AA59H90c8JCQAet3gAAAABJRU5ErkJggg==" /><!-- --></p>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-corradin2024" class="csl-entry">
Corradin, Riccardo, Luca Danese, Wasiur R. KhudaBukhsh, and Andrea
Ongaro. 2024. <span>“Model-Based Clustering of Time-Dependent
Observations with Common Structural Changes.”</span> <a href="https://arxiv.org/abs/2410.09552">https://arxiv.org/abs/2410.09552</a>.
</div>
<div id="ref-CORRADIN202226" class="csl-entry">
Corradin, Riccardo, Luca Danese, and Andrea Ongaro. 2022.
<span>“Bayesian Nonparametric Change Point Detection for Multivariate
Time Series with Missing Observations.”</span> <em>International Journal
of Approximate Reasoning</em> 143: 26–43. https://doi.org/<a href="https://doi.org/10.1016/j.ijar.2021.12.019">https://doi.org/10.1016/j.ijar.2021.12.019</a>.
</div>
<div id="ref-Dahl02102022" class="csl-entry">
David B. Dahl, Devin J. Johnson, and Peter Müller. 2022. <span>“Search
Algorithms and Loss Functions for Bayesian Clustering.”</span>
<em>Journal of Computational and Graphical Statistics</em> 31 (4):
1189–1201. <a href="https://doi.org/10.1080/10618600.2022.2069779">https://doi.org/10.1080/10618600.2022.2069779</a>.
</div>
<div id="ref-MM2014" class="csl-entry">
Martínez, Asael Fabian, and Ramsés H. Mena. 2014. <span>“<span class="nocase">On a Nonparametric Change Point Detection Model in
Markovian Regimes</span>.”</span> <em>Bayesian Analysis</em> 9 (4):
823–58. <a href="https://doi.org/10.1214/14-BA878">https://doi.org/10.1214/14-BA878</a>.
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
