<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>BayesChange Tutorial</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">

div.csl-bib-body { }
div.csl-entry {
clear: both;
margin-bottom: 0em;
}
.hanging div.csl-entry {
margin-left:2em;
text-indent:-2em;
}
div.csl-left-margin {
min-width:2em;
float:left;
}
div.csl-right-inline {
margin-left:2em;
padding-left:1em;
}
div.csl-indent {
margin-left: 2em;
}
</style>

<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">BayesChange Tutorial</h1>



<p>Here we provide a brief tutorial of the <code>BayesChange</code>
package. The <code>BayesChange</code> package contains two main
functions: one that performs change points detection on time series and
survival functions and one that perform clustering of time series and
survival functions with common change points. Here we briefly show how
to implement these.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(BayesChange)</span></code></pre></div>
<div id="detecting-change-points" class="section level2">
<h2>Detecting change points</h2>
<p>The function <code>detect_cp</code> provide a method for detecting
change points, it is based on the work <span class="citation">Martínez
and Mena (2014)</span> and on <span class="citation">Corradin et al.
(2025)</span>.</p>
<p>Depending on the structure of the data, <code>detect_cp</code> might
perform change points detection on univariate time series or
multivariate time series. For example we can create a vector of 100
observations where the first 50 observations are sampled from a normal
distribution with mean 0 and variance 0.1 and the other 50 observations
still from a normal distribution with mean 0 but variance 0.25.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a>data_uni <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">50</span>,<span class="dv">0</span>,<span class="fl">0.1</span>), <span class="fu">rnorm</span>(<span class="dv">50</span>,<span class="dv">1</span>,<span class="fl">0.25</span>)))</span></code></pre></div>
<p>Now we can run the function <code>detect_cp</code>, as arguments of
the function we need to specify the number of iterations, the number of
burn-in steps and a list with the the autoregressive coefficient
<code>phi</code> for the likelihood of the data, the parameters
<code>a</code>, <code>b</code>, <code>c</code> for the priors and the
probability <code>q</code> of performing a split at each step. Since we
deal with time series we need also to specify
<code>kernel = &quot;ts&quot;</code>.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>out <span class="ot">&lt;-</span> <span class="fu">detect_cp</span>(<span class="at">data =</span> data_uni,                             </span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>                 <span class="at">n_iterations =</span> <span class="dv">1000</span>, <span class="at">n_burnin =</span> <span class="dv">100</span>,  </span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>                 <span class="at">params =</span> <span class="fu">list</span>(<span class="at">q =</span> <span class="fl">0.25</span>, <span class="at">phi =</span> <span class="fl">0.1</span>, <span class="at">a =</span> <span class="dv">1</span>, <span class="at">b =</span> <span class="dv">1</span>, <span class="at">c =</span> <span class="fl">0.1</span>), <span class="at">kernel =</span> <span class="st">&quot;ts&quot;</span>)</span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a><span class="co">#&gt; Completed:   100/1000 - in 0.009 sec</span></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a><span class="co">#&gt; Completed:   200/1000 - in 0.02 sec</span></span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a><span class="co">#&gt; Completed:   300/1000 - in 0.029 sec</span></span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a><span class="co">#&gt; Completed:   400/1000 - in 0.037 sec</span></span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a><span class="co">#&gt; Completed:   500/1000 - in 0.046 sec</span></span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a><span class="co">#&gt; Completed:   600/1000 - in 0.054 sec</span></span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a><span class="co">#&gt; Completed:   700/1000 - in 0.063 sec</span></span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a><span class="co">#&gt; Completed:   800/1000 - in 0.086 sec</span></span>
<span id="cb3-12"><a href="#cb3-12" tabindex="-1"></a><span class="co">#&gt; Completed:   900/1000 - in 0.096 sec</span></span>
<span id="cb3-13"><a href="#cb3-13" tabindex="-1"></a><span class="co">#&gt; Completed:   1000/1000 - in 0.109 sec</span></span></code></pre></div>
<p>With the methods <code>print</code> and <code>summary</code> we can
get information about the algorithm.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="fu">print</span>(out)</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="co">#&gt; DetectCpObj object</span></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a><span class="co">#&gt; Type: change points detection on univariate time series</span></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a><span class="fu">summary</span>(out)</span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a><span class="co">#&gt; DetectCpObj object</span></span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a><span class="co">#&gt; Detecting change points on an univariate time series:</span></span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a><span class="co">#&gt;  Number of burn-in iterations: 100 </span></span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a><span class="co">#&gt;  Number of MCMC iterations: 900 </span></span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a><span class="co">#&gt;  Computational time: 0.11 seconds</span></span></code></pre></div>
<p>In order to get a point estimate of the change points we can use the
method <code>posterior_estimate</code> that uses the method
<em>salso</em> by <span class="citation">David B. Dahl and Müller
(2022)</span> to get the final latent order and then detect the change
points.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="fu">table</span>(<span class="fu">posterior_estimate</span>(out, <span class="at">loss =</span> <span class="st">&quot;binder&quot;</span>))</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a><span class="co">#&gt; Warning in salso::salso(mcmc_chain, loss = &quot;binder&quot;, maxNClusters =</span></span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a><span class="co">#&gt; maxNClusters, : The number of clusters equals the default maximum possible</span></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a><span class="co">#&gt; number of clusters.</span></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a><span class="co">#&gt;  1  2 </span></span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a><span class="co">#&gt; 50 50</span></span></code></pre></div>
<p>The package also provides a method for plotting the change
points.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="fu">plot</span>(out, <span class="at">loss =</span> <span class="st">&quot;binder&quot;</span>)</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a><span class="co">#&gt; Warning in salso::salso(mcmc_chain, loss = &quot;binder&quot;, maxNClusters =</span></span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a><span class="co">#&gt; maxNClusters, : The number of clusters equals the default maximum possible</span></span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a><span class="co">#&gt; number of clusters.</span></span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAApVBMVEUAAAAAADoAAGYAOpAAZrY6AAA6ADo6kNtNTU1NTW5NTY5NbqtNjshmAABmADpmOpBmZrZmtv9uTU1uTW5uTY5ubqtuq+SOTU2OTW6OTY6OyP+QOgCQtpCQ2/+rbk2rbm6rbo6ryKur5P+2ZgC2///Ijk3I///bkDrb/7bb///kGhzkq27k///r6+v/tmb/yI7/25D/5Kv//7b//8j//9v//+T////d50wwAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAKi0lEQVR4nO3dCXvbNhIGYDWXnbberrdtshtvesRx3E5iJ77w/39aBZIgDgIYgKQogPzmcXRwCAJ8DYKUI0E7gYjG7tgNKD0AxASAmAAQEwBiAkBMjAe6GZMaVWifCjXz8I0AEJMCEJMCEJOqBOh4hQDEpADEpADEpCoBwiANoAmFAMSnnGbSco2oBMgJADGpUoDufvnU3H8+PT39/tOUaiYVKhboq1K5eje1mkmFSgW6ev1n24Oefv8wtZpJhcodpLtD7OHt/hDrO9HNMWJnP6XD15gDdPfzB08vQg/Sg7SMwTgEoJKAnCAKZWZvRArQ1x++iKc/ijrNFwQk/+2vg14PTmQAYgJATBx1kAaQkwJQFhAJADkpAGWlAMSkAMSkAMSkADRIzTdIE4DiKQAx22uByJ8EkAXkUaoWyA7qdw5A3hSAmBSAmBSABil3kAaQk5oNiAAU314UiABkAtGagOyYAtQqkDAvN3UOQABi/ldaAdEQSC6aA+jwb6xggyLv76Dgk25Js4yof3hj3ukC44F6qDGpww/SVg8ansg9PUgN1uTdXjVA5r5aQIOBxNheDhD5G1EPkLGzswL1Tv5G1ANk7K0PiIR93wJ5LnXWCSRcoO5ZKpB+0ACRAJAFRGL1QCQAFE2ZQMYrzTQgEqsH2qUCEYDmAqL+ULW358RagMgP1K+rGbcGpAwiQHpMXy+QuZPzARlI2wIiXQhAiUD6VAWgTQI1zbTOSACyUplAJADkA6IUIPmH5y0D9Uo9kKZZMZA2sfeYBVJ5F8goACC9ehiIQo1YDVB/PAFoJqD2ub3NeoGGg7QNROoUBiCiBCB5swSQ+tTzw9vTH75k7VB+pkYgNXfH02/vxOcfs3YoP5MIRGIKUHszF1A/d8fD/z5ZH6GfsK+TB2kGyBipk4DEFCA9NcWvX8TDf9Xnwie/N2NMkLql/k0Z+j0Z+oeoX0mtYq1OVglniR05QHJiAQ2kf63BOFAPUp3D6UHGT/8/ysfsQUk7lJ8ZCWQcXyaQ0O8jcyQUkBlTgQoYg9pmBoEUkwfI7SqHAHr67U0RZzEOiEQESCH6gdSCEUDyXyHXQUGgDsI4hS0EFA0AMVHUIC0mAcWmuqgQyBx1g0DNO3r9QEaHUbFyIPXcD6TzADLvNwZkDtLJQDaDAeT6AEitDyDPvc6vH6gfiNvHIhdIlRwChRtRCVCP4gAZuwogYQMZx4zOee51HkDee50HkHV/Q1sCUoO0iQIgI3VgoEgj6gYyP2MKIJEJFBykb1YI5PvdZwLp09oEoOvd7vz6+d/hpka3lZCaCCSODHT5/K+z88eLF+GmRreVkFoUyAn9gmss0P3Z+f5H3D77GG5rbFsJqZFA/R4ByJ8i1czjAolreYjdn52EmxrdVkKqciBxu9tHms82gXLiKEBmOEDuJ6KGQKMaUcfkJt6pTNw3rRDZ90kbCYYP6P5s10SBg7Rv6bF60P2/3oc3EN1WQuqYQOMa4TnEbtMupcsDsu8PCFTgIZY0SNv3hwO6LLAH+YHsWesOD9QN0t8VOAaVAZQXAGKigEF6USB1EVTTdRB6kEoBiEmVAvTtZamHWBmD9OPFyeNF8zezlNggkKS5PCnypUY5QNcvKnqpsfgYdNnoJP6/zxYH6f0gJC6LfKnhW4rTvE4lAenlczZCX0n/O1xsejWTChUCdJZ4/TOqmkmFEgfpwzTCqFm+Gku7BMqvZlKhAJD82+qiQKJ580Li/4ptFKjpRgW+u6MgIFHm36S9i9GD+lQxQMWOQd7FSwO5ZzH9Ud7Pp6fdNB5jq5lUKAi0RCPM6yD7NYYxpcnVu6nVTCoUHKSXBfrJGXr0dAJPv7uzLmRXM6lQGUCD0BNS7I+109O+E2W9R2KmoJ136SGr5IH0lCZ3P3/w9CL0IHtKk8E4tLVBehDOlCYAckNPaSIPtqc/tn6aH0Z7HSQ70f466PXgRAYgJjY/SHMBICYAxMTxgRZpRCVAx2sEgJgUgJgUgJhUJUAYpAE0oRCA2BSAmBQGaSYFICYFICYFICaFQZpJAYhJAYhJAYhJYZBmUgBiUgBiUlUBHfItFaHwv7vjoDEeKIydkMJZjEmNA6JgMwHUBICYVM6MUXM3AkBMCkBM6hhA/v0FUJ8ZAbStQRpAAMquxsoACIN0uBqKt4AH8iUBZBTyTTi/ISBSN8N93jaQNW1EHMiTWtMgHQeiFKD2+2Tt0qsBogQgCgCRXnNLQMZu9zbkBzLg7PQagche0u27ATQQigJlNYJLFQbUDzlyaLmhCJDZs6x01UDO7zoERCwQic0DCQB1HCEg0QN5rnaiQBUP0uTsShCo7Vsm0GAk3hAQGTvamwgOyOhYawPSZ2f5sxEgPbmJfjTc1nig4TfIhYHSdyghNROQntzEmOZksC3SF4DCBHLI4kCNzY2oDEhPLOBMMWBtKwHIPG1pIPMlKdEAyEIpE0hPTWFPUuG8MaX7IfMZ9QuaO7ohew1q1yJzG80T41tnzJlLDjqLSSB4ID25iX40xNaHkPGMhj1IXUIaPUhY67Q9SPcVuweVOEiHepC9LfMqsNMIAHWFyA/Ubq8qoOQxyAWyrpQTgMjYXk1AenIT/Wi4LQWTDyRqBzImN4lcB1mn5QMAkb2U36GE1KJX0iZQtzOkjzkApQOpQnEgHV1uNUDGOKT+6tOnbSD7qkBvIQxEM+3rqEIlA5EGKnKQZmIARP09B6Sudzig7lCtGcgYVCkHSJhZb9tUR1sNkAo1kfosQGKFQGqO3hCQMICsxwOgfgs1D9JhIKN7TASKTYpcO5B5MaMKOUCmnbuddpUVA1G/xCi0KaDAu50cIDEdqNJB2vsSQAOZF5F2oa0AeaMHInORXSgJSN0DyL89Y52VAlmLAoUoESi3EdEUgJhUIUD2okAhCqci2+MbEU0dGciTmgQUTa0eKJYyt7emQTqaAhCTGlUIQHwKQCsapI/wTotjxHigMHZCags9aFQ1kwoBiE9hkAbQhEIA4lM1Am0kAMQEgJgAEBMAYgJATACICQAxASAmRgJ531oejbv/NF+H7P3i8XB0q2dVJ8vIunKqaj5p0dViVzYOyP8Ru1jID8PIr0T2fvF4ONrV86uTH1DKqOqrlOxqcSobB+T/eEu0CbLKq3f+Lx4PRrd6dnXy15FR1dXrP+UHLtpanMrGAfk/IMXFvoT9xeN8iXb17OpkD8iqSop0tTiVjQPyf8SOCfmhIf8XjwejWz23umbdrKokUFeLU9lyPejh7ZvuUfY4lFvd136QTa1q7h6UPwbtz2J9W7OBcqu7epNb1d3MY5D/I3bRFrQ+/i8eD0a3emZ17YGVVZUU6WpxKlvqOsi4OBl+8Xi0mFw9r7ruAMmpau7roA0FgJgAEBMAYgJATACIiRKBHi92bbz49ur9sRtTIpCMAmjaABATZQPtb7+9+v/L3e7k2/7mvD36nn1csiHlA718/re43smbZx8fL14Icb1/vFxUALTvOO3Nq/e3svfcn50v2JDygeQDdXPdnt1OFmxIZUCLHl1N1AV0+93i57a6gB4v9l1oWaW6gJrT/LK9qFSgYgJATACICQAxASAmAMQEgJgAEBMAYgJATPwDYobludo5OPkAAAAASUVORK5CYII=" /><!-- --></p>
<p>If we define instead a matrix of data, <code>detect_cp</code>
automatically performs a multivariate change points detection
method.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>data_multi <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="dv">3</span>, <span class="at">ncol =</span> <span class="dv">100</span>)</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>data_multi[<span class="dv">1</span>,] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">50</span>,<span class="dv">0</span>,<span class="fl">0.100</span>), <span class="fu">rnorm</span>(<span class="dv">50</span>,<span class="dv">1</span>,<span class="fl">0.250</span>)))</span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a>data_multi[<span class="dv">2</span>,] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">50</span>,<span class="dv">0</span>,<span class="fl">0.125</span>), <span class="fu">rnorm</span>(<span class="dv">50</span>,<span class="dv">1</span>,<span class="fl">0.225</span>)))</span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a>data_multi[<span class="dv">3</span>,] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">50</span>,<span class="dv">0</span>,<span class="fl">0.175</span>), <span class="fu">rnorm</span>(<span class="dv">50</span>,<span class="dv">1</span>,<span class="fl">0.280</span>)))</span></code></pre></div>
<p>Arguments <code>k_0</code>, <code>nu_0</code>, <code>phi_0</code>,
<code>m_0</code>, <code>par_theta_c</code>, <code>par_theta_d</code> and
<code>prior_var_gamma</code> correspond to the parameters of the prior
distributions for the multivariate likelihood.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>out <span class="ot">&lt;-</span> <span class="fu">detect_cp</span>(<span class="at">data =</span> data_multi, <span class="at">n_iterations =</span> <span class="dv">1000</span>, <span class="at">n_burnin =</span> <span class="dv">100</span>,</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>                 <span class="at">q =</span> <span class="fl">0.25</span>, <span class="at">params =</span> <span class="fu">list</span>(<span class="at">k_0 =</span> <span class="fl">0.25</span>, <span class="at">nu_0 =</span> <span class="dv">4</span>, <span class="at">phi_0 =</span> <span class="fu">diag</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">3</span>), </span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a>                      <span class="at">m_0 =</span> <span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">3</span>), <span class="at">par_theta_c =</span> <span class="dv">2</span>, <span class="at">par_theta_d =</span> <span class="fl">0.2</span>, </span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a>                      <span class="at">prior_var_gamma =</span> <span class="fl">0.1</span>), <span class="at">kernel =</span> <span class="st">&quot;ts&quot;</span>)</span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a><span class="co">#&gt; Completed:   100/1000 - in 0.016 sec</span></span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a><span class="co">#&gt; Completed:   200/1000 - in 0.032 sec</span></span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a><span class="co">#&gt; Completed:   300/1000 - in 0.046 sec</span></span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a><span class="co">#&gt; Completed:   400/1000 - in 0.063 sec</span></span>
<span id="cb8-9"><a href="#cb8-9" tabindex="-1"></a><span class="co">#&gt; Completed:   500/1000 - in 0.076 sec</span></span>
<span id="cb8-10"><a href="#cb8-10" tabindex="-1"></a><span class="co">#&gt; Completed:   600/1000 - in 0.089 sec</span></span>
<span id="cb8-11"><a href="#cb8-11" tabindex="-1"></a><span class="co">#&gt; Completed:   700/1000 - in 0.101 sec</span></span>
<span id="cb8-12"><a href="#cb8-12" tabindex="-1"></a><span class="co">#&gt; Completed:   800/1000 - in 0.113 sec</span></span>
<span id="cb8-13"><a href="#cb8-13" tabindex="-1"></a><span class="co">#&gt; Completed:   900/1000 - in 0.125 sec</span></span>
<span id="cb8-14"><a href="#cb8-14" tabindex="-1"></a><span class="co">#&gt; Completed:   1000/1000 - in 0.136 sec</span></span>
<span id="cb8-15"><a href="#cb8-15" tabindex="-1"></a></span>
<span id="cb8-16"><a href="#cb8-16" tabindex="-1"></a><span class="fu">table</span>(<span class="fu">posterior_estimate</span>(out, <span class="at">loss =</span> <span class="st">&quot;binder&quot;</span>))</span>
<span id="cb8-17"><a href="#cb8-17" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb8-18"><a href="#cb8-18" tabindex="-1"></a><span class="co">#&gt;  1  2 </span></span>
<span id="cb8-19"><a href="#cb8-19" tabindex="-1"></a><span class="co">#&gt; 50 50</span></span></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="fu">plot</span>(out, <span class="at">loss =</span> <span class="st">&quot;binder&quot;</span>, <span class="at">plot_freq =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Function <code>detect_cp</code> can also be used to detect change
points on survival functions. We define a matrix of one row and a vector
with the infection rates.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>data_mat <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="dv">100</span>, <span class="at">ncol =</span> <span class="dv">1</span>)</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>betas <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="fl">0.45</span>, <span class="dv">25</span>),<span class="fu">rep</span>(<span class="fl">0.14</span>,<span class="dv">75</span>))</span></code></pre></div>
<p>With function <code>sim_epi_data</code> we simulate a set of
infection times.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a>inf_times <span class="ot">&lt;-</span> <span class="fu">sim_epi_data</span>(<span class="dv">10000</span>, <span class="dv">10</span>, <span class="dv">100</span>, betas, <span class="dv">1</span><span class="sc">/</span><span class="dv">8</span>)</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>inf_times_vec <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">100</span>)</span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a><span class="fu">names</span>(inf_times_vec) <span class="ot">&lt;-</span> <span class="fu">as.character</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>)</span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a></span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>){</span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a> <span class="cf">if</span>(<span class="fu">as.character</span>(j) <span class="sc">%in%</span> <span class="fu">names</span>(<span class="fu">table</span>(<span class="fu">floor</span>(inf_times)))){</span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a>   inf_times_vec[j] <span class="ot">=</span> <span class="fu">table</span>(<span class="fu">floor</span>(inf_times))[<span class="fu">which</span>(<span class="fu">names</span>(<span class="fu">table</span>(<span class="fu">floor</span>(inf_times))) <span class="sc">==</span> j)]</span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a> }</span>
<span id="cb11-10"><a href="#cb11-10" tabindex="-1"></a>}</span>
<span id="cb11-11"><a href="#cb11-11" tabindex="-1"></a></span>
<span id="cb11-12"><a href="#cb11-12" tabindex="-1"></a>data_mat[,<span class="dv">1</span>] <span class="ot">&lt;-</span> inf_times_vec</span></code></pre></div>
<p>To run <code>detect_cp</code> on epidemiological data we need to set
<code>kernel = &quot;epi&quot;</code>. Moreover, besides the usual parameters, we
need to set the number of Monte Carlo replications <code>M</code> for
the approximation of the integrated likelihood and the recovery rate
<code>xi</code>. <code>a0</code> and <code>b0</code> are optional and
correspond to the parameters of the gamma distribution for the
integration of the likelihood.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a>out <span class="ot">&lt;-</span> <span class="fu">detect_cp</span>(<span class="at">data =</span> data_mat, <span class="at">n_iterations =</span> <span class="dv">200</span>, <span class="at">n_burnin =</span> <span class="dv">50</span>,</span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>                 <span class="at">params =</span> <span class="fu">list</span>(<span class="at">xi =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">8</span>, <span class="at">a0 =</span> <span class="dv">40</span>, <span class="at">b0 =</span> <span class="dv">10</span>, <span class="at">M =</span> <span class="dv">1000</span>), <span class="at">kernel =</span> <span class="st">&quot;epi&quot;</span>)</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a><span class="co">#&gt; Completed:   20/200 - in 1.257 sec</span></span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a><span class="co">#&gt; Completed:   40/200 - in 2.489 sec</span></span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a><span class="co">#&gt; Completed:   60/200 - in 3.729 sec</span></span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a><span class="co">#&gt; Completed:   80/200 - in 4.88 sec</span></span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a><span class="co">#&gt; Completed:   100/200 - in 6.057 sec</span></span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a><span class="co">#&gt; Completed:   120/200 - in 7.217 sec</span></span>
<span id="cb12-9"><a href="#cb12-9" tabindex="-1"></a><span class="co">#&gt; Completed:   140/200 - in 8.404 sec</span></span>
<span id="cb12-10"><a href="#cb12-10" tabindex="-1"></a><span class="co">#&gt; Completed:   160/200 - in 9.596 sec</span></span>
<span id="cb12-11"><a href="#cb12-11" tabindex="-1"></a><span class="co">#&gt; Completed:   180/200 - in 10.754 sec</span></span>
<span id="cb12-12"><a href="#cb12-12" tabindex="-1"></a><span class="co">#&gt; Completed:   200/200 - in 11.942 sec</span></span>
<span id="cb12-13"><a href="#cb12-13" tabindex="-1"></a></span>
<span id="cb12-14"><a href="#cb12-14" tabindex="-1"></a><span class="fu">print</span>(out)</span>
<span id="cb12-15"><a href="#cb12-15" tabindex="-1"></a><span class="co">#&gt; DetectCpObj object</span></span>
<span id="cb12-16"><a href="#cb12-16" tabindex="-1"></a><span class="co">#&gt; Type: change points detection on an epidemic diffusion</span></span>
<span id="cb12-17"><a href="#cb12-17" tabindex="-1"></a><span class="fu">table</span>(<span class="fu">posterior_estimate</span>(out, <span class="at">loss =</span> <span class="st">&quot;binder&quot;</span>))</span>
<span id="cb12-18"><a href="#cb12-18" tabindex="-1"></a><span class="co">#&gt; Warning in salso::salso(mcmc_chain, loss = &quot;binder&quot;, maxNClusters =</span></span>
<span id="cb12-19"><a href="#cb12-19" tabindex="-1"></a><span class="co">#&gt; maxNClusters, : The number of clusters equals the default maximum possible</span></span>
<span id="cb12-20"><a href="#cb12-20" tabindex="-1"></a><span class="co">#&gt; number of clusters.</span></span>
<span id="cb12-21"><a href="#cb12-21" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb12-22"><a href="#cb12-22" tabindex="-1"></a><span class="co">#&gt;  1  2 </span></span>
<span id="cb12-23"><a href="#cb12-23" tabindex="-1"></a><span class="co">#&gt; 29 71</span></span></code></pre></div>
<p>Also here, with function <code>plot</code> we can plot the survival
function and the position of the change points.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="fu">plot</span>(out)</span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a><span class="co">#&gt; Warning in salso::salso(mcmc_chain, loss = &quot;VI&quot;, maxNClusters = maxNClusters, :</span></span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a><span class="co">#&gt; The number of clusters equals the default maximum possible number of clusters.</span></span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAn1BMVEUAAAAAADoAAGYAOpAAZrY6AAA6ADo6kNtNTU1NTW5NTY5NbqtNjshmAABmADpmtv9uTU1uTW5uTY5ubqtuq+SOTU2OTW6OTY6OyP+QOgCQtpCQ2/+rbk2rbm6rbo6ryKur5P+2ZgC2///Ijk3I///bkDrb/7bb///kGhzkq27k///r6+v/tmb/yI7/25D/5Kv//7b//8j//9v//+T////jX2LYAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAKNUlEQVR4nO2di5bTNhCGAywsl9LQNrTZQktDSCtgl735/Z+tlq3Eli17pNElHmn+c0qynUTj80UayZJHWlWsWa3OfQFLFwMCxIAAMSBADAgQAwLkDei7l2U1ZQjrxuMrDAiwMCDAwoAAy5kBxSyMASVxw4AAyyyg21+/NK/371+++XZ68b6+bADdvHzdAHr8uK2+/nR88b++XIL0/tWntgbd//FFVib14n99uQA6NbHb375V97//o16ORQXRKkwxEeQC6OZNQ0a9jJiLVha/xtiScQ0aFTmilGGQvnu7vnu7evr5+PetcwzqI8oQ0O6iOjz9fLg4/q1wPH7ctL3YxqIX6xDlB6iuQA9XF9X1qQpJQPI/t3GQmLSAF7h8QHdvL3uAbGRwJuwvg1aQfri6vH7yQTY0B5mctc0sP0DVj+eri2r37L/J71s7E5aXQQwQRhPOBAOad2YJyNawAED1AOgo3yDdSOQGCCsGBGjSmcgQUN2LBWtidoBoBel6HPRwVY8V15Pfd3I2vr8ff4cWIIlmV4+knQZCpQE6XPjfahwtk4SoApI3GTWdQ6AaZAPIvrCQFjSgOghVu1V9O+agogBhNOdsihADUpbcAB3vNkIFaQtAxIJ0o7ufQ8WgyZ6eNqBg46B8AQVrYpkCcptS9APkUlg4i2eQthsH2S3girjrwxFlAoTS/K9hrkJUaxBKxQAKPeVqB4hYkD5INMHmgxqLkRBVQApNwG6eAZUF6NjELie/7+4MAORWWCgLvhe7ljHaKQQVBgghyJmJEAPqWbIB1D5+F3ocBAEiFqQxYkCASgLk2MFbOjMQogqoOjh38r6AXAsLY/FpYjvb+SBrZ5kBqrUL2ovlBmjn2MuXBci5fVk5m0tzoRWkHWeCbJ3lAwilYgDFutXIBhBWfoCcCwtiCQTolNzz9aXUtnl97Z6zmgmg0aqGnuQs8zH3W5yzESGSgKS0VQ0twVCmYj7+NUzHtHSWDSB90l5LUZVVqW5ysqEdi7LXzPozraxnHVA/ybl5vf3FVIv8ahCxXkxb1ejXoJtTKuYoDhUFSFvV6Meg/eb4icIB9dVLcm4blqxGj39jtqYYEqIapAdqx0FN1nPb0upx0KtRR1YUoKDZPhkCkknzzioJUKTpjjlAtIL0wxUDGv0f7QrdHnyxd5YLoEjzQdWIEFVAKPkBwhTmb2FAAd0wIMAS+TFgpRwAYcVBGhADAsSAANk5ExMWBqQ0BQhVmLeFAQV0k6abzwGQVIRsH6U8AMVIZlHKI0gzIMsmFjLbRykTQC7ZPo4ruRPLz7SWnlGy/DXsdppefA1CqCxAh7qBuW1AVRag3bN/2y2lHVQSoOY5znWUbn4KEK1ejAGB4yDZxKKMgzIB1I6D3JLGbJ0Jo4UaIIT8ACEL87Qs8F6MAYEW+oAOpwmzGOOgDABFfD5IioM0YMkCkNzs1vU5vKIANWeyxLkXywIQ92LnBNQnRBVQxDnpKg9AMe/F8gCEkB8gWkEapbIAxZuTzgOQPifdHWmo0p39znrOAJA+5drLem6z6DzPes4gSOuAuoxDlajqedZzBoD0OekuZ1WlO/ue9Uxr820jIG0c1GU9q3TnqbOebX8NMWlBFOZlCdPND4523m+Bs55BZyZAhIK0CkCdBiFnv/U9bz43QF3Ws0p3tjvredpCHFBvTlrdzXdZzyrd2W8cRB5Q5Dnp/IK0pYoCFCtvvhV9QNHy5pXEpAVRmI9loTHIBIhWkI6WN69EHlC0vHkl8oDi5c23Ig8IpZKCNEoMCFAxgOIm1DWiDQgrF2diZOEgrYkBARYGBFgYEGAZA/IozMOC7MXWsW9WGRBkIQ1oPCdtp3IAxZ8PKitIo9ZzR6vP1LKeDxEfwZMSQwuxGhT1IU4p4oDiPgYsNQLkUxjewoACujlzE/MpDG/B92LJg7RPYXjLYu/FjoSoBmmUGBAgBgSIAQHyA+RVGNrCgAALGlDc54MaidnvLBxQ7OeDpEgDij4fVI0A0QrSsZ8PkiINKPbzQVKkAcV+PkiKNCCUXK9PzH2HAVEHFHu6oyIOKPqEWUUbUPwp12oIiFaQHgDqkntu3zUn0CLPetZFGZDexLokZ5lmKNMysWc96xKEAWlBukswvJGY9lv0Wc+6SAPqS09Rrd+hz3rWRST5GQakJTnLdEz0Wc+6RKCf1sOCqkHN80H9W41+Dbp/v1EfwxxlrIsqoJF6Sc63705Yigakd/NdkrPigz/rWRPhIG0cB9WVSI5/ZHhGn/WsiSygyFuVdhJEAaWZcq0oA0ox5VrpgLwLy70GeReW+F7MbfsyZ2et6AJKMSddUQaEEuL6BNUgjVJZgBLMSVeUAaWYk64IA0oyJy0lpgwMqBVVQKmaGF1AiYI0YUAIoa78RIhWkEapLEAH+2NEMc46y5EQMUCpgjRVQMm6+e9TcZoBnSwkAVXXTz5YNzHflculL7CaAKG2EEL/tKY6tPQahJEfIFpBGiX8lYux+8UDSnSroSyCHKB046BWghiglN18q2GgZkADCzFAyZvYiNDSASUO0lJiyhDWDf4rZ+zmW/cTx4iHdePxlTM8vKADsjsdchmAEj28MABkdSrSMgAlenhhCMjmNIBlAEr08MLYAu+CuwxAKAW5cgFtC1M6IHDHgUUA2jk2Lndnc5b5hPolANrVEfrgTihAkG4l5p4wXwCgZhCEGAkFAyQRLRlQMwiSB847KiAgiUiIBNP5dAE1BiOkUgFNGUaIGNDQMKhHSwBkPsKv987zCD8Ly8Aguph0fkAjdUm96p3nUcY2FqNBnBTVzYTFJqFOvfM9RtRkcZu0F7rQFxAGUJeSqd75HmVsktd+0iK8usJhQF1Sr3rne5SxyUJr2UcXUIM8ri8TQEliUMzC4vdim1Mvtml7Mb+jjC0spAD1jjI+1zhoCW6WMmEWobAsAFEO0pZiQIAYECAGVLgYECAGBIgBAWJAgBgQIAYEiAEBYkCA/AAZJ0DmNLcr7ITUZ11c9TZds3TTTAQaZ3W8AJkXgmY0uyvshNrPOruSM+jWbm4kR/Pqlhcg8yTs3IXM7Qprlvqsqyv5U1i72b/6JKcFjTPLXoDM0/iARrvCAh9vP+vqStYBBzeSiHltwguQeSFoXtO7wpqlPuvoqvmogxsJyLy6lboGzewKO6P91tHVzSnM2rmJVIOcY9DsrrAz2m8dXe03bm5u48Qg80LQ3HXM7Qprlvqsm6u2YTm4kUTMq1tpx0Gzu8JOf0d+1smVaiL2biKNg0oQAwLEgAAxIEAMCBADArRQQA9Xx93Rf7z4cNYrWSggqXOjacWAAC0eUP3vjxd/Pl+tLuUxueu29SHy2rAiAei5TGVbtflszWm5mOxjpGgAWstjltfNH9ft9hmIBHacSACSb47/qOM/nJNusKIHKF3rakQOULNTX0KRA/RwVVehhJTIAWq6+YS1aMGAliEGBIgBAWJAgBgQIAYEiAEBYkCAGBAgBgTof0V3LuOvvXpXAAAAAElFTkSuQmCC" /><!-- --></p>
</div>
<div id="clustering-time-dependent-data-with-common-change-points" class="section level2">
<h2>Clustering time dependent data with common change points</h2>
<p><code>BayesChange</code> contains another function,
<code>clust_cp</code>, that cluster respectively univariate and
multivariate time series and survival functions with common change
points. Details about this methods can be found in <span class="citation">Corradin et al. (2024)</span>.</p>
<p>In <code>clust_cp</code> the argument <code>kernel</code> must be
specified, if data are time series then <code>kernel = &quot;ts&quot;</code> must
be set. Then the algorithm automatically detects if data are univariate
or multivariate.</p>
<p>If time series are univariate we need to set a matrix where each row
is a time series.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a>data_mat <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="dv">5</span>, <span class="at">ncol =</span> <span class="dv">100</span>)</span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a>data_mat[<span class="dv">1</span>,] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">50</span>,<span class="dv">0</span>,<span class="fl">0.100</span>), <span class="fu">rnorm</span>(<span class="dv">50</span>,<span class="dv">1</span>,<span class="fl">0.250</span>)))</span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a>data_mat[<span class="dv">2</span>,] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">50</span>,<span class="dv">0</span>,<span class="fl">0.125</span>), <span class="fu">rnorm</span>(<span class="dv">50</span>,<span class="dv">1</span>,<span class="fl">0.225</span>)))</span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a>data_mat[<span class="dv">3</span>,] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">50</span>,<span class="dv">0</span>,<span class="fl">0.175</span>), <span class="fu">rnorm</span>(<span class="dv">50</span>,<span class="dv">1</span>,<span class="fl">0.280</span>)))</span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a>data_mat[<span class="dv">4</span>,] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">25</span>,<span class="dv">0</span>,<span class="fl">0.135</span>), <span class="fu">rnorm</span>(<span class="dv">75</span>,<span class="dv">1</span>,<span class="fl">0.225</span>)))</span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a>data_mat[<span class="dv">5</span>,] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">25</span>,<span class="dv">0</span>,<span class="fl">0.155</span>), <span class="fu">rnorm</span>(<span class="dv">75</span>,<span class="dv">1</span>,<span class="fl">0.280</span>)))</span></code></pre></div>
<p>Arguments that need to be specified in <code>clust_cp</code> are the
number of iterations <code>n_iterations</code>, the number of elements
in the normalisation constant <code>B</code>, the split-and-merge step
<code>L</code> performed when a new partition is proposed and a list
with the parameters of the algorithm, the likelihood and the
priors..</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a>out <span class="ot">&lt;-</span> <span class="fu">clust_cp</span>(<span class="at">data =</span> data_mat, <span class="at">n_iterations =</span> <span class="dv">1000</span>, <span class="at">n_burnin =</span> <span class="dv">100</span>, </span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a>                <span class="at">kernel =</span> <span class="st">&quot;ts&quot;</span>,</span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a>                <span class="at">params =</span> <span class="fu">list</span>(<span class="at">B =</span> <span class="dv">1000</span>, <span class="at">L =</span> <span class="dv">1</span>, <span class="at">gamma =</span> <span class="fl">0.5</span>))</span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a><span class="co">#&gt; Normalization constant - completed:  100/1000 - in 0.004 sec</span></span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a><span class="co">#&gt; Normalization constant - completed:  200/1000 - in 0.008 sec</span></span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a><span class="co">#&gt; Normalization constant - completed:  300/1000 - in 0.012 sec</span></span>
<span id="cb15-7"><a href="#cb15-7" tabindex="-1"></a><span class="co">#&gt; Normalization constant - completed:  400/1000 - in 0.016 sec</span></span>
<span id="cb15-8"><a href="#cb15-8" tabindex="-1"></a><span class="co">#&gt; Normalization constant - completed:  500/1000 - in 0.02 sec</span></span>
<span id="cb15-9"><a href="#cb15-9" tabindex="-1"></a><span class="co">#&gt; Normalization constant - completed:  600/1000 - in 0.024 sec</span></span>
<span id="cb15-10"><a href="#cb15-10" tabindex="-1"></a><span class="co">#&gt; Normalization constant - completed:  700/1000 - in 0.028 sec</span></span>
<span id="cb15-11"><a href="#cb15-11" tabindex="-1"></a><span class="co">#&gt; Normalization constant - completed:  800/1000 - in 0.032 sec</span></span>
<span id="cb15-12"><a href="#cb15-12" tabindex="-1"></a><span class="co">#&gt; Normalization constant - completed:  900/1000 - in 0.036 sec</span></span>
<span id="cb15-13"><a href="#cb15-13" tabindex="-1"></a><span class="co">#&gt; Normalization constant - completed:  1000/1000 - in 0.039 sec</span></span>
<span id="cb15-14"><a href="#cb15-14" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb15-15"><a href="#cb15-15" tabindex="-1"></a><span class="co">#&gt; ------ MAIN LOOP ------</span></span>
<span id="cb15-16"><a href="#cb15-16" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb15-17"><a href="#cb15-17" tabindex="-1"></a><span class="co">#&gt; Completed:   100/1000 - in 0.053 sec</span></span>
<span id="cb15-18"><a href="#cb15-18" tabindex="-1"></a><span class="co">#&gt; Completed:   200/1000 - in 0.108 sec</span></span>
<span id="cb15-19"><a href="#cb15-19" tabindex="-1"></a><span class="co">#&gt; Completed:   300/1000 - in 0.159 sec</span></span>
<span id="cb15-20"><a href="#cb15-20" tabindex="-1"></a><span class="co">#&gt; Completed:   400/1000 - in 0.212 sec</span></span>
<span id="cb15-21"><a href="#cb15-21" tabindex="-1"></a><span class="co">#&gt; Completed:   500/1000 - in 0.263 sec</span></span>
<span id="cb15-22"><a href="#cb15-22" tabindex="-1"></a><span class="co">#&gt; Completed:   600/1000 - in 0.311 sec</span></span>
<span id="cb15-23"><a href="#cb15-23" tabindex="-1"></a><span class="co">#&gt; Completed:   700/1000 - in 0.366 sec</span></span>
<span id="cb15-24"><a href="#cb15-24" tabindex="-1"></a><span class="co">#&gt; Completed:   800/1000 - in 0.415 sec</span></span>
<span id="cb15-25"><a href="#cb15-25" tabindex="-1"></a><span class="co">#&gt; Completed:   900/1000 - in 0.467 sec</span></span>
<span id="cb15-26"><a href="#cb15-26" tabindex="-1"></a><span class="co">#&gt; Completed:   1000/1000 - in 0.517 sec</span></span>
<span id="cb15-27"><a href="#cb15-27" tabindex="-1"></a></span>
<span id="cb15-28"><a href="#cb15-28" tabindex="-1"></a><span class="fu">posterior_estimate</span>(out, <span class="at">loss =</span> <span class="st">&quot;binder&quot;</span>)</span>
<span id="cb15-29"><a href="#cb15-29" tabindex="-1"></a><span class="co">#&gt; [1] 1 2 3 4 4</span></span></code></pre></div>
<p>Method <code>plot</code> for clustering univariate time series
represents the data colored according to the assigned cluster.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="fu">plot</span>(out, <span class="at">loss =</span> <span class="st">&quot;binder&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>If time series are multivariate, data must be an array, where each
element is a multivariate time series represented by a matrix. Each row
of the matrix is a component of the time series.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a>data_array <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="at">data =</span> <span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">100</span>,<span class="dv">5</span>))</span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a>data_array[<span class="dv">1</span>,,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">50</span>,<span class="dv">0</span>,<span class="fl">0.100</span>), <span class="fu">rnorm</span>(<span class="dv">50</span>,<span class="dv">1</span>,<span class="fl">0.250</span>)))</span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a>data_array[<span class="dv">2</span>,,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">50</span>,<span class="dv">0</span>,<span class="fl">0.100</span>), <span class="fu">rnorm</span>(<span class="dv">50</span>,<span class="dv">1</span>,<span class="fl">0.250</span>)))</span>
<span id="cb17-5"><a href="#cb17-5" tabindex="-1"></a>data_array[<span class="dv">3</span>,,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">50</span>,<span class="dv">0</span>,<span class="fl">0.100</span>), <span class="fu">rnorm</span>(<span class="dv">50</span>,<span class="dv">1</span>,<span class="fl">0.250</span>)))</span>
<span id="cb17-6"><a href="#cb17-6" tabindex="-1"></a></span>
<span id="cb17-7"><a href="#cb17-7" tabindex="-1"></a>data_array[<span class="dv">1</span>,,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">50</span>,<span class="dv">0</span>,<span class="fl">0.100</span>), <span class="fu">rnorm</span>(<span class="dv">50</span>,<span class="dv">1</span>,<span class="fl">0.250</span>)))</span>
<span id="cb17-8"><a href="#cb17-8" tabindex="-1"></a>data_array[<span class="dv">2</span>,,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">50</span>,<span class="dv">0</span>,<span class="fl">0.100</span>), <span class="fu">rnorm</span>(<span class="dv">50</span>,<span class="dv">1</span>,<span class="fl">0.250</span>)))</span>
<span id="cb17-9"><a href="#cb17-9" tabindex="-1"></a>data_array[<span class="dv">3</span>,,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">50</span>,<span class="dv">0</span>,<span class="fl">0.100</span>), <span class="fu">rnorm</span>(<span class="dv">50</span>,<span class="dv">1</span>,<span class="fl">0.250</span>)))</span>
<span id="cb17-10"><a href="#cb17-10" tabindex="-1"></a></span>
<span id="cb17-11"><a href="#cb17-11" tabindex="-1"></a>data_array[<span class="dv">1</span>,,<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">50</span>,<span class="dv">0</span>,<span class="fl">0.175</span>), <span class="fu">rnorm</span>(<span class="dv">50</span>,<span class="dv">1</span>,<span class="fl">0.280</span>)))</span>
<span id="cb17-12"><a href="#cb17-12" tabindex="-1"></a>data_array[<span class="dv">2</span>,,<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">50</span>,<span class="dv">0</span>,<span class="fl">0.175</span>), <span class="fu">rnorm</span>(<span class="dv">50</span>,<span class="dv">1</span>,<span class="fl">0.280</span>)))</span>
<span id="cb17-13"><a href="#cb17-13" tabindex="-1"></a>data_array[<span class="dv">3</span>,,<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">50</span>,<span class="dv">0</span>,<span class="fl">0.175</span>), <span class="fu">rnorm</span>(<span class="dv">50</span>,<span class="dv">1</span>,<span class="fl">0.280</span>)))</span>
<span id="cb17-14"><a href="#cb17-14" tabindex="-1"></a></span>
<span id="cb17-15"><a href="#cb17-15" tabindex="-1"></a>data_array[<span class="dv">1</span>,,<span class="dv">4</span>] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">25</span>,<span class="dv">0</span>,<span class="fl">0.135</span>), <span class="fu">rnorm</span>(<span class="dv">75</span>,<span class="dv">1</span>,<span class="fl">0.225</span>)))</span>
<span id="cb17-16"><a href="#cb17-16" tabindex="-1"></a>data_array[<span class="dv">2</span>,,<span class="dv">4</span>] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">25</span>,<span class="dv">0</span>,<span class="fl">0.135</span>), <span class="fu">rnorm</span>(<span class="dv">75</span>,<span class="dv">1</span>,<span class="fl">0.225</span>)))</span>
<span id="cb17-17"><a href="#cb17-17" tabindex="-1"></a>data_array[<span class="dv">3</span>,,<span class="dv">4</span>] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">25</span>,<span class="dv">0</span>,<span class="fl">0.135</span>), <span class="fu">rnorm</span>(<span class="dv">75</span>,<span class="dv">1</span>,<span class="fl">0.225</span>)))</span>
<span id="cb17-18"><a href="#cb17-18" tabindex="-1"></a></span>
<span id="cb17-19"><a href="#cb17-19" tabindex="-1"></a>data_array[<span class="dv">1</span>,,<span class="dv">5</span>] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">25</span>,<span class="dv">0</span>,<span class="fl">0.155</span>), <span class="fu">rnorm</span>(<span class="dv">75</span>,<span class="dv">1</span>,<span class="fl">0.280</span>)))</span>
<span id="cb17-20"><a href="#cb17-20" tabindex="-1"></a>data_array[<span class="dv">2</span>,,<span class="dv">5</span>] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">25</span>,<span class="dv">0</span>,<span class="fl">0.155</span>), <span class="fu">rnorm</span>(<span class="dv">75</span>,<span class="dv">1</span>,<span class="fl">0.280</span>)))</span>
<span id="cb17-21"><a href="#cb17-21" tabindex="-1"></a>data_array[<span class="dv">3</span>,,<span class="dv">5</span>] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">25</span>,<span class="dv">0</span>,<span class="fl">0.155</span>), <span class="fu">rnorm</span>(<span class="dv">75</span>,<span class="dv">1</span>,<span class="fl">0.280</span>)))</span></code></pre></div>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a>out <span class="ot">&lt;-</span> <span class="fu">clust_cp</span>(<span class="at">data =</span> data_array, <span class="at">n_iterations =</span> <span class="dv">1000</span>, <span class="at">n_burnin =</span> <span class="dv">100</span>, </span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a>                <span class="at">kernel =</span> <span class="st">&quot;ts&quot;</span>, <span class="at">params =</span> <span class="fu">list</span>(<span class="at">gamma =</span> <span class="fl">0.1</span>, <span class="at">k_0 =</span> <span class="fl">0.25</span>, <span class="at">nu_0 =</span> <span class="dv">5</span>,  <span class="at">phi_0 =</span> <span class="fu">diag</span>(<span class="fl">0.1</span>,<span class="dv">3</span>,<span class="dv">3</span>), <span class="at">m_0 =</span> <span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">3</span>)))</span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a><span class="co">#&gt; Normalization constant - completed:  100/1000 - in 0.007 sec</span></span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a><span class="co">#&gt; Normalization constant - completed:  200/1000 - in 0.015 sec</span></span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a><span class="co">#&gt; Normalization constant - completed:  300/1000 - in 0.022 sec</span></span>
<span id="cb18-6"><a href="#cb18-6" tabindex="-1"></a><span class="co">#&gt; Normalization constant - completed:  400/1000 - in 0.029 sec</span></span>
<span id="cb18-7"><a href="#cb18-7" tabindex="-1"></a><span class="co">#&gt; Normalization constant - completed:  500/1000 - in 0.037 sec</span></span>
<span id="cb18-8"><a href="#cb18-8" tabindex="-1"></a><span class="co">#&gt; Normalization constant - completed:  600/1000 - in 0.044 sec</span></span>
<span id="cb18-9"><a href="#cb18-9" tabindex="-1"></a><span class="co">#&gt; Normalization constant - completed:  700/1000 - in 0.052 sec</span></span>
<span id="cb18-10"><a href="#cb18-10" tabindex="-1"></a><span class="co">#&gt; Normalization constant - completed:  800/1000 - in 0.059 sec</span></span>
<span id="cb18-11"><a href="#cb18-11" tabindex="-1"></a><span class="co">#&gt; Normalization constant - completed:  900/1000 - in 0.066 sec</span></span>
<span id="cb18-12"><a href="#cb18-12" tabindex="-1"></a><span class="co">#&gt; Normalization constant - completed:  1000/1000 - in 0.074 sec</span></span>
<span id="cb18-13"><a href="#cb18-13" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb18-14"><a href="#cb18-14" tabindex="-1"></a><span class="co">#&gt; ------ MAIN LOOP ------</span></span>
<span id="cb18-15"><a href="#cb18-15" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb18-16"><a href="#cb18-16" tabindex="-1"></a><span class="co">#&gt; Completed:   100/1000 - in 0.07 sec</span></span>
<span id="cb18-17"><a href="#cb18-17" tabindex="-1"></a><span class="co">#&gt; Completed:   200/1000 - in 0.142 sec</span></span>
<span id="cb18-18"><a href="#cb18-18" tabindex="-1"></a><span class="co">#&gt; Completed:   300/1000 - in 0.213 sec</span></span>
<span id="cb18-19"><a href="#cb18-19" tabindex="-1"></a><span class="co">#&gt; Completed:   400/1000 - in 0.293 sec</span></span>
<span id="cb18-20"><a href="#cb18-20" tabindex="-1"></a><span class="co">#&gt; Completed:   500/1000 - in 0.366 sec</span></span>
<span id="cb18-21"><a href="#cb18-21" tabindex="-1"></a><span class="co">#&gt; Completed:   600/1000 - in 0.44 sec</span></span>
<span id="cb18-22"><a href="#cb18-22" tabindex="-1"></a><span class="co">#&gt; Completed:   700/1000 - in 0.517 sec</span></span>
<span id="cb18-23"><a href="#cb18-23" tabindex="-1"></a><span class="co">#&gt; Completed:   800/1000 - in 0.592 sec</span></span>
<span id="cb18-24"><a href="#cb18-24" tabindex="-1"></a><span class="co">#&gt; Completed:   900/1000 - in 0.667 sec</span></span>
<span id="cb18-25"><a href="#cb18-25" tabindex="-1"></a><span class="co">#&gt; Completed:   1000/1000 - in 0.741 sec</span></span>
<span id="cb18-26"><a href="#cb18-26" tabindex="-1"></a></span>
<span id="cb18-27"><a href="#cb18-27" tabindex="-1"></a><span class="fu">posterior_estimate</span>(out, <span class="at">loss =</span> <span class="st">&quot;binder&quot;</span>)</span>
<span id="cb18-28"><a href="#cb18-28" tabindex="-1"></a><span class="co">#&gt; [1] 1 2 2 3 3</span></span></code></pre></div>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a><span class="fu">plot</span>(out, <span class="at">loss =</span> <span class="st">&quot;binder&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Finally, if we set <code>kernel = &quot;epi&quot;</code>, <code>clust_cp</code>
cluster survival functions with common change points. Also here details
can be found in <span class="citation">Corradin et al.
(2024)</span>.</p>
<p>Data are a matrix where each row is the number of infected at each
time. Inside this package is included the function
<code>sim_epi_data</code> that simulates infection times.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a>data_mat <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="dv">5</span>, <span class="at">ncol =</span> <span class="dv">50</span>)</span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" tabindex="-1"></a>betas <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="fl">0.45</span>, <span class="dv">25</span>),<span class="fu">rep</span>(<span class="fl">0.14</span>,<span class="dv">25</span>)),</span>
<span id="cb20-4"><a href="#cb20-4" tabindex="-1"></a>               <span class="fu">c</span>(<span class="fu">rep</span>(<span class="fl">0.55</span>, <span class="dv">25</span>),<span class="fu">rep</span>(<span class="fl">0.11</span>,<span class="dv">25</span>)),</span>
<span id="cb20-5"><a href="#cb20-5" tabindex="-1"></a>               <span class="fu">c</span>(<span class="fu">rep</span>(<span class="fl">0.50</span>, <span class="dv">25</span>),<span class="fu">rep</span>(<span class="fl">0.12</span>,<span class="dv">25</span>)),</span>
<span id="cb20-6"><a href="#cb20-6" tabindex="-1"></a>               <span class="fu">c</span>(<span class="fu">rep</span>(<span class="fl">0.52</span>, <span class="dv">10</span>),<span class="fu">rep</span>(<span class="fl">0.15</span>,<span class="dv">40</span>)),</span>
<span id="cb20-7"><a href="#cb20-7" tabindex="-1"></a>               <span class="fu">c</span>(<span class="fu">rep</span>(<span class="fl">0.53</span>, <span class="dv">10</span>),<span class="fu">rep</span>(<span class="fl">0.13</span>,<span class="dv">40</span>)))</span>
<span id="cb20-8"><a href="#cb20-8" tabindex="-1"></a></span>
<span id="cb20-9"><a href="#cb20-9" tabindex="-1"></a>  inf_times <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb20-10"><a href="#cb20-10" tabindex="-1"></a></span>
<span id="cb20-11"><a href="#cb20-11" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>){</span>
<span id="cb20-12"><a href="#cb20-12" tabindex="-1"></a></span>
<span id="cb20-13"><a href="#cb20-13" tabindex="-1"></a>    inf_times[[i]] <span class="ot">&lt;-</span> <span class="fu">sim_epi_data</span>(<span class="at">S0 =</span> <span class="dv">10000</span>, <span class="at">I0 =</span> <span class="dv">10</span>, <span class="at">max_time =</span> <span class="dv">50</span>, <span class="at">beta_vec =</span> betas[[i]], <span class="at">xi_0 =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">8</span>)</span>
<span id="cb20-14"><a href="#cb20-14" tabindex="-1"></a></span>
<span id="cb20-15"><a href="#cb20-15" tabindex="-1"></a>    vec <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">50</span>)</span>
<span id="cb20-16"><a href="#cb20-16" tabindex="-1"></a>    <span class="fu">names</span>(vec) <span class="ot">&lt;-</span> <span class="fu">as.character</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">50</span>)</span>
<span id="cb20-17"><a href="#cb20-17" tabindex="-1"></a></span>
<span id="cb20-18"><a href="#cb20-18" tabindex="-1"></a>    <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">50</span>){</span>
<span id="cb20-19"><a href="#cb20-19" tabindex="-1"></a>      <span class="cf">if</span>(<span class="fu">as.character</span>(j) <span class="sc">%in%</span> <span class="fu">names</span>(<span class="fu">table</span>(<span class="fu">floor</span>(inf_times[[i]])))){</span>
<span id="cb20-20"><a href="#cb20-20" tabindex="-1"></a>      vec[j] <span class="ot">=</span> <span class="fu">table</span>(<span class="fu">floor</span>(inf_times[[i]]))[<span class="fu">which</span>(<span class="fu">names</span>(<span class="fu">table</span>(<span class="fu">floor</span>(inf_times[[i]]))) <span class="sc">==</span> j)]</span>
<span id="cb20-21"><a href="#cb20-21" tabindex="-1"></a>      }</span>
<span id="cb20-22"><a href="#cb20-22" tabindex="-1"></a>    }</span>
<span id="cb20-23"><a href="#cb20-23" tabindex="-1"></a>    data_mat[i,] <span class="ot">&lt;-</span> vec</span>
<span id="cb20-24"><a href="#cb20-24" tabindex="-1"></a>  }</span></code></pre></div>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a>out <span class="ot">&lt;-</span> <span class="fu">clust_cp</span>(<span class="at">data =</span> data_mat, <span class="at">n_iterations =</span> <span class="dv">100</span>, <span class="at">n_burnin =</span> <span class="dv">10</span>, </span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a>                <span class="at">kernel =</span> <span class="st">&quot;epi&quot;</span>, </span>
<span id="cb21-3"><a href="#cb21-3" tabindex="-1"></a>                <span class="fu">list</span>(<span class="at">M =</span> <span class="dv">100</span>, <span class="at">B =</span> <span class="dv">1000</span>, <span class="at">L =</span> <span class="dv">1</span>, <span class="at">q =</span> <span class="fl">0.1</span>, <span class="at">gamma =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">8</span>))</span>
<span id="cb21-4"><a href="#cb21-4" tabindex="-1"></a><span class="co">#&gt; Normalization constant - completed:  100/1000 - in 0.516 sec</span></span>
<span id="cb21-5"><a href="#cb21-5" tabindex="-1"></a><span class="co">#&gt; Normalization constant - completed:  200/1000 - in 1.035 sec</span></span>
<span id="cb21-6"><a href="#cb21-6" tabindex="-1"></a><span class="co">#&gt; Normalization constant - completed:  300/1000 - in 1.554 sec</span></span>
<span id="cb21-7"><a href="#cb21-7" tabindex="-1"></a><span class="co">#&gt; Normalization constant - completed:  400/1000 - in 2.071 sec</span></span>
<span id="cb21-8"><a href="#cb21-8" tabindex="-1"></a><span class="co">#&gt; Normalization constant - completed:  500/1000 - in 2.597 sec</span></span>
<span id="cb21-9"><a href="#cb21-9" tabindex="-1"></a><span class="co">#&gt; Normalization constant - completed:  600/1000 - in 3.134 sec</span></span>
<span id="cb21-10"><a href="#cb21-10" tabindex="-1"></a><span class="co">#&gt; Normalization constant - completed:  700/1000 - in 3.659 sec</span></span>
<span id="cb21-11"><a href="#cb21-11" tabindex="-1"></a><span class="co">#&gt; Normalization constant - completed:  800/1000 - in 4.188 sec</span></span>
<span id="cb21-12"><a href="#cb21-12" tabindex="-1"></a><span class="co">#&gt; Normalization constant - completed:  900/1000 - in 4.726 sec</span></span>
<span id="cb21-13"><a href="#cb21-13" tabindex="-1"></a><span class="co">#&gt; Normalization constant - completed:  1000/1000 - in 5.258 sec</span></span>
<span id="cb21-14"><a href="#cb21-14" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb21-15"><a href="#cb21-15" tabindex="-1"></a><span class="co">#&gt; ------ MAIN LOOP ------</span></span>
<span id="cb21-16"><a href="#cb21-16" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb21-17"><a href="#cb21-17" tabindex="-1"></a><span class="co">#&gt; Completed:   10/100 - in 0.519 sec</span></span>
<span id="cb21-18"><a href="#cb21-18" tabindex="-1"></a><span class="co">#&gt; Completed:   20/100 - in 1.095 sec</span></span>
<span id="cb21-19"><a href="#cb21-19" tabindex="-1"></a><span class="co">#&gt; Completed:   30/100 - in 1.666 sec</span></span>
<span id="cb21-20"><a href="#cb21-20" tabindex="-1"></a><span class="co">#&gt; Completed:   40/100 - in 2.267 sec</span></span>
<span id="cb21-21"><a href="#cb21-21" tabindex="-1"></a><span class="co">#&gt; Completed:   50/100 - in 2.866 sec</span></span>
<span id="cb21-22"><a href="#cb21-22" tabindex="-1"></a><span class="co">#&gt; Completed:   60/100 - in 3.499 sec</span></span>
<span id="cb21-23"><a href="#cb21-23" tabindex="-1"></a><span class="co">#&gt; Completed:   70/100 - in 4.134 sec</span></span>
<span id="cb21-24"><a href="#cb21-24" tabindex="-1"></a><span class="co">#&gt; Completed:   80/100 - in 4.883 sec</span></span>
<span id="cb21-25"><a href="#cb21-25" tabindex="-1"></a><span class="co">#&gt; Completed:   90/100 - in 5.639 sec</span></span>
<span id="cb21-26"><a href="#cb21-26" tabindex="-1"></a><span class="co">#&gt; Completed:   100/100 - in 6.5 sec</span></span>
<span id="cb21-27"><a href="#cb21-27" tabindex="-1"></a></span>
<span id="cb21-28"><a href="#cb21-28" tabindex="-1"></a><span class="fu">posterior_estimate</span>(out, <span class="at">loss =</span> <span class="st">&quot;binder&quot;</span>)</span>
<span id="cb21-29"><a href="#cb21-29" tabindex="-1"></a><span class="co">#&gt; Warning in salso::salso(mcmc_chain, loss = &quot;binder&quot;, maxNClusters =</span></span>
<span id="cb21-30"><a href="#cb21-30" tabindex="-1"></a><span class="co">#&gt; maxNClusters, : The number of clusters equals the default maximum possible</span></span>
<span id="cb21-31"><a href="#cb21-31" tabindex="-1"></a><span class="co">#&gt; number of clusters.</span></span>
<span id="cb21-32"><a href="#cb21-32" tabindex="-1"></a><span class="co">#&gt; [1] 1 2 3 1 4</span></span></code></pre></div>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a><span class="fu">plot</span>(out, <span class="at">loss =</span> <span class="st">&quot;binder&quot;</span>)</span>
<span id="cb22-2"><a href="#cb22-2" tabindex="-1"></a><span class="co">#&gt; Warning in salso::salso(mcmc_chain, loss = &quot;binder&quot;, maxNClusters =</span></span>
<span id="cb22-3"><a href="#cb22-3" tabindex="-1"></a><span class="co">#&gt; maxNClusters, : The number of clusters equals the default maximum possible</span></span>
<span id="cb22-4"><a href="#cb22-4" tabindex="-1"></a><span class="co">#&gt; number of clusters.</span></span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAz1BMVEUAAAAAADoAAGYAOpAAZrY3frg6AAA6ADo6AGY6OmY6OpA6kNtNTU1NTW5NTY5NbqtNjshNr0pmAABmADpmOgBmtrZmtv9uTU1uTW5uTY5ubo5ubqtuq+SOTU2OTW6OTY6Obk2OyP+QOgCQOjqQkDqQtpCQ29uQ2/+YTqOrbk2rbm6rbo6ryKur5OSr5P+2ZgC22/+2///Ijk3I///bkDrb/7bb///kGhzkq27k///r6+v/tmb/yI7/25D/27b/5Kv//7b//8j//9v//+T///8vCdCPAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAPbklEQVR4nO2dCXvUuBnHA8yEbQO7HWhDj2zbpN1Ge5QpYYpZJ2kg0ff/TNVlHbZO25I1sv7PAzNaWUT57avDr/RKJ7DKqpOlK5C7KiCHKiCHKiCHKiCHKiCHJgFqzSlLVvRis6oCcqgCcqgCcqgCcqgCcqgCcsgK6OFPH8nn1+9fffcr/zDVa32A7l59SwA9/XgJP/+u+zDWa3WAbl7/Qi3o698+YmNiH8Z6rQ4Qb2IPf/kVfv3re/bR1SlDLQXo7jtChn1I+ahGADTNjqhakGpBvF4YEdxut7tdg74oWeGpzAF9eXP+5c3J8w9d+sGvDyKIUGonMSoT0H4DD88/HDZdmuF4+vGCjmIXplEMISIpZEaQIioSEDKgx6sNvOUmhAHhPx7zIESIpDpEpQL68uZMAuSSXC/Q0NSWICoT0OPV2e2za9zQPKXUC3Q99Bbivsj84PECgvenJxu4f/HJt7BaL4kQ3LWN+cHjBRQqGyDYGB9cK6BWIQRlQiUAQhOgTqM6aQwICkKtQqgEQGPUrzJQAQlCFRBNSSbUQplQKYDQKDaliUFBiAGCoS8eeQNC86DHKzRXPPctbAbE+unCAGE0ezST9p4IDassTAjKJlQQoMNm5KvGEJBkQoUAwi8ZiM5hggVxQq1iQqUAQp0Q3J+g1zFPOQAJEyoFUKh0VWaEOCCSrIBEqgOk9EKFAOreNiZ00hgQQ1IgIKovb6f0QZ0JtcpAVhSgSfMguApAk5oYa2MlA/J3KeqrDHqAQjzUeQNinbTfPMi8AAzahn7Zoj879KdJseyMFRtQsEwWxGxGtLFCLChYhiqDHiDYlABoBpdr90UGRE2oBEBYB4xmij+ICnRIeBsrBBBDM3GY1wBSloAqINLGigTUNbEz38I+gBTnvb2YPSsHQPAW99HeXZAFEEPSmZD3QnTugAJlrDKogIgsgCiSkgDR7XezzIPKBDRGNkCwI0QA+e71WCMgTKgQQAEDPJW5yqClA1lZgOAhaJB3AcJQOCDP3UKZA0La+/qDsNyAWCdUECCk/fRRjAJiJlQWoH3AKO8JCO6KARTUvqAbEKLCAfltyMsbUIAniMpSZUA/GtrGCgEUrFUBmvVVgwOCTTGAxsgDEOGy67psZ7GjAsSDez6/wrokn9/6xqx2hLZNIYAGqxpqkDOOx7y57BVeFSAsZVVDCTDEoZhPP73vFbZWmRHaIjClAFKd9kqIKjYl1ORwQ+vq5BJgn9u2IQvQCZagjb/lga2o378cTvP+95+RgOQgZ/L58Me+Fdn/n8omRL557LuPYkGPV3g7xgG9h2sA6ZjJMq9qyBZ0x0MxlX7IUWVKCI3zzbKA2HaVw4tPUwEpqxpyH3Rz0T0xChBDsxAg6QUB0SBA8F8k7uIc/32GbIwMTfff/HMwCTQP81KQM21Y2Iyefg45moIQIm9jhM1CgCQbkQDRz9Nz/IlDmYmBnW4GpZ3zIBL1TFsamge9VgYyZ5UxIQyoVUwoNaBvuFHIgNh/xelbNnojXoPS80b7DBKAAVJMKAsLwq6LDcs90Pnfma4/UqN9NrYfNNRxAOr6oC9vr2VAZG78/AMBxDYdugDN6e7oEpRQuyNwlgHU/f4HQkMCRJsVbmLMC+a2oDIBKfMgPIt5vHp2Tfodkj6nDyBKLkABG1/8qwwYIExnIUDEVcpn0rij/cPbazKlwf9tj7oiPMyj7+4mNp8/qAcI7hYFNEHxT8EDDJAgVAHBCojKr8qAAUJ4jhnQjNuAe4ktKALQGHlWGQOihCogbWILKqBBSgvIfb7ZSgHhfroCsgFqgex1rYBgiYDiDfMYEARSGztOQFgzRfsMEttCAM0WzNJPIEAQsDZmD/GtgI4a0GzRPv0EBsQWgRp7BGvmgEKifUKWhHH4M1uKbmIuQI9kIC17uAAFKsiCqAk19gDNJSzo1jpsp7k2gkTW8TaWF6D9sx/8LeiAGpj/AVSBgHbchHyLzQWoGUrO9m9i+xf/pUdKe2okIEtw1CKdtDcgso/zPMIw3wWvYkIVkC6rB8gc+5M3IHjATSzCPIgCooSOGhCdB/kHjY0BRCeKpsiN3AEFyn+8VtpYboCsSvIuxgGJo3MM++4roCMGdOAOs41v4XBA/OicIwQUZ38QS5UBKFgjAPGDT/T77jMHhA+7DdmHtzpA5E6WGO9ibTcRguKOG+2m4LwBRRzFoGRCFZAuSwDqAn61+83yBhTNJ10MoGjvYgogEc/qLjbqp82qVDf16gBpFqIrIKxGIXRUgGL5pE2ABkcpZw5I9UmLKw1ZuPOku575mYqYikxoaUB4Y7nlFcvscpWinmkU3bS7nnMFhE+ot0UdmgGJiEMWqDrtrmepjTVQJrQwoNsN+mtvNiGzT1rErLJw52l3PZPlZxr93DY8JHreUGjTL7kdSsm33XNgngeJqGcW7qy969mUsllQq5qQtdiYnxYq/I5ulHmY713tfHNpuOtZnzoiQPZXB/X0F7kp9rqcm8vZ+iCycMgJtcY1oFSjmNVNaAYkop5ZuLPlrudhapglhrGsADn4aH3S7G1eRD2zcOdJ8yAzIM/jzSIBor+23ygW0ScNFUBQJtSOum+0uHcxuRM6XkDzx81LqT6gjhDO8zk5JwNAEeLmpZQNkM+pFRkAit8HKYAYIfqkO943A0Ax4uZFagiIEjoiQFHi5kWKD2O8W5YAuaM1MwAUJW5epLgJiXELwKMCFKw5ATkjpVYJiIaMMzkCgdYJiEZEU2UOKGJAnQ0QX0aEYZchrsaCep6hVQPihJSXCwmQPVJqtYBa4xJHGkC39j4lK0ABV9nNBghvkj5szPkZADKuASVrYrad5GaXq4dmB2SLlJoAaDeUku9lQQsCMi1xJLKg+1PbVRAWn7RbcwEyePCTNTHfhcMkFqS/AoD7XxcB5L30HKIxS8PS8nN/xZmvRU9Zih7ze+DL4/2Xng/RtuARsTZGUj03tPC/jlkEmmJBB/t1NKk2cRJZAAn/a2pADqXaBkzkBWjMItAaAAn/a76A0jQx4yUS3L0YvkqW7GU1RSdtvmUD5A8oUDMD4u7F4GXEtQEKXiUrEZDWTGxhHGsAxIYxN6DQVbKyANkusrGEcVRAWJkDiro/CMsJqFUI5QYo7v4grCMHFNsfpAIyRBzKhHIDFHd/EFaegKy/d8L9QViEUKu0sX4xiVAiQAf/cKi4PmnoBUgKaU0D6P43v/e1oFDFBRSwSuYABIYSmY//+Jd3EwtVHEDChJJY0OHMvw+K7e5QARnDwtXZYvhPC9L9bz/5A4rtMPMEFL4INAEQXQ40/8pJXa6QXcemTBV1xbo1jgSAYMAw3wMkgnse3pEbaIPuejZk+QHiLnzPUKlU8yCliYkgZxxmiMMyg+56NmR5AuIufL9FoFQvq0onLQIM7zCmm8vAu571KRmQ7WiKsDWOZIBkqSGq6FvgXc96kdVnEf1sVrcWHbIUnRaQEuSMwzFD73rWpqgFGW/ZEImgRaAUFkT2B8mvGrIFff2+u8s45CpjbWrrCUjsMfdY41ikiUlBzg/vOJZ0gEIWgRIBUod5EeTM+ITf9axLyYDsx+MELAItAkhEPeP5D+6ew+961qT8AQUsAiUBFPWoUvF1BCD3IlBaC/LXGEDkKiS5E7IUsxx2tgig+C5XrABArUJoeUDpLch1RFdmgGDA8WVE0QEpjWx5QAl80jAQkExoeUDBGgWI3vTjC8jPhV8uII9D3oD2wYUARfdJY9G7orgJOYt1hDIAFN8njXW8gFL4pLGUUzk9ivFG5vnTZtXSgHzOUXS78MtqYsGAOhf+8oDSdNK9PR4+xZiH2rjGUdYwL9+RAP3OUayAXMWYh9q0CJS2ifm/saYD1HmoDYtAhXXSrdIJeR40CTIAlGqYV88n9z2Jk/oX9YtAZQPyjTHs7ml1/rRZpe5RxMGbnk1szLIql3y4tP/qKXA9GxtQ8BFCoy1IORsY+kaIKSZU9DA/AOQZISYTWhkgzwAoiVDJrxqt8rbB8vwCoAB/tOh5EFTP5aTyiu8RJlT2MK8D5Be+wgmtEJBfdAZgrWwVTaw7E6+TX/ABGD5ZXietHhrI5be3HgyeLG+YP05AaTYvyIC686i4/IIPQP/JtJ20v6YAUg7sElmN17s99g6ZH5xV6TcvKIC6s2CkLK93ewCWAJRm8wJPyYflyFmN16srMJOcVYt10r2DKpSsxuPNDJg34c+qBQGpyz9qVuN+8QDJAe0DGhfVLIDanfZB54sHMLqRZpUAtEc99CGM0ERALLwOSgeHytNq17wamNxIs4oDIpOgwJnQTIDIYauaB5vGMtlp5W4oBSAyCbJeZjfUVEBdaAsWZdR/UGa0RkBsWznTbqd7sDG7Y4HezzarFgYEt1s51TvKmGU1xjENlA+I3vGpZnFK0phGNPxHANCwm1WWayNEUC/7Nu0KP1uK330qt7f+0dgtbDSTZzCcD8wq80RRBPWyb9OuMvZIDS6JHdqTsCReDMCFAImAOvZt2jWiAcU0d+qq5603jdzkwEKAREgm+zbtKuPR0txD3DufHnQBwGkBiaBe9m3aVcYJi82q0RY0rNfaAC3XB00tNqtso9gFH8Uu6Cg26SrjdMVmlcUfJK4yjj4PmrfYrFrSYRar2KyqgByqgByqgByqgByaBGgNqoAcqoAcqoAcqoAcqoAcqoAcqoAcqoAcGg9o4PzgIl41bTY7FFaXd0fPiTX8q3hFRZvHzpc1V2aqRgMaLgJ1usM11mazQ2F1eRiqdmmJ6jPiqs2jxxaaKzNZowENHbBMN69/wT42XTY7FNZUVOvWpTl//vul9p9kJ4MaKzNdowENXfgiC1XVmK31/lMhG9BnPf30b2Qiujx2vqylMlM1GtBwEYgLAzJlY8e2Pu/h3ev3hqzPF7gN6fLY+bKWykxVYgsih8KaipqMC/3HJ4MFEd1c5mhBlmb/YOqD2KGn5u5L3z3Rk0AvQovNowmjWH8RiAtXVZvNDoXV5bFGYvpXsQWZij39/NFSmalKOg/qDoU15OGDYkfMgyzFZlCdSTtUATlUATlUATlUATlUATmUHNDjVXfu+f3L69Q/fIQWsaDjQENVATm0ICD09/3LH05PTs7wBbjntPUFRqzF18KATnGQ2gmNVCP34IbGFUfX0oDO8QXK5yRxSw/GCAxNj62lm9g1S6G/2MUeQeE08ZUToNxaF1FGgMgZfNkpI0CPV8iEsqOUESAyzOfGp76LuVQBOVQBOVQBOVQBOVQBOVQBOVQBOVQBOVQBOfR/0iFi3sWozjUAAAAASUVORK5CYII=" /><!-- --></p>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-corradin2024" class="csl-entry">
Corradin, Riccardo, Luca Danese, Wasiur R. KhudaBukhsh, and Andrea
Ongaro. 2024. <span>“Model-Based Clustering of Time-Dependent
Observations with Common Structural Changes.”</span> <a href="https://arxiv.org/abs/2410.09552">https://arxiv.org/abs/2410.09552</a>.
</div>
<div id="ref-CORRADIN202226" class="csl-entry">
———. 2025. <span>“Model-Based Clustering of Time-Dependent Observations
with Common Structural Changes.”</span> <em>Statistics and
Computing</em> 36 (1): 7. <a href="https://doi.org/10.1007/s11222-025-10756-x">https://doi.org/10.1007/s11222-025-10756-x</a>.
</div>
<div id="ref-Dahl02102022" class="csl-entry">
David B. Dahl, Devin J. Johnson, and Peter Müller. 2022. <span>“Search
Algorithms and Loss Functions for Bayesian Clustering.”</span>
<em>Journal of Computational and Graphical Statistics</em> 31 (4):
1189–1201. <a href="https://doi.org/10.1080/10618600.2022.2069779">https://doi.org/10.1080/10618600.2022.2069779</a>.
</div>
<div id="ref-MM2014" class="csl-entry">
Martínez, Asael Fabian, and Ramsés H. Mena. 2014. <span>“<span class="nocase">On a Nonparametric Change Point Detection Model in
Markovian Regimes</span>.”</span> <em>Bayesian Analysis</em> 9 (4):
823–58. <a href="https://doi.org/10.1214/14-BA878">https://doi.org/10.1214/14-BA878</a>.
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
